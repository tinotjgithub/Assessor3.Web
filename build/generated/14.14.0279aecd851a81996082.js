webpackJsonp([14],{

/***/ 281:
/* no static exports found */
/* all exports used */
/*!********************************************!*\
  !*** ./src/utility/locale/localehelper.ts ***!
  \********************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\n/**\r\n * helper class with utilty methods for localisation of date, time and number\r\n */\r\nvar LocaleHelper = /** @class */ (function () {\r\n    function LocaleHelper() {\r\n    }\r\n    /**\r\n     * returns the localised string based on the local time zone (machine's locale).\r\n     * @param object - date/time/number to be localised.\r\n     */\r\n    LocaleHelper.toLocaleString = function (object) {\r\n        if (object == null || object === undefined) {\r\n            return '';\r\n        }\r\n        return object.toLocaleString();\r\n    };\r\n    /**\r\n     * returns the localised date string based on the local time zone (machine's locale).\r\n     * @param object - date to be localised.\r\n     */\r\n    LocaleHelper.toLocaleDateString = function (object) {\r\n        if (object == null || object === undefined) {\r\n            return '';\r\n        }\r\n        return object.toLocaleDateString(navigator.language);\r\n    };\r\n    /**\r\n     * returns the localised time string based on the local time zone (machine's locale).\r\n     * @param object - time to be localised.\r\n     */\r\n    LocaleHelper.toLocaleTimeString = function (object) {\r\n        if (object == null || object === undefined) {\r\n            return '';\r\n        }\r\n        // Remove seconds from time.\r\n        return object.toLocaleTimeString(navigator.language);\r\n    };\r\n    /**\r\n     * returns the localised date time string based on the local time zone (machine's locale).\r\n     * @param object - Date and time to be localised.\r\n     */\r\n    LocaleHelper.toLocaleDateTimeString = function (object) {\r\n        if (object == null || object === undefined) {\r\n            return '';\r\n        }\r\n        return object.toLocaleDateString(navigator.language) + ' ' +\r\n            object.toLocaleTimeString(navigator.language);\r\n    };\r\n    /**\r\n     * get the awarding body\r\n     * @param locale\r\n     */\r\n    LocaleHelper.getAwardingBodyLocale = function (locale) {\r\n        //Checking wether browser language exist in languageJson\r\n        var langExist;\r\n        langExist = false;\r\n        languageList.languages.language.map(function (lang) {\r\n            if (lang.code === locale) {\r\n                langExist = true;\r\n            }\r\n        });\r\n        var awardingBody = languageList.languages['awarding-body'];\r\n        if (!langExist) {\r\n            // If the customer doesnt support the browser language select the default language\r\n            locale = languageList.languages['default-culture'];\r\n        }\r\n        /**\r\n         * Splitting the locale to take the langauge code only.The locale conatin both language and country code,\r\n         * the corresponding locale json name contain only language code.\r\n         */\r\n        var localeCode = locale.split('-')[0];\r\n        /**\r\n         * The locale JSON file name should be in a format of awardingbody-locale.json.\r\n         * Populating the url based on te awarding body and locale selected.\r\n         */\r\n        return awardingBody.toLowerCase() + '-' + localeCode;\r\n    };\r\n    return LocaleHelper;\r\n}());\r\nmodule.exports = LocaleHelper;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjgxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxpdHkvbG9jYWxlL2xvY2FsZWhlbHBlci50cz8yOGE1Il0sInNvdXJjZXNDb250ZW50IjpbImRlY2xhcmUgbGV0IGxhbmd1YWdlTGlzdDogYW55O1xyXG5cclxuLyoqXHJcbiAqIGhlbHBlciBjbGFzcyB3aXRoIHV0aWx0eSBtZXRob2RzIGZvciBsb2NhbGlzYXRpb24gb2YgZGF0ZSwgdGltZSBhbmQgbnVtYmVyXHJcbiAqL1xyXG5jbGFzcyBMb2NhbGVIZWxwZXIge1xyXG4gICAgLyoqXHJcbiAgICAgKiByZXR1cm5zIHRoZSBsb2NhbGlzZWQgc3RyaW5nIGJhc2VkIG9uIHRoZSBsb2NhbCB0aW1lIHpvbmUgKG1hY2hpbmUncyBsb2NhbGUpLlxyXG4gICAgICogQHBhcmFtIG9iamVjdCAtIGRhdGUvdGltZS9udW1iZXIgdG8gYmUgbG9jYWxpc2VkLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIHRvTG9jYWxlU3RyaW5nKG9iamVjdDogYW55KSB7XHJcbiAgICAgICAgaWYgKG9iamVjdCA9PSBudWxsIHx8IG9iamVjdCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG9iamVjdC50b0xvY2FsZVN0cmluZygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogcmV0dXJucyB0aGUgbG9jYWxpc2VkIGRhdGUgc3RyaW5nIGJhc2VkIG9uIHRoZSBsb2NhbCB0aW1lIHpvbmUgKG1hY2hpbmUncyBsb2NhbGUpLlxyXG4gICAgICogQHBhcmFtIG9iamVjdCAtIGRhdGUgdG8gYmUgbG9jYWxpc2VkLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIHRvTG9jYWxlRGF0ZVN0cmluZyhvYmplY3Q6IERhdGUpIHtcclxuICAgICAgICBpZiAob2JqZWN0ID09IG51bGwgfHwgb2JqZWN0ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb2JqZWN0LnRvTG9jYWxlRGF0ZVN0cmluZyhuYXZpZ2F0b3IubGFuZ3VhZ2UpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogcmV0dXJucyB0aGUgbG9jYWxpc2VkIHRpbWUgc3RyaW5nIGJhc2VkIG9uIHRoZSBsb2NhbCB0aW1lIHpvbmUgKG1hY2hpbmUncyBsb2NhbGUpLlxyXG4gICAgICogQHBhcmFtIG9iamVjdCAtIHRpbWUgdG8gYmUgbG9jYWxpc2VkLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIHRvTG9jYWxlVGltZVN0cmluZyhvYmplY3Q6IERhdGUpIHtcclxuICAgICAgICBpZiAob2JqZWN0ID09IG51bGwgfHwgb2JqZWN0ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUmVtb3ZlIHNlY29uZHMgZnJvbSB0aW1lLlxyXG4gICAgICAgIHJldHVybiBvYmplY3QudG9Mb2NhbGVUaW1lU3RyaW5nKG5hdmlnYXRvci5sYW5ndWFnZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiByZXR1cm5zIHRoZSBsb2NhbGlzZWQgZGF0ZSB0aW1lIHN0cmluZyBiYXNlZCBvbiB0aGUgbG9jYWwgdGltZSB6b25lIChtYWNoaW5lJ3MgbG9jYWxlKS5cclxuICAgICAqIEBwYXJhbSBvYmplY3QgLSBEYXRlIGFuZCB0aW1lIHRvIGJlIGxvY2FsaXNlZC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyB0b0xvY2FsZURhdGVUaW1lU3RyaW5nKG9iamVjdDogRGF0ZSkge1xyXG4gICAgICAgIGlmIChvYmplY3QgPT0gbnVsbCB8fCBvYmplY3QgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gb2JqZWN0LnRvTG9jYWxlRGF0ZVN0cmluZyhuYXZpZ2F0b3IubGFuZ3VhZ2UpICsgJyAnICtcclxuICAgICAgICAgICAgICAgb2JqZWN0LnRvTG9jYWxlVGltZVN0cmluZyhuYXZpZ2F0b3IubGFuZ3VhZ2UpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogZ2V0IHRoZSBhd2FyZGluZyBib2R5XHJcbiAgICAgKiBAcGFyYW0gbG9jYWxlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0QXdhcmRpbmdCb2R5TG9jYWxlKGxvY2FsZTogc3RyaW5nKTogc3RyaW5nIHtcclxuXHJcbiAgICAgICAgLy9DaGVja2luZyB3ZXRoZXIgYnJvd3NlciBsYW5ndWFnZSBleGlzdCBpbiBsYW5ndWFnZUpzb25cclxuICAgICAgICBsZXQgbGFuZ0V4aXN0OiBib29sZWFuO1xyXG4gICAgICAgIGxhbmdFeGlzdCA9IGZhbHNlO1xyXG4gICAgICAgIGxhbmd1YWdlTGlzdC5sYW5ndWFnZXMubGFuZ3VhZ2UubWFwKGZ1bmN0aW9uIChsYW5nOiBhbnkpIHtcclxuICAgICAgICAgICAgaWYgKGxhbmcuY29kZSA9PT0gbG9jYWxlKSB7XHJcbiAgICAgICAgICAgICAgICBsYW5nRXhpc3QgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBhd2FyZGluZ0JvZHkgPSBsYW5ndWFnZUxpc3QubGFuZ3VhZ2VzWydhd2FyZGluZy1ib2R5J107XHJcbiAgICAgICAgaWYgKCFsYW5nRXhpc3QpIHtcclxuICAgICAgICAgICAgLy8gSWYgdGhlIGN1c3RvbWVyIGRvZXNudCBzdXBwb3J0IHRoZSBicm93c2VyIGxhbmd1YWdlIHNlbGVjdCB0aGUgZGVmYXVsdCBsYW5ndWFnZVxyXG4gICAgICAgICAgICBsb2NhbGUgPSBsYW5ndWFnZUxpc3QubGFuZ3VhZ2VzWydkZWZhdWx0LWN1bHR1cmUnXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFNwbGl0dGluZyB0aGUgbG9jYWxlIHRvIHRha2UgdGhlIGxhbmdhdWdlIGNvZGUgb25seS5UaGUgbG9jYWxlIGNvbmF0aW4gYm90aCBsYW5ndWFnZSBhbmQgY291bnRyeSBjb2RlLFxyXG4gICAgICAgICAqIHRoZSBjb3JyZXNwb25kaW5nIGxvY2FsZSBqc29uIG5hbWUgY29udGFpbiBvbmx5IGxhbmd1YWdlIGNvZGUuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbGV0IGxvY2FsZUNvZGUgPSBsb2NhbGUuc3BsaXQoJy0nKVswXTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGxvY2FsZSBKU09OIGZpbGUgbmFtZSBzaG91bGQgYmUgaW4gYSBmb3JtYXQgb2YgYXdhcmRpbmdib2R5LWxvY2FsZS5qc29uLlxyXG4gICAgICAgICAqIFBvcHVsYXRpbmcgdGhlIHVybCBiYXNlZCBvbiB0ZSBhd2FyZGluZyBib2R5IGFuZCBsb2NhbGUgc2VsZWN0ZWQuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmV0dXJuIGF3YXJkaW5nQm9keS50b0xvd2VyQ2FzZSgpICsgJy0nICsgbG9jYWxlQ29kZTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0ID0gTG9jYWxlSGVscGVyO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL34vc291cmNlLW1hcC1sb2FkZXIhLi9zcmMvdXRpbGl0eS9sb2NhbGUvbG9jYWxlaGVscGVyLnRzIl0sIm1hcHBpbmdzIjoiO0FBRUE7O0FBRUE7QUFDQTtBQUFBO0FBa0ZBO0FBakZBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7O0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFFQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),

/***/ 283:
/* no static exports found */
/* all exports used */
/*!*********************************************************!*\
  !*** ./src/components/utility/message/messagehelper.ts ***!
  \*********************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function($) {\r\nvar messagestore = __webpack_require__(/*! ../../../stores/message/messagestore */ 240);\r\nvar groupHelper = __webpack_require__(/*! ../../../utility/grouping/grouphelper */ 430);\r\nvar grouperList = __webpack_require__(/*! ../../../utility/grouping/groupingbase/grouperlist */ 427);\r\nvar Immutable = __webpack_require__(/*! immutable */ 40);\r\nvar enums = __webpack_require__(/*! ../enums */ 225);\r\nvar localehelper = __webpack_require__(/*! ../../../utility/locale/localehelper */ 281);\r\nvar stringFormatHelper = __webpack_require__(/*! ../../../utility/stringformat/stringformathelper */ 250);\r\nvar localeStore = __webpack_require__(/*! ../../../stores/locale/localestore */ 226);\r\nvar messageEditorConstants = __webpack_require__(/*! ../messageeditorconstants */ 325);\r\nvar stringHelper = __webpack_require__(/*! ../../../utility/generic/stringhelper */ 254);\r\nvar htmlUtilities = __webpack_require__(/*! ../../../utility/generic/htmlutilities */ 243);\r\nvar markerOperationModeFactory = __webpack_require__(/*! ../markeroperationmode/markeroperationmodefactory */ 232);\r\nvar qigStore = __webpack_require__(/*! ../../../stores/qigselector/qigstore */ 230);\r\nvar MessageHelper = /** @class */ (function () {\r\n    function MessageHelper() {\r\n    }\r\n    /**\r\n     * Get the Header to display and the related messges\r\n     * @param messages\r\n     */\r\n    MessageHelper.getGroupedMessageObject = function (messages, expandOrCollapseDetails) {\r\n        var _this = this;\r\n        // To store the messages after the grouping and sorting\r\n        var messageList = Immutable.List();\r\n        // Get the messages grouped by QIG\r\n        var groupedMessages = groupHelper.group(messages, grouperList.MessageQigGrouper, enums.GroupByField.qig);\r\n        // Get the key seq\r\n        var groupedKeys = groupedMessages.keySeq();\r\n        // Create the return object\r\n        var returnObj = [];\r\n        // Loop through the keys and find the list of messages for the group.\r\n        groupedKeys.forEach(function (qigId) {\r\n            // Get the messages for the group.\r\n            var currentMessageGroup = groupedMessages.get(qigId);\r\n            // Clear the collection, In each group.\r\n            var messages = [];\r\n            // Get the each messages for the group.\r\n            currentMessageGroup.map(function (message) {\r\n                if (message.status === enums.MessageReadStatus.New && messagestore.instance.isMessageRead(message.examinerMessageId)) {\r\n                    message.status = enums.MessageReadStatus.Read;\r\n                }\r\n                messages.push(message);\r\n            });\r\n            // Get the awarding body name format\r\n            var nameToDisplay = MessageHelper.getDisplayText(messages[0]);\r\n            var messageFolderType = messages[0].messageFolderType;\r\n            // Create an object to store messages\r\n            var groupedObj = {\r\n                qigId: parseInt(qigId),\r\n                isOpen: _this.isQigOpen(parseInt(qigId), messageFolderType, expandOrCollapseDetails),\r\n                textToDisplay: nameToDisplay,\r\n                messages: messages,\r\n                unReadMessages: messages.filter(function (x) {\r\n                    return x.status === enums.MessageReadStatus.New && !messagestore.instance.isMessageRead(x.examinerMessageId);\r\n                }).length\r\n            };\r\n            returnObj.push(groupedObj);\r\n        });\r\n        // Sort the objects based on the display header.\r\n        var getGroupedMessageObject = returnObj.sort(function (obj1, obj2) {\r\n            return obj1.textToDisplay.localeCompare(obj2.textToDisplay);\r\n        });\r\n        // Get the messages as in the order of displaying in the UI\r\n        getGroupedMessageObject.forEach(function (messageObject) {\r\n            messageList = Immutable.List(messageList.concat(messageObject.messages));\r\n        });\r\n        var messageGroupDetails = {\r\n            // Stores the Grouped Object along with those messages\r\n            MessageGroupObjects: getGroupedMessageObject,\r\n            // Store all messages for the UI\r\n            messages: messageList\r\n        };\r\n        return messageGroupDetails;\r\n    };\r\n    /**\r\n     * Returns whether a particular qig is open or not\r\n     * @param expandOrCollapseDetails\r\n     */\r\n    MessageHelper.isQigOpen = function (qigId, messageFolderType, expandOrCollapseDetails) {\r\n        return expandOrCollapseDetails ? expandOrCollapseDetails.get(qigId, true) : true;\r\n    };\r\n    /**\r\n     * Get the time style for the Date\r\n     * @param timeToDisplay\r\n     * @param todayTextConversionRequired : for deciding Today text conversion\r\n     */\r\n    MessageHelper.getDateToDisplay = function (timeToDisplay, todayTextConversionRequired) {\r\n        if (todayTextConversionRequired === void 0) { todayTextConversionRequired = true; }\r\n        var timeToDisplayDate = new Date(timeToDisplay);\r\n        var todaysDate = new Date();\r\n        var time = localehelper.toLocaleTimeString(new Date(timeToDisplay.toString()));\r\n        // call setHours to take the time out of the comparison\r\n        if ((timeToDisplayDate.setHours(0, 0, 0, 0) === todaysDate.setHours(0, 0, 0, 0)) && todayTextConversionRequired) {\r\n            // Date equals today's date. Display date feild as Today.\r\n            return localeStore.instance.TranslateText('messaging.message-lists.message-detail.date-today') + ' ' + time;\r\n        }\r\n        else {\r\n            return localehelper.toLocaleDateString(new Date(timeToDisplay)) + ' ' + time;\r\n        }\r\n    };\r\n    /**\r\n     * Get the Display Header for the Group Header.\r\n     * @param message\r\n     */\r\n    MessageHelper.getDisplayText = function (message) {\r\n        var msg = messagestore.instance.messagesMarkSchemes;\r\n        if (msg) {\r\n            var messageList = msg.filter(function (messages) { return messages.markSchemeGroupId === message.markSchemeGroupId; });\r\n            {\r\n                return stringFormatHelper.formatAwardingBodyQIG(messageList.first().markSchemeGroupName, messageList.first().assessmentCode, messageList.first().sessionName, messageList.first().componentId, messageList.first().questionPaperName, messageList.first().assessmentName, messageList.first().componentName, stringFormatHelper.getOverviewQIGNameFormat());\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Return the Mark Scheme Group Name\r\n     * @param message\r\n     */\r\n    MessageHelper.getMarkSchemeGroupName = function (message) {\r\n        var msg = messagestore.instance.messagesMarkSchemes;\r\n        if (msg) {\r\n            return msg.filter(function (messages) { return messages.markSchemeGroupId === message.markSchemeGroupId; }).\r\n                first().markSchemeGroupName;\r\n        }\r\n    };\r\n    /**\r\n     * Used to create the MessageOrExceptionLinkedItems based on the messages\r\n     * @param messages\r\n     */\r\n    MessageHelper.getMessageLinkedItems = function (messages) {\r\n        var messageOrExceptionLinkedItems = [];\r\n        var items = messages.forEach(function (message) {\r\n            messageOrExceptionLinkedItems.push({\r\n                itemId: message.examinerMessageId,\r\n                senderOrItem: message.toTeam ?\r\n                    localeStore.instance.TranslateText('messaging.compose-message.recipient-selector.entire-team') :\r\n                    MessageHelper.appendExaminer(message),\r\n                priorityOrStatus: message.priorityName,\r\n                subjectOrType: message.subject,\r\n                timeToDisplay: message.displayDate,\r\n                isUnreadOrUnactioned: message.status === enums.MessageReadStatus.New &&\r\n                    !messagestore.instance.isMessageRead(message.examinerMessageId)\r\n            });\r\n        });\r\n        return Immutable.List(messageOrExceptionLinkedItems);\r\n    };\r\n    /**\r\n     * append examiners\r\n     */\r\n    MessageHelper.appendExaminer = function (message) {\r\n        var examiners = '';\r\n        if (message && message.toExaminerDetails != null) {\r\n            message.toExaminerDetails.map(function (item) {\r\n                examiners += item.fullName + ';';\r\n            });\r\n            // removing last item semicolon\r\n            return examiners.replace(/;$/, '');\r\n        }\r\n        else {\r\n            examiners = message.examinerDetails.fullName;\r\n        }\r\n        return examiners;\r\n    };\r\n    /**\r\n     * This method will returns the message content based on the template name\r\n     * @param templateName - template name\r\n     * @param messageBody - message content\r\n     */\r\n    MessageHelper.getMessageContent = function (templateName, messageFrom, date, messageBody) {\r\n        var template;\r\n        switch (templateName) {\r\n            case enums.MessageType.InboxReply:\r\n            case enums.MessageType.ResponseReply:\r\n                template = stringHelper.format(localeStore.instance.TranslateText('messaging.compose-message.new-message-templates.reply'), [messageEditorConstants.TINYMCE_DEFAULT_FONT, messageEditorConstants.TINYMCE_DEFAULT_FONTSIZE,\r\n                    this.getDateToDisplay(date, false), messageFrom, messageBody]);\r\n                break;\r\n            case enums.MessageType.InboxForward:\r\n            case enums.MessageType.ResponseForward:\r\n                template = stringHelper.format(localeStore.instance.TranslateText('messaging.compose-message.new-message-templates.forward'), [messageEditorConstants.TINYMCE_DEFAULT_FONT, messageEditorConstants.TINYMCE_DEFAULT_FONTSIZE,\r\n                    this.getDateToDisplay(date, false), messageFrom, messageBody]);\r\n                break;\r\n            case enums.MessageType.ResponseCompose:\r\n            case enums.MessageType.WorklistCompose:\r\n            case enums.MessageType.InboxCompose:\r\n            case enums.MessageType.TeamCompose:\r\n                template = stringHelper.format(localeStore.instance.TranslateText('messaging.compose-message.new-message-templates.new'), [messageEditorConstants.TINYMCE_DEFAULT_FONT, messageEditorConstants.TINYMCE_DEFAULT_FONTSIZE]);\r\n                break;\r\n        }\r\n        return template;\r\n    };\r\n    /**\r\n     * This method will return the Menu Action items needed based on the folder type\r\n     * @param folderType\r\n     * @param messageActions: an array of message actions\r\n     */\r\n    MessageHelper.getMessageMenuActionItems = function (folderType, messageActions) {\r\n        var _this = this;\r\n        var messageMenuActionItems = [];\r\n        switch (folderType) {\r\n            case enums.MessageFolderType.Inbox:\r\n                if (messageActions && messageActions.length > 0) {\r\n                    messageActions.map(function (x) {\r\n                        var actionItems = _this.messageActionItems(x);\r\n                        if (actionItems) {\r\n                            messageMenuActionItems.push(actionItems);\r\n                        }\r\n                    });\r\n                }\r\n        }\r\n        return messageMenuActionItems;\r\n    };\r\n    /**\r\n     * This method will return the localised message string based on message type\r\n     */\r\n    MessageHelper.getMessageHeader = function (messageType) {\r\n        var messageHeader;\r\n        switch (messageType) {\r\n            case enums.MessageType.InboxCompose:\r\n            case enums.MessageType.WorklistCompose:\r\n            case enums.MessageType.ResponseCompose:\r\n            case enums.MessageType.TeamCompose:\r\n                messageHeader = localeStore.instance.TranslateText('messaging.compose-message.new-message-header');\r\n                break;\r\n            case enums.MessageType.InboxForward:\r\n            case enums.MessageType.ResponseForward:\r\n                messageHeader = localeStore.instance.TranslateText('messaging.compose-message.forward-header');\r\n                break;\r\n            case enums.MessageType.InboxReply:\r\n            case enums.MessageType.ResponseReply:\r\n                messageHeader = localeStore.instance.TranslateText('messaging.compose-message.reply-header');\r\n                break;\r\n            case enums.MessageType.ResponseDetails:\r\n                messageHeader = localeStore.instance.TranslateText('marking.response.message-panel.header');\r\n        }\r\n        return messageHeader;\r\n    };\r\n    /**\r\n     * This method will returns the subject string\r\n     * @param messageType\r\n     * @param subject\r\n     */\r\n    MessageHelper.getSubjectContent = function (messageType, subject) {\r\n        var subjectText;\r\n        var subjectPrefix;\r\n        switch (messageType) {\r\n            case enums.MessageType.InboxCompose:\r\n                subjectText = subject;\r\n                break;\r\n            case enums.MessageType.InboxForward:\r\n            case enums.MessageType.ResponseForward:\r\n                subjectPrefix = localeStore.instance.TranslateText('messaging.compose-message.forward-prefix');\r\n                subjectText = subject.indexOf(subjectPrefix) === -1 ? subjectPrefix + ' ' + subject : subject;\r\n                break;\r\n            case enums.MessageType.InboxReply:\r\n            case enums.MessageType.ResponseReply:\r\n                subjectPrefix = localeStore.instance.TranslateText('messaging.compose-message.reply-prefix');\r\n                subjectText = subject.indexOf(subjectPrefix) === -1 ? subjectPrefix + ' ' + subject : subject;\r\n                break;\r\n        }\r\n        return subjectText;\r\n    };\r\n    Object.defineProperty(MessageHelper, \"getCreateNewMessageText\", {\r\n        /**\r\n         * Get the Create new text for the component.\r\n         */\r\n        get: function () {\r\n            return localeStore.instance.TranslateText('marking.response.message-list-panel.create-new-message');\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * This method will return the Menu Action item based on the action parameter\r\n     * @param messageAction\r\n     */\r\n    MessageHelper.messageActionItems = function (messageAction) {\r\n        switch (messageAction) {\r\n            case enums.MessageAction.Reply:\r\n                return ({\r\n                    id: enums.MessageAction.Reply,\r\n                    icon: 'reply-icon',\r\n                    name: localeStore.instance.TranslateText('messaging.message-lists.message-detail.reply-button')\r\n                });\r\n            case enums.MessageAction.Forward:\r\n                if (!markerOperationModeFactory.operationMode.isForwardButtonHidden) {\r\n                    return ({\r\n                        id: enums.MessageAction.Forward,\r\n                        icon: 'forward-icon',\r\n                        name: localeStore.instance.TranslateText('messaging.message-lists.message-detail.forward-button')\r\n                    });\r\n                }\r\n                break;\r\n            case enums.MessageAction.Delete:\r\n                return ({\r\n                    id: enums.MessageAction.Delete,\r\n                    icon: 'delete-icon-small',\r\n                    name: localeStore.instance.TranslateText('messaging.message-lists.message-detail.delete-button')\r\n                });\r\n        }\r\n    };\r\n    /**\r\n     * This method will update the IFrame content with message details\r\n     * @param o\r\n     * @param e\r\n     */\r\n    MessageHelper.addIFrameForMessageDetails = function (o, e) {\r\n        var timeout = 0;\r\n        // add script to init mouse click event in parent window for any 'click' in current window\r\n        var scriptBlock = 'window.addEventListener(\\'click\\', function() { parent.initMouseClickEvent(); });';\r\n        var headTagContent = '<style type=\"text/css\"> p,body{margin:0;padding:0;}</style>';\r\n        if (htmlUtilities.isIPadDevice && htmlUtilities.getUserDevice().browser === 'Safari') {\r\n            //include script to block double tap and pinch zoom in iPad safari\r\n            scriptBlock +=\r\n                'window.addEventListener(\\'touchend\\', blockDoubleTapZoom);' +\r\n                    'window.addEventListener(\\'touchstart\\', blockPinchToZoom);' +\r\n                    //block double tap zoom\r\n                    'let lastTap = 0;' +\r\n                    'function blockDoubleTapZoom ( e ) {' +\r\n                    'let currentTime = new Date().getTime();' +\r\n                    'let tapLength = currentTime - lastTap;' +\r\n                    'if (tapLength < 500 && tapLength > 0) {' +\r\n                    'e.preventDefault();}' +\r\n                    'lastTap = currentTime;' +\r\n                    //init mouse click event\r\n                    'parent.initMouseClickEvent(); }' +\r\n                    //block pinch zoom\r\n                    'function blockPinchToZoom ( e ) {' +\r\n                    'if (e.touches.length > 1) {' +\r\n                    'e.preventDefault();}' +\r\n                    '}';\r\n        }\r\n        else {\r\n            //incluse script to init mouse click event in parent window for any 'touch' in current window\r\n            scriptBlock +=\r\n                'window.addEventListener(\\'touchend\\', function() { parent.initMouseClickEvent(); });';\r\n        }\r\n        var content = e.getContent().trim() +\r\n            '<script>' + scriptBlock + '</script >';\r\n        // put a timeout of 0, otherwise message details are not rendering on first message item click\r\n        if (!htmlUtilities.isTabletOrMobileDevice && htmlUtilities.getUserDevice().browser === 'Firefox') {\r\n            timeout = 50;\r\n        }\r\n        setTimeout(function () {\r\n            $('#msg-iframe_ifr').contents().find('head').html(headTagContent);\r\n            $('#msg-iframe_ifr').contents().find('body').html(content);\r\n        }, timeout);\r\n    };\r\n    /**\r\n     * Returns a boolean indicating whether the message panel is edited.\r\n     */\r\n    MessageHelper.isMessagePanelEdited = function (messageType, messageToFieldValues, messageToFieldIds) {\r\n        if (messagestore.instance.isMessagePanelActive) {\r\n            var currentActiveEditorId = tinymce.activeEditor.id;\r\n            var activeEditor = tinymce.get(MessageHelper.messageEditorId);\r\n            if (messageType === enums.MessageType.InboxCompose || messageType === enums.MessageType.InboxForward ||\r\n                messageType === enums.MessageType.InboxReply) {\r\n                return MessageHelper.messageSubject && MessageHelper.messageSubject.trim().length > 0 ||\r\n                    activeEditor.getContent({ format: 'text' }).trim().length > 0 ||\r\n                    ((messageToFieldValues && messageToFieldValues.length > 0) &&\r\n                        (messageToFieldIds && messageToFieldIds.length > 0));\r\n            }\r\n            else if (messageType === enums.MessageType.ResponseCompose\r\n                || messageType === enums.MessageType.WorklistCompose || messageType === enums.MessageType.ResponseReply\r\n                || messageType === enums.MessageType.ResponseForward || messageType === enums.MessageType.TeamCompose) {\r\n                return MessageHelper.messageSubject && MessageHelper.messageSubject.trim().length > 0 ||\r\n                    activeEditor.getContent({ format: 'text' }).trim().length > 0;\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * This method revamps the marking mode naming for display in message\r\n     * @param markingMode\r\n     * @param isElectronicStandardisationTeamMember\r\n     */\r\n    MessageHelper.getMarkingModeText = function (markingMode, isElectronicStandardisationTeamMember) {\r\n        if (markingMode === enums.MarkingMode.ES_TeamApproval) {\r\n            if (isElectronicStandardisationTeamMember) {\r\n                return ((localeStore.instance.TranslateText('marking.worklist.response-data.stm-standardisation-response-title')) + ' ');\r\n            }\r\n            else {\r\n                return ((localeStore.instance.TranslateText('marking.worklist.response-data.second-standardisation-response-title')) + ' ');\r\n            }\r\n        }\r\n        else if (markingMode === enums.MarkingMode.Practice) {\r\n            return ((localeStore.instance.TranslateText('marking.worklist.response-data.practice-response-title')) + ' ');\r\n        }\r\n        else if (markingMode === enums.MarkingMode.Approval) {\r\n            return ((localeStore.instance.TranslateText('marking.worklist.response-data.standardisation-response-title')) + ' ');\r\n        }\r\n        else if (markingMode === enums.MarkingMode.ES_TeamApproval) {\r\n            return ((localeStore.instance.TranslateText('marking.worklist.response-data.second-standardisation-response-title')) + ' ');\r\n        }\r\n        else {\r\n            return '';\r\n        }\r\n    };\r\n    MessageHelper._isPasteEnabled = false;\r\n    MessageHelper.messageEditorId = 'msg-tinymce-editor';\r\n    /**\r\n     * This method will return the selected item for priority dropdown based on priority name\r\n     */\r\n    MessageHelper.getPriorityDropDownSelectedItem = function (priorityName) {\r\n        if (priorityName === enums.getEnumString(enums.MessagePriority, enums.MessagePriority.Standard)) {\r\n            return enums.MessagePriority.Standard;\r\n        }\r\n        else if (priorityName === enums.getEnumString(enums.MessagePriority, enums.MessagePriority.Important)) {\r\n            return enums.MessagePriority.Important;\r\n        }\r\n        else if (priorityName === enums.getEnumString(enums.MessagePriority, enums.MessagePriority.Mandatory)) {\r\n            // When replying and forwarding a  mandatory message,priority need to be reset to standard.\r\n            return enums.MessagePriority.Standard;\r\n        }\r\n    };\r\n    /**\r\n     * returns the navigate to default options for different message types.\r\n     */\r\n    MessageHelper.getNavigateAwayType = function (messageType) {\r\n        var navigateTo = enums.SaveAndNavigate.none;\r\n        switch (messageType) {\r\n            case enums.MessageType.ResponseReply:\r\n            case enums.MessageType.ResponseForward:\r\n            case enums.MessageType.ResponseCompose:\r\n                navigateTo = enums.SaveAndNavigate.toNewResponseMessageCompose;\r\n                break;\r\n        }\r\n        return navigateTo;\r\n    };\r\n    /**\r\n     * Returns true if focus needs to be set in tinymce editor else return false\r\n     */\r\n    MessageHelper.hasFocus = function (messageType) {\r\n        return (messageType === enums.MessageType.InboxForward || messageType === enums.MessageType.InboxReply\r\n            || messageType === enums.MessageType.ResponseReply || messageType === enums.MessageType.ResponseForward);\r\n    };\r\n    MessageHelper.addInitMouseClickEventScriptBlock = function () {\r\n        // we have to close opened priority drop down and user options (logout options) while clicking on outside that. iframe was\r\n        // preventing the click event to propagate outside so closing of those things are not happening while clicking on iframe.\r\n        // dynamically add script to create mouse event\r\n        var scriptElement = document.getElementById('init_mouse_click_event_script_block');\r\n        var isScriptElementPresent = false;\r\n        if (scriptElement != null) {\r\n            isScriptElementPresent = true;\r\n        }\r\n        else {\r\n            scriptElement = document.createElement('script');\r\n            scriptElement.id = 'init_mouse_click_event_script_block';\r\n            scriptElement.innerText =\r\n                'function initMouseClickEvent() {' +\r\n                    'let event = document.createEvent(\\'MouseEvents\\');' +\r\n                    'event.initMouseEvent(\\'click\\', true, true, window, 0, 0, 0, 80, 20, false, false, false, false, 0, null);' +\r\n                    'window.dispatchEvent(event); }';\r\n        }\r\n        if (!isScriptElementPresent) {\r\n            document.body.appendChild(scriptElement);\r\n        }\r\n    };\r\n    MessageHelper.removeInitMouseClickEventScriptBlock = function () {\r\n        var scriptElement = document.getElementById('init_mouse_click_event_script_block');\r\n        if (htmlUtilities.getUserDevice().browser !== 'IE') {\r\n            document.body.removeChild(scriptElement);\r\n        }\r\n    };\r\n    MessageHelper.setPasteEnabledAction = function (isPasteEnabled) {\r\n        MessageHelper._isPasteEnabled = isPasteEnabled;\r\n    };\r\n    /**\r\n     * Method which gets the selected QIG's name based on the Awarding Body specific QIG Naming format\r\n     */\r\n    MessageHelper.getCurrentQIGName = function () {\r\n        // Calling the helper method to format the QIG Name\r\n        if (qigStore.instance.selectedQIGForMarkerOperation !== undefined) {\r\n            var selectedQig = qigStore.instance.selectedQIGForMarkerOperation;\r\n            return stringFormatHelper.formatAwardingBodyQIG(selectedQig.markSchemeGroupName, selectedQig.assessmentCode, selectedQig.sessionName, selectedQig.componentId, selectedQig.questionPaperName, selectedQig.assessmentName, selectedQig.componentName, stringFormatHelper.getOverviewQIGNameFormat());\r\n        }\r\n        // If a QIG is not selected, return the default text to be shown on the drop down\r\n        return localeStore.instance.TranslateText('messaging.compose-message.please-select-qig-placeholder');\r\n    };\r\n    /**\r\n     * Handles changes in the message panel subject section.\r\n     * @param e\r\n     */\r\n    MessageHelper.handleSubjectChange = function (subject) {\r\n        MessageHelper.messageSubject = subject;\r\n    };\r\n    return MessageHelper;\r\n}());\r\nmodule.exports = MessageHelper;\r\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 42)))//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjgzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS9tZXNzYWdlL21lc3NhZ2VoZWxwZXIudHM/NmViOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbWVzc2FnZXN0b3JlID0gcmVxdWlyZSgnLi4vLi4vLi4vc3RvcmVzL21lc3NhZ2UvbWVzc2FnZXN0b3JlJyk7XHJcbmltcG9ydCBxaWdTdW1tYXJ5ID0gcmVxdWlyZSgnLi4vLi4vLi4vc3RvcmVzL3FpZ3NlbGVjdG9yL3R5cGluZ3MvcWlnc3VtbWFyeScpO1xyXG5pbXBvcnQgZ3JvdXBIZWxwZXIgPSByZXF1aXJlKCcuLi8uLi8uLi91dGlsaXR5L2dyb3VwaW5nL2dyb3VwaGVscGVyJyk7XHJcbmltcG9ydCBncm91cGVyTGlzdCA9IHJlcXVpcmUoJy4uLy4uLy4uL3V0aWxpdHkvZ3JvdXBpbmcvZ3JvdXBpbmdiYXNlL2dyb3VwZXJsaXN0Jyk7XHJcbmltcG9ydCBJbW11dGFibGUgPSByZXF1aXJlKCdpbW11dGFibGUnKTtcclxuaW1wb3J0IGVudW1zID0gcmVxdWlyZSgnLi4vZW51bXMnKTtcclxuaW1wb3J0IGxvY2FsZWhlbHBlciA9IHJlcXVpcmUoJy4uLy4uLy4uL3V0aWxpdHkvbG9jYWxlL2xvY2FsZWhlbHBlcicpO1xyXG5pbXBvcnQgc3RyaW5nRm9ybWF0SGVscGVyID0gcmVxdWlyZSgnLi4vLi4vLi4vdXRpbGl0eS9zdHJpbmdmb3JtYXQvc3RyaW5nZm9ybWF0aGVscGVyJyk7XHJcbmltcG9ydCBsb2NhbGVTdG9yZSA9IHJlcXVpcmUoJy4uLy4uLy4uL3N0b3Jlcy9sb2NhbGUvbG9jYWxlc3RvcmUnKTtcclxuaW1wb3J0IG1lc3NhZ2VFZGl0b3JDb25zdGFudHMgPSByZXF1aXJlKCcuLi9tZXNzYWdlZWRpdG9yY29uc3RhbnRzJyk7XHJcbmltcG9ydCBzdHJpbmdIZWxwZXIgPSByZXF1aXJlKCcuLi8uLi8uLi91dGlsaXR5L2dlbmVyaWMvc3RyaW5naGVscGVyJyk7XHJcbmltcG9ydCBodG1sVXRpbGl0aWVzID0gcmVxdWlyZSgnLi4vLi4vLi4vdXRpbGl0eS9nZW5lcmljL2h0bWx1dGlsaXRpZXMnKTtcclxuaW1wb3J0IG5hdmlnYXRpb25TdG9yZSA9IHJlcXVpcmUoJy4uLy4uLy4uL3N0b3Jlcy9uYXZpZ2F0aW9uL25hdmlnYXRpb25zdG9yZScpO1xyXG5pbXBvcnQgbWFya2VyT3BlcmF0aW9uTW9kZUZhY3RvcnkgPSByZXF1aXJlKCcuLi9tYXJrZXJvcGVyYXRpb25tb2RlL21hcmtlcm9wZXJhdGlvbm1vZGVmYWN0b3J5Jyk7XHJcbmltcG9ydCBxaWdTdG9yZSA9IHJlcXVpcmUoJy4uLy4uLy4uL3N0b3Jlcy9xaWdzZWxlY3Rvci9xaWdzdG9yZScpO1xyXG5pbXBvcnQgdGVhbU1hbmFnZW1lbnRTdG9yZSA9IHJlcXVpcmUoJy4uLy4uLy4uL3N0b3Jlcy90ZWFtbWFuYWdlbWVudC90ZWFtbWFuYWdlbWVudHN0b3JlJyk7XHJcbmltcG9ydCBleGFtaW5lclN0b3JlID0gcmVxdWlyZSgnLi4vLi4vLi4vc3RvcmVzL21hcmtlcmluZm9ybWF0aW9uL2V4YW1pbmVyc3RvcmUnKTtcclxuXHJcbmRlY2xhcmUgbGV0IHRpbnltY2U6IGFueTtcclxuXHJcbmNsYXNzIE1lc3NhZ2VIZWxwZXIge1xyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgX2lzUGFzdGVFbmFibGVkOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgbWVzc2FnZUVkaXRvcklkOiBzdHJpbmcgPSAnbXNnLXRpbnltY2UtZWRpdG9yJztcclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBtZXNzYWdlU3ViamVjdDogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBIZWFkZXIgdG8gZGlzcGxheSBhbmQgdGhlIHJlbGF0ZWQgbWVzc2dlc1xyXG4gICAgICogQHBhcmFtIG1lc3NhZ2VzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0R3JvdXBlZE1lc3NhZ2VPYmplY3QobWVzc2FnZXM6IEltbXV0YWJsZS5MaXN0PE1lc3NhZ2U+LCBleHBhbmRPckNvbGxhcHNlRGV0YWlsczogSW1tdXRhYmxlLk1hcDxudW1iZXIsIGJvb2xlYW4+KTpcclxuICAgICAgICBNZXNzYWdlR3JvdXBEZXRhaWxzIHtcclxuICAgICAgICAvLyBUbyBzdG9yZSB0aGUgbWVzc2FnZXMgYWZ0ZXIgdGhlIGdyb3VwaW5nIGFuZCBzb3J0aW5nXHJcbiAgICAgICAgbGV0IG1lc3NhZ2VMaXN0OiBJbW11dGFibGUuTGlzdDxNZXNzYWdlPiA9IEltbXV0YWJsZS5MaXN0PE1lc3NhZ2U+KCk7XHJcblxyXG4gICAgICAgIC8vIEdldCB0aGUgbWVzc2FnZXMgZ3JvdXBlZCBieSBRSUdcclxuICAgICAgICBsZXQgZ3JvdXBlZE1lc3NhZ2VzID0gZ3JvdXBIZWxwZXIuZ3JvdXAobWVzc2FnZXMsIGdyb3VwZXJMaXN0Lk1lc3NhZ2VRaWdHcm91cGVyLCBlbnVtcy5Hcm91cEJ5RmllbGQucWlnKTtcclxuXHJcbiAgICAgICAgLy8gR2V0IHRoZSBrZXkgc2VxXHJcbiAgICAgICAgbGV0IGdyb3VwZWRLZXlzID0gZ3JvdXBlZE1lc3NhZ2VzLmtleVNlcSgpO1xyXG5cclxuICAgICAgICAvLyBDcmVhdGUgdGhlIHJldHVybiBvYmplY3RcclxuICAgICAgICBsZXQgcmV0dXJuT2JqOiBNZXNzYWdlR3JvdXBEYXRhW10gPSBbXTtcclxuXHJcbiAgICAgICAgLy8gTG9vcCB0aHJvdWdoIHRoZSBrZXlzIGFuZCBmaW5kIHRoZSBsaXN0IG9mIG1lc3NhZ2VzIGZvciB0aGUgZ3JvdXAuXHJcbiAgICAgICAgZ3JvdXBlZEtleXMuZm9yRWFjaCgocWlnSWQ6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAvLyBHZXQgdGhlIG1lc3NhZ2VzIGZvciB0aGUgZ3JvdXAuXHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50TWVzc2FnZUdyb3VwID0gZ3JvdXBlZE1lc3NhZ2VzLmdldChxaWdJZCk7XHJcblxyXG4gICAgICAgICAgICAvLyBDbGVhciB0aGUgY29sbGVjdGlvbiwgSW4gZWFjaCBncm91cC5cclxuICAgICAgICAgICAgbGV0IG1lc3NhZ2VzID0gW107XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgdGhlIGVhY2ggbWVzc2FnZXMgZm9yIHRoZSBncm91cC5cclxuICAgICAgICAgICAgY3VycmVudE1lc3NhZ2VHcm91cC5tYXAoKG1lc3NhZ2U6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2Uuc3RhdHVzID09PSBlbnVtcy5NZXNzYWdlUmVhZFN0YXR1cy5OZXcgJiYgbWVzc2FnZXN0b3JlLmluc3RhbmNlLmlzTWVzc2FnZVJlYWQobWVzc2FnZS5leGFtaW5lck1lc3NhZ2VJZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLnN0YXR1cyA9IGVudW1zLk1lc3NhZ2VSZWFkU3RhdHVzLlJlYWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlcy5wdXNoKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIEdldCB0aGUgYXdhcmRpbmcgYm9keSBuYW1lIGZvcm1hdFxyXG4gICAgICAgICAgICBsZXQgbmFtZVRvRGlzcGxheSA9IE1lc3NhZ2VIZWxwZXIuZ2V0RGlzcGxheVRleHQobWVzc2FnZXNbMF0pO1xyXG5cclxuICAgICAgICAgICAgbGV0IG1lc3NhZ2VGb2xkZXJUeXBlOiBlbnVtcy5NZXNzYWdlRm9sZGVyVHlwZSA9IG1lc3NhZ2VzWzBdLm1lc3NhZ2VGb2xkZXJUeXBlO1xyXG5cclxuICAgICAgICAgICAgLy8gQ3JlYXRlIGFuIG9iamVjdCB0byBzdG9yZSBtZXNzYWdlc1xyXG4gICAgICAgICAgICBsZXQgZ3JvdXBlZE9iajogTWVzc2FnZUdyb3VwRGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIHFpZ0lkOiBwYXJzZUludChxaWdJZCksXHJcbiAgICAgICAgICAgICAgICBpc09wZW46IHRoaXMuaXNRaWdPcGVuKHBhcnNlSW50KHFpZ0lkKSwgbWVzc2FnZUZvbGRlclR5cGUsIGV4cGFuZE9yQ29sbGFwc2VEZXRhaWxzKSxcclxuICAgICAgICAgICAgICAgIHRleHRUb0Rpc3BsYXk6IG5hbWVUb0Rpc3BsYXksXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlczogbWVzc2FnZXMsXHJcbiAgICAgICAgICAgICAgICB1blJlYWRNZXNzYWdlczogbWVzc2FnZXMuZmlsdGVyKCh4OiBNZXNzYWdlKSA9PlxyXG4gICAgICAgICAgICAgICAgICAgIHguc3RhdHVzID09PSBlbnVtcy5NZXNzYWdlUmVhZFN0YXR1cy5OZXcgJiYgIW1lc3NhZ2VzdG9yZS5pbnN0YW5jZS5pc01lc3NhZ2VSZWFkKHguZXhhbWluZXJNZXNzYWdlSWQpKS5sZW5ndGhcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybk9iai5wdXNoKGdyb3VwZWRPYmopO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBTb3J0IHRoZSBvYmplY3RzIGJhc2VkIG9uIHRoZSBkaXNwbGF5IGhlYWRlci5cclxuICAgICAgICBsZXQgZ2V0R3JvdXBlZE1lc3NhZ2VPYmplY3QgPSByZXR1cm5PYmouc29ydChmdW5jdGlvbiAob2JqMTogTWVzc2FnZUdyb3VwRGF0YSwgb2JqMjogTWVzc2FnZUdyb3VwRGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gb2JqMS50ZXh0VG9EaXNwbGF5LmxvY2FsZUNvbXBhcmUob2JqMi50ZXh0VG9EaXNwbGF5KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gR2V0IHRoZSBtZXNzYWdlcyBhcyBpbiB0aGUgb3JkZXIgb2YgZGlzcGxheWluZyBpbiB0aGUgVUlcclxuICAgICAgICBnZXRHcm91cGVkTWVzc2FnZU9iamVjdC5mb3JFYWNoKChtZXNzYWdlT2JqZWN0OiBNZXNzYWdlR3JvdXBEYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VMaXN0ID0gSW1tdXRhYmxlLkxpc3Q8TWVzc2FnZT4obWVzc2FnZUxpc3QuY29uY2F0KG1lc3NhZ2VPYmplY3QubWVzc2FnZXMpKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IG1lc3NhZ2VHcm91cERldGFpbHM6IE1lc3NhZ2VHcm91cERldGFpbHMgPSB7XHJcbiAgICAgICAgICAgIC8vIFN0b3JlcyB0aGUgR3JvdXBlZCBPYmplY3QgYWxvbmcgd2l0aCB0aG9zZSBtZXNzYWdlc1xyXG4gICAgICAgICAgICBNZXNzYWdlR3JvdXBPYmplY3RzOiBnZXRHcm91cGVkTWVzc2FnZU9iamVjdCxcclxuXHJcbiAgICAgICAgICAgIC8vIFN0b3JlIGFsbCBtZXNzYWdlcyBmb3IgdGhlIFVJXHJcbiAgICAgICAgICAgIG1lc3NhZ2VzOiBtZXNzYWdlTGlzdFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBtZXNzYWdlR3JvdXBEZXRhaWxzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB3aGV0aGVyIGEgcGFydGljdWxhciBxaWcgaXMgb3BlbiBvciBub3RcclxuICAgICAqIEBwYXJhbSBleHBhbmRPckNvbGxhcHNlRGV0YWlscyBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgaXNRaWdPcGVuKHFpZ0lkOiBudW1iZXIsIG1lc3NhZ2VGb2xkZXJUeXBlOiBlbnVtcy5NZXNzYWdlRm9sZGVyVHlwZSxcclxuICAgICAgICBleHBhbmRPckNvbGxhcHNlRGV0YWlsczogSW1tdXRhYmxlLk1hcDxudW1iZXIsIGJvb2xlYW4+KTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIGV4cGFuZE9yQ29sbGFwc2VEZXRhaWxzID8gZXhwYW5kT3JDb2xsYXBzZURldGFpbHMuZ2V0KHFpZ0lkLCB0cnVlKSA6IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIHRpbWUgc3R5bGUgZm9yIHRoZSBEYXRlXHJcbiAgICAgKiBAcGFyYW0gdGltZVRvRGlzcGxheVxyXG4gICAgICogQHBhcmFtIHRvZGF5VGV4dENvbnZlcnNpb25SZXF1aXJlZCA6IGZvciBkZWNpZGluZyBUb2RheSB0ZXh0IGNvbnZlcnNpb25cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXREYXRlVG9EaXNwbGF5KHRpbWVUb0Rpc3BsYXk6IHN0cmluZywgdG9kYXlUZXh0Q29udmVyc2lvblJlcXVpcmVkOiBib29sZWFuID0gdHJ1ZSkge1xyXG4gICAgICAgIGxldCB0aW1lVG9EaXNwbGF5RGF0ZSA9IG5ldyBEYXRlKHRpbWVUb0Rpc3BsYXkpO1xyXG5cclxuICAgICAgICBsZXQgdG9kYXlzRGF0ZSA9IG5ldyBEYXRlKCk7XHJcblxyXG4gICAgICAgIGxldCB0aW1lOiBzdHJpbmcgPSBsb2NhbGVoZWxwZXIudG9Mb2NhbGVUaW1lU3RyaW5nKG5ldyBEYXRlKHRpbWVUb0Rpc3BsYXkudG9TdHJpbmcoKSkpO1xyXG5cclxuICAgICAgICAvLyBjYWxsIHNldEhvdXJzIHRvIHRha2UgdGhlIHRpbWUgb3V0IG9mIHRoZSBjb21wYXJpc29uXHJcbiAgICAgICAgaWYgKCh0aW1lVG9EaXNwbGF5RGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKSA9PT0gdG9kYXlzRGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKSkgJiYgdG9kYXlUZXh0Q29udmVyc2lvblJlcXVpcmVkKSB7XHJcbiAgICAgICAgICAgIC8vIERhdGUgZXF1YWxzIHRvZGF5J3MgZGF0ZS4gRGlzcGxheSBkYXRlIGZlaWxkIGFzIFRvZGF5LlxyXG4gICAgICAgICAgICByZXR1cm4gbG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dCgnbWVzc2FnaW5nLm1lc3NhZ2UtbGlzdHMubWVzc2FnZS1kZXRhaWwuZGF0ZS10b2RheScpICsgJyAnICsgdGltZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbG9jYWxlaGVscGVyLnRvTG9jYWxlRGF0ZVN0cmluZyhuZXcgRGF0ZSh0aW1lVG9EaXNwbGF5KSkgKyAnICcgKyB0aW1lO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCB0aGUgRGlzcGxheSBIZWFkZXIgZm9yIHRoZSBHcm91cCBIZWFkZXIuXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldERpc3BsYXlUZXh0KG1lc3NhZ2U6IE1lc3NhZ2UpIHtcclxuICAgICAgICBsZXQgbXNnID0gbWVzc2FnZXN0b3JlLmluc3RhbmNlLm1lc3NhZ2VzTWFya1NjaGVtZXM7XHJcbiAgICAgICAgaWYgKG1zZykge1xyXG4gICAgICAgICAgICBsZXQgbWVzc2FnZUxpc3QgPSBtc2cuZmlsdGVyKChtZXNzYWdlczogTWVzc2FnaW5nTWFya1NjaGVtZSkgPT4gbWVzc2FnZXMubWFya1NjaGVtZUdyb3VwSWQgPT09IG1lc3NhZ2UubWFya1NjaGVtZUdyb3VwSWQpO1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nRm9ybWF0SGVscGVyLmZvcm1hdEF3YXJkaW5nQm9keVFJRyhcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTGlzdC5maXJzdCgpLm1hcmtTY2hlbWVHcm91cE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUxpc3QuZmlyc3QoKS5hc3Nlc3NtZW50Q29kZSxcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTGlzdC5maXJzdCgpLnNlc3Npb25OYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VMaXN0LmZpcnN0KCkuY29tcG9uZW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUxpc3QuZmlyc3QoKS5xdWVzdGlvblBhcGVyTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTGlzdC5maXJzdCgpLmFzc2Vzc21lbnROYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VMaXN0LmZpcnN0KCkuY29tcG9uZW50TmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBzdHJpbmdGb3JtYXRIZWxwZXIuZ2V0T3ZlcnZpZXdRSUdOYW1lRm9ybWF0KCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIHRoZSBNYXJrIFNjaGVtZSBHcm91cCBOYW1lXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldE1hcmtTY2hlbWVHcm91cE5hbWUobWVzc2FnZTogTWVzc2FnZSk6IHN0cmluZyB7XHJcbiAgICAgICAgbGV0IG1zZyA9IG1lc3NhZ2VzdG9yZS5pbnN0YW5jZS5tZXNzYWdlc01hcmtTY2hlbWVzO1xyXG4gICAgICAgIGlmIChtc2cpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1zZy5maWx0ZXIoKG1lc3NhZ2VzOiBNZXNzYWdpbmdNYXJrU2NoZW1lKSA9PiBtZXNzYWdlcy5tYXJrU2NoZW1lR3JvdXBJZCA9PT0gbWVzc2FnZS5tYXJrU2NoZW1lR3JvdXBJZCkuXHJcbiAgICAgICAgICAgICAgICBmaXJzdCgpLm1hcmtTY2hlbWVHcm91cE5hbWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVXNlZCB0byBjcmVhdGUgdGhlIE1lc3NhZ2VPckV4Y2VwdGlvbkxpbmtlZEl0ZW1zIGJhc2VkIG9uIHRoZSBtZXNzYWdlc1xyXG4gICAgICogQHBhcmFtIG1lc3NhZ2VzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0TWVzc2FnZUxpbmtlZEl0ZW1zKG1lc3NhZ2VzOiBJbW11dGFibGUuTGlzdDxNZXNzYWdlPik6IEltbXV0YWJsZS5MaXN0PE1lc3NhZ2VPckV4Y2VwdGlvbkxpbmtlZEl0ZW0+IHtcclxuICAgICAgICBsZXQgbWVzc2FnZU9yRXhjZXB0aW9uTGlua2VkSXRlbXM6IE1lc3NhZ2VPckV4Y2VwdGlvbkxpbmtlZEl0ZW1bXSA9IFtdO1xyXG4gICAgICAgIGxldCBpdGVtcyA9IG1lc3NhZ2VzLmZvckVhY2goKG1lc3NhZ2U6IE1lc3NhZ2UpID0+IHtcclxuICAgICAgICAgICAgbWVzc2FnZU9yRXhjZXB0aW9uTGlua2VkSXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBpdGVtSWQ6IG1lc3NhZ2UuZXhhbWluZXJNZXNzYWdlSWQsXHJcbiAgICAgICAgICAgICAgICBzZW5kZXJPckl0ZW06IG1lc3NhZ2UudG9UZWFtID9cclxuICAgICAgICAgICAgICAgICAgICBsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcuY29tcG9zZS1tZXNzYWdlLnJlY2lwaWVudC1zZWxlY3Rvci5lbnRpcmUtdGVhbScpIDpcclxuICAgICAgICAgICAgICAgICAgICBNZXNzYWdlSGVscGVyLmFwcGVuZEV4YW1pbmVyKG1lc3NhZ2UpLFxyXG4gICAgICAgICAgICAgICAgcHJpb3JpdHlPclN0YXR1czogbWVzc2FnZS5wcmlvcml0eU5hbWUsXHJcbiAgICAgICAgICAgICAgICBzdWJqZWN0T3JUeXBlOiBtZXNzYWdlLnN1YmplY3QsXHJcbiAgICAgICAgICAgICAgICB0aW1lVG9EaXNwbGF5OiBtZXNzYWdlLmRpc3BsYXlEYXRlLFxyXG4gICAgICAgICAgICAgICAgaXNVbnJlYWRPclVuYWN0aW9uZWQ6IG1lc3NhZ2Uuc3RhdHVzID09PSBlbnVtcy5NZXNzYWdlUmVhZFN0YXR1cy5OZXcgJiZcclxuICAgICAgICAgICAgICAgICFtZXNzYWdlc3RvcmUuaW5zdGFuY2UuaXNNZXNzYWdlUmVhZChtZXNzYWdlLmV4YW1pbmVyTWVzc2FnZUlkKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIEltbXV0YWJsZS5MaXN0KG1lc3NhZ2VPckV4Y2VwdGlvbkxpbmtlZEl0ZW1zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIGFwcGVuZCBleGFtaW5lcnNcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgYXBwZW5kRXhhbWluZXIobWVzc2FnZTogTWVzc2FnZSk6IHN0cmluZyB7XHJcblxyXG4gICAgICAgIGxldCBleGFtaW5lcnM6IHN0cmluZyA9ICcnO1xyXG5cclxuICAgICAgICBpZiAobWVzc2FnZSAmJiBtZXNzYWdlLnRvRXhhbWluZXJEZXRhaWxzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgbWVzc2FnZS50b0V4YW1pbmVyRGV0YWlscy5tYXAoKGl0ZW06IEV4YW1pbmVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBleGFtaW5lcnMgKz0gaXRlbS5mdWxsTmFtZSArICc7JztcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyByZW1vdmluZyBsYXN0IGl0ZW0gc2VtaWNvbG9uXHJcbiAgICAgICAgICAgIHJldHVybiBleGFtaW5lcnMucmVwbGFjZSgvOyQvLCAnJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZXhhbWluZXJzID0gbWVzc2FnZS5leGFtaW5lckRldGFpbHMuZnVsbE5hbWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZXhhbWluZXJzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBtZXRob2Qgd2lsbCByZXR1cm5zIHRoZSBtZXNzYWdlIGNvbnRlbnQgYmFzZWQgb24gdGhlIHRlbXBsYXRlIG5hbWVcclxuICAgICAqIEBwYXJhbSB0ZW1wbGF0ZU5hbWUgLSB0ZW1wbGF0ZSBuYW1lXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZUJvZHkgLSBtZXNzYWdlIGNvbnRlbnRcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRNZXNzYWdlQ29udGVudCh0ZW1wbGF0ZU5hbWU6IGVudW1zLk1lc3NhZ2VUeXBlLCBtZXNzYWdlRnJvbT86IHN0cmluZywgZGF0ZT86IHN0cmluZywgbWVzc2FnZUJvZHk/OiBzdHJpbmcpIHtcclxuICAgICAgICBsZXQgdGVtcGxhdGU6IHN0cmluZztcclxuICAgICAgICBzd2l0Y2ggKHRlbXBsYXRlTmFtZSkge1xyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLkluYm94UmVwbHk6XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZVR5cGUuUmVzcG9uc2VSZXBseTpcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlID0gc3RyaW5nSGVscGVyLmZvcm1hdChsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcuY29tcG9zZS1tZXNzYWdlLm5ldy1tZXNzYWdlLXRlbXBsYXRlcy5yZXBseScpLFxyXG4gICAgICAgICAgICAgICAgICAgIFttZXNzYWdlRWRpdG9yQ29uc3RhbnRzLlRJTllNQ0VfREVGQVVMVF9GT05ULCBtZXNzYWdlRWRpdG9yQ29uc3RhbnRzLlRJTllNQ0VfREVGQVVMVF9GT05UU0laRSxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldERhdGVUb0Rpc3BsYXkoZGF0ZSwgZmFsc2UpLCBtZXNzYWdlRnJvbSwgbWVzc2FnZUJvZHldKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLkluYm94Rm9yd2FyZDpcclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5NZXNzYWdlVHlwZS5SZXNwb25zZUZvcndhcmQ6XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZSA9IHN0cmluZ0hlbHBlci5mb3JtYXQobG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dFxyXG4gICAgICAgICAgICAgICAgICAgICgnbWVzc2FnaW5nLmNvbXBvc2UtbWVzc2FnZS5uZXctbWVzc2FnZS10ZW1wbGF0ZXMuZm9yd2FyZCcpLFxyXG4gICAgICAgICAgICAgICAgICAgIFttZXNzYWdlRWRpdG9yQ29uc3RhbnRzLlRJTllNQ0VfREVGQVVMVF9GT05ULCBtZXNzYWdlRWRpdG9yQ29uc3RhbnRzLlRJTllNQ0VfREVGQVVMVF9GT05UU0laRSxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldERhdGVUb0Rpc3BsYXkoZGF0ZSwgZmFsc2UpLCBtZXNzYWdlRnJvbSwgbWVzc2FnZUJvZHldKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLlJlc3BvbnNlQ29tcG9zZTpcclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5NZXNzYWdlVHlwZS5Xb3JrbGlzdENvbXBvc2U6XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hDb21wb3NlOlxyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLlRlYW1Db21wb3NlOlxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGUgPSBzdHJpbmdIZWxwZXIuZm9ybWF0KGxvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UubmV3LW1lc3NhZ2UtdGVtcGxhdGVzLm5ldycpLFxyXG4gICAgICAgICAgICAgICAgICAgIFttZXNzYWdlRWRpdG9yQ29uc3RhbnRzLlRJTllNQ0VfREVGQVVMVF9GT05ULCBtZXNzYWdlRWRpdG9yQ29uc3RhbnRzLlRJTllNQ0VfREVGQVVMVF9GT05UU0laRV0pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBtZXRob2Qgd2lsbCByZXR1cm4gdGhlIE1lbnUgQWN0aW9uIGl0ZW1zIG5lZWRlZCBiYXNlZCBvbiB0aGUgZm9sZGVyIHR5cGVcclxuICAgICAqIEBwYXJhbSBmb2xkZXJUeXBlXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZUFjdGlvbnM6IGFuIGFycmF5IG9mIG1lc3NhZ2UgYWN0aW9uc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldE1lc3NhZ2VNZW51QWN0aW9uSXRlbXMoZm9sZGVyVHlwZTogZW51bXMuTWVzc2FnZUZvbGRlclR5cGUsIG1lc3NhZ2VBY3Rpb25zOiBBcnJheTxlbnVtcy5NZXNzYWdlQWN0aW9uPikge1xyXG4gICAgICAgIGxldCBtZXNzYWdlTWVudUFjdGlvbkl0ZW1zOiBBcnJheTxhbnk+ID0gW107XHJcbiAgICAgICAgc3dpdGNoIChmb2xkZXJUeXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZUZvbGRlclR5cGUuSW5ib3g6XHJcbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUFjdGlvbnMgJiYgbWVzc2FnZUFjdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VBY3Rpb25zLm1hcCgoeDogZW51bXMuTWVzc2FnZUFjdGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aW9uSXRlbXMgPSB0aGlzLm1lc3NhZ2VBY3Rpb25JdGVtcyh4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbkl0ZW1zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTWVudUFjdGlvbkl0ZW1zLnB1c2goYWN0aW9uSXRlbXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtZXNzYWdlTWVudUFjdGlvbkl0ZW1zO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBtZXRob2Qgd2lsbCByZXR1cm4gdGhlIGxvY2FsaXNlZCBtZXNzYWdlIHN0cmluZyBiYXNlZCBvbiBtZXNzYWdlIHR5cGVcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRNZXNzYWdlSGVhZGVyKG1lc3NhZ2VUeXBlOiBlbnVtcy5NZXNzYWdlVHlwZSkge1xyXG4gICAgICAgIGxldCBtZXNzYWdlSGVhZGVyOiBzdHJpbmc7XHJcbiAgICAgICAgc3dpdGNoIChtZXNzYWdlVHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLkluYm94Q29tcG9zZTpcclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5NZXNzYWdlVHlwZS5Xb3JrbGlzdENvbXBvc2U6XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZVR5cGUuUmVzcG9uc2VDb21wb3NlOlxyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLlRlYW1Db21wb3NlOlxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZUhlYWRlciA9IGxvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UubmV3LW1lc3NhZ2UtaGVhZGVyJyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5NZXNzYWdlVHlwZS5JbmJveEZvcndhcmQ6XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZVR5cGUuUmVzcG9uc2VGb3J3YXJkOlxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZUhlYWRlciA9IGxvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UuZm9yd2FyZC1oZWFkZXInKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLkluYm94UmVwbHk6XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZVR5cGUuUmVzcG9uc2VSZXBseTpcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VIZWFkZXIgPSBsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcuY29tcG9zZS1tZXNzYWdlLnJlcGx5LWhlYWRlcicpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZVR5cGUuUmVzcG9uc2VEZXRhaWxzOlxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZUhlYWRlciA9IGxvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21hcmtpbmcucmVzcG9uc2UubWVzc2FnZS1wYW5lbC5oZWFkZXInKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbWVzc2FnZUhlYWRlcjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgcmV0dXJucyB0aGUgc3ViamVjdCBzdHJpbmdcclxuICAgICAqIEBwYXJhbSBtZXNzYWdlVHlwZVxyXG4gICAgICogQHBhcmFtIHN1YmplY3RcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRTdWJqZWN0Q29udGVudChtZXNzYWdlVHlwZTogZW51bXMuTWVzc2FnZVR5cGUsIHN1YmplY3Q6IHN0cmluZykge1xyXG4gICAgICAgIGxldCBzdWJqZWN0VGV4dDogc3RyaW5nO1xyXG4gICAgICAgIGxldCBzdWJqZWN0UHJlZml4OiBzdHJpbmc7XHJcbiAgICAgICAgc3dpdGNoIChtZXNzYWdlVHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLkluYm94Q29tcG9zZTpcclxuICAgICAgICAgICAgICAgIHN1YmplY3RUZXh0ID0gc3ViamVjdDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLkluYm94Rm9yd2FyZDpcclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5NZXNzYWdlVHlwZS5SZXNwb25zZUZvcndhcmQ6XHJcbiAgICAgICAgICAgICAgICBzdWJqZWN0UHJlZml4ID0gbG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dCgnbWVzc2FnaW5nLmNvbXBvc2UtbWVzc2FnZS5mb3J3YXJkLXByZWZpeCcpO1xyXG4gICAgICAgICAgICAgICAgc3ViamVjdFRleHQgPSBzdWJqZWN0LmluZGV4T2Yoc3ViamVjdFByZWZpeCkgPT09IC0xID8gc3ViamVjdFByZWZpeCArICcgJyArIHN1YmplY3QgOiBzdWJqZWN0O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hSZXBseTpcclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5NZXNzYWdlVHlwZS5SZXNwb25zZVJlcGx5OlxyXG4gICAgICAgICAgICAgICAgc3ViamVjdFByZWZpeCA9IGxvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UucmVwbHktcHJlZml4Jyk7XHJcbiAgICAgICAgICAgICAgICBzdWJqZWN0VGV4dCA9IHN1YmplY3QuaW5kZXhPZihzdWJqZWN0UHJlZml4KSA9PT0gLTEgPyBzdWJqZWN0UHJlZml4ICsgJyAnICsgc3ViamVjdCA6IHN1YmplY3Q7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBzdWJqZWN0VGV4dDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCB0aGUgQ3JlYXRlIG5ldyB0ZXh0IGZvciB0aGUgY29tcG9uZW50LlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldCBnZXRDcmVhdGVOZXdNZXNzYWdlVGV4dCgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtYXJraW5nLnJlc3BvbnNlLm1lc3NhZ2UtbGlzdC1wYW5lbC5jcmVhdGUtbmV3LW1lc3NhZ2UnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgcmV0dXJuIHRoZSBNZW51IEFjdGlvbiBpdGVtIGJhc2VkIG9uIHRoZSBhY3Rpb24gcGFyYW1ldGVyXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZUFjdGlvblxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIG1lc3NhZ2VBY3Rpb25JdGVtcyhtZXNzYWdlQWN0aW9uOiBlbnVtcy5NZXNzYWdlQWN0aW9uKSB7XHJcbiAgICAgICAgc3dpdGNoIChtZXNzYWdlQWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZUFjdGlvbi5SZXBseTpcclxuICAgICAgICAgICAgICAgIHJldHVybiAoe1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBlbnVtcy5NZXNzYWdlQWN0aW9uLlJlcGx5LFxyXG4gICAgICAgICAgICAgICAgICAgIGljb246ICdyZXBseS1pY29uJyxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcubWVzc2FnZS1saXN0cy5tZXNzYWdlLWRldGFpbC5yZXBseS1idXR0b24nKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZUFjdGlvbi5Gb3J3YXJkOlxyXG4gICAgICAgICAgICAgICAgaWYgKCFtYXJrZXJPcGVyYXRpb25Nb2RlRmFjdG9yeS5vcGVyYXRpb25Nb2RlLmlzRm9yd2FyZEJ1dHRvbkhpZGRlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogZW51bXMuTWVzc2FnZUFjdGlvbi5Gb3J3YXJkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uOiAnZm9yd2FyZC1pY29uJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dCgnbWVzc2FnaW5nLm1lc3NhZ2UtbGlzdHMubWVzc2FnZS1kZXRhaWwuZm9yd2FyZC1idXR0b24nKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZUFjdGlvbi5EZWxldGU6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKHtcclxuICAgICAgICAgICAgICAgICAgICBpZDogZW51bXMuTWVzc2FnZUFjdGlvbi5EZWxldGUsXHJcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2RlbGV0ZS1pY29uLXNtYWxsJyxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcubWVzc2FnZS1saXN0cy5tZXNzYWdlLWRldGFpbC5kZWxldGUtYnV0dG9uJylcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgcmV0dXJuIHRoZSBzZWxlY3RlZCBpdGVtIGZvciBwcmlvcml0eSBkcm9wZG93biBiYXNlZCBvbiBwcmlvcml0eSBuYW1lXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0UHJpb3JpdHlEcm9wRG93blNlbGVjdGVkSXRlbSA9IChwcmlvcml0eU5hbWU6IHN0cmluZyk6IGVudW1zLk1lc3NhZ2VQcmlvcml0eSA9PiB7XHJcbiAgICAgICAgaWYgKHByaW9yaXR5TmFtZSA9PT0gZW51bXMuZ2V0RW51bVN0cmluZyhlbnVtcy5NZXNzYWdlUHJpb3JpdHksIGVudW1zLk1lc3NhZ2VQcmlvcml0eS5TdGFuZGFyZCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGVudW1zLk1lc3NhZ2VQcmlvcml0eS5TdGFuZGFyZDtcclxuICAgICAgICB9IGVsc2UgaWYgKHByaW9yaXR5TmFtZSA9PT0gZW51bXMuZ2V0RW51bVN0cmluZyhlbnVtcy5NZXNzYWdlUHJpb3JpdHksIGVudW1zLk1lc3NhZ2VQcmlvcml0eS5JbXBvcnRhbnQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlbnVtcy5NZXNzYWdlUHJpb3JpdHkuSW1wb3J0YW50O1xyXG4gICAgICAgIH0gZWxzZSBpZiAocHJpb3JpdHlOYW1lID09PSBlbnVtcy5nZXRFbnVtU3RyaW5nKGVudW1zLk1lc3NhZ2VQcmlvcml0eSwgZW51bXMuTWVzc2FnZVByaW9yaXR5Lk1hbmRhdG9yeSkpIHtcclxuICAgICAgICAgICAgLy8gV2hlbiByZXBseWluZyBhbmQgZm9yd2FyZGluZyBhICBtYW5kYXRvcnkgbWVzc2FnZSxwcmlvcml0eSBuZWVkIHRvIGJlIHJlc2V0IHRvIHN0YW5kYXJkLlxyXG4gICAgICAgICAgICByZXR1cm4gZW51bXMuTWVzc2FnZVByaW9yaXR5LlN0YW5kYXJkO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiByZXR1cm5zIHRoZSBuYXZpZ2F0ZSB0byBkZWZhdWx0IG9wdGlvbnMgZm9yIGRpZmZlcmVudCBtZXNzYWdlIHR5cGVzLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGdldE5hdmlnYXRlQXdheVR5cGUgPSAobWVzc2FnZVR5cGU6IGVudW1zLk1lc3NhZ2VUeXBlKTogZW51bXMuU2F2ZUFuZE5hdmlnYXRlID0+IHtcclxuICAgICAgICBsZXQgbmF2aWdhdGVUbzogZW51bXMuU2F2ZUFuZE5hdmlnYXRlID0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLm5vbmU7XHJcblxyXG4gICAgICAgIHN3aXRjaCAobWVzc2FnZVR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5NZXNzYWdlVHlwZS5SZXNwb25zZVJlcGx5OlxyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLlJlc3BvbnNlRm9yd2FyZDpcclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5NZXNzYWdlVHlwZS5SZXNwb25zZUNvbXBvc2U6XHJcbiAgICAgICAgICAgICAgICBuYXZpZ2F0ZVRvID0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLnRvTmV3UmVzcG9uc2VNZXNzYWdlQ29tcG9zZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG5hdmlnYXRlVG87XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIGZvY3VzIG5lZWRzIHRvIGJlIHNldCBpbiB0aW55bWNlIGVkaXRvciBlbHNlIHJldHVybiBmYWxzZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGhhc0ZvY3VzID0gKG1lc3NhZ2VUeXBlOiBlbnVtcy5NZXNzYWdlVHlwZSkgPT4ge1xyXG4gICAgICAgIHJldHVybiAobWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLkluYm94Rm9yd2FyZCB8fCBtZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hSZXBseVxyXG4gICAgICAgICAgICB8fCBtZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuUmVzcG9uc2VSZXBseSB8fCBtZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuUmVzcG9uc2VGb3J3YXJkKTtcclxuICAgIH07XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBhZGRJbml0TW91c2VDbGlja0V2ZW50U2NyaXB0QmxvY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgLy8gd2UgaGF2ZSB0byBjbG9zZSBvcGVuZWQgcHJpb3JpdHkgZHJvcCBkb3duIGFuZCB1c2VyIG9wdGlvbnMgKGxvZ291dCBvcHRpb25zKSB3aGlsZSBjbGlja2luZyBvbiBvdXRzaWRlIHRoYXQuIGlmcmFtZSB3YXNcclxuICAgICAgICAvLyBwcmV2ZW50aW5nIHRoZSBjbGljayBldmVudCB0byBwcm9wYWdhdGUgb3V0c2lkZSBzbyBjbG9zaW5nIG9mIHRob3NlIHRoaW5ncyBhcmUgbm90IGhhcHBlbmluZyB3aGlsZSBjbGlja2luZyBvbiBpZnJhbWUuXHJcbiAgICAgICAgLy8gZHluYW1pY2FsbHkgYWRkIHNjcmlwdCB0byBjcmVhdGUgbW91c2UgZXZlbnRcclxuICAgICAgICBsZXQgc2NyaXB0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbml0X21vdXNlX2NsaWNrX2V2ZW50X3NjcmlwdF9ibG9jaycpO1xyXG4gICAgICAgIGxldCBpc1NjcmlwdEVsZW1lbnRQcmVzZW50OiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHNjcmlwdEVsZW1lbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpc1NjcmlwdEVsZW1lbnRQcmVzZW50ID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzY3JpcHRFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XHJcbiAgICAgICAgICAgIHNjcmlwdEVsZW1lbnQuaWQgPSAnaW5pdF9tb3VzZV9jbGlja19ldmVudF9zY3JpcHRfYmxvY2snO1xyXG4gICAgICAgICAgICBzY3JpcHRFbGVtZW50LmlubmVyVGV4dCA9XHJcbiAgICAgICAgICAgICAgICAnZnVuY3Rpb24gaW5pdE1vdXNlQ2xpY2tFdmVudCgpIHsnICtcclxuICAgICAgICAgICAgICAgICdsZXQgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudChcXCdNb3VzZUV2ZW50c1xcJyk7JyArXHJcbiAgICAgICAgICAgICAgICAnZXZlbnQuaW5pdE1vdXNlRXZlbnQoXFwnY2xpY2tcXCcsIHRydWUsIHRydWUsIHdpbmRvdywgMCwgMCwgMCwgODAsIDIwLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgMCwgbnVsbCk7JyArXHJcbiAgICAgICAgICAgICAgICAnd2luZG93LmRpc3BhdGNoRXZlbnQoZXZlbnQpOyB9JztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFpc1NjcmlwdEVsZW1lbnRQcmVzZW50KSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2NyaXB0RWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHJlbW92ZUluaXRNb3VzZUNsaWNrRXZlbnRTY3JpcHRCbG9jayA9ICgpID0+IHtcclxuICAgICAgICBsZXQgc2NyaXB0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbml0X21vdXNlX2NsaWNrX2V2ZW50X3NjcmlwdF9ibG9jaycpO1xyXG4gICAgICAgIGlmIChodG1sVXRpbGl0aWVzLmdldFVzZXJEZXZpY2UoKS5icm93c2VyICE9PSAnSUUnKSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoc2NyaXB0RWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHNldFBhc3RlRW5hYmxlZEFjdGlvbiA9IChpc1Bhc3RlRW5hYmxlZDogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgIE1lc3NhZ2VIZWxwZXIuX2lzUGFzdGVFbmFibGVkID0gaXNQYXN0ZUVuYWJsZWQ7XHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgdXBkYXRlIHRoZSBJRnJhbWUgY29udGVudCB3aXRoIG1lc3NhZ2UgZGV0YWlsc1xyXG4gICAgICogQHBhcmFtIG9cclxuICAgICAqIEBwYXJhbSBlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgYWRkSUZyYW1lRm9yTWVzc2FnZURldGFpbHMobzogYW55LCBlOiBhbnkpIHtcclxuICAgICAgICBsZXQgdGltZW91dDogbnVtYmVyID0gMDtcclxuICAgICAgICAvLyBhZGQgc2NyaXB0IHRvIGluaXQgbW91c2UgY2xpY2sgZXZlbnQgaW4gcGFyZW50IHdpbmRvdyBmb3IgYW55ICdjbGljaycgaW4gY3VycmVudCB3aW5kb3dcclxuICAgICAgICBsZXQgc2NyaXB0QmxvY2sgPSAnd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXFwnY2xpY2tcXCcsIGZ1bmN0aW9uKCkgeyBwYXJlbnQuaW5pdE1vdXNlQ2xpY2tFdmVudCgpOyB9KTsnO1xyXG5cclxuICAgICAgICBsZXQgaGVhZFRhZ0NvbnRlbnQgPSAnPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPiBwLGJvZHl7bWFyZ2luOjA7cGFkZGluZzowO308L3N0eWxlPic7XHJcblxyXG4gICAgICAgIGlmIChodG1sVXRpbGl0aWVzLmlzSVBhZERldmljZSAmJiBodG1sVXRpbGl0aWVzLmdldFVzZXJEZXZpY2UoKS5icm93c2VyID09PSAnU2FmYXJpJykge1xyXG4gICAgICAgICAgICAvL2luY2x1ZGUgc2NyaXB0IHRvIGJsb2NrIGRvdWJsZSB0YXAgYW5kIHBpbmNoIHpvb20gaW4gaVBhZCBzYWZhcmlcclxuICAgICAgICAgICAgc2NyaXB0QmxvY2sgKz1cclxuICAgICAgICAgICAgICAgICd3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcXCd0b3VjaGVuZFxcJywgYmxvY2tEb3VibGVUYXBab29tKTsnICtcclxuICAgICAgICAgICAgICAgICd3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcXCd0b3VjaHN0YXJ0XFwnLCBibG9ja1BpbmNoVG9ab29tKTsnICtcclxuICAgICAgICAgICAgICAgIC8vYmxvY2sgZG91YmxlIHRhcCB6b29tXHJcbiAgICAgICAgICAgICAgICAnbGV0IGxhc3RUYXAgPSAwOycgK1xyXG4gICAgICAgICAgICAgICAgJ2Z1bmN0aW9uIGJsb2NrRG91YmxlVGFwWm9vbSAoIGUgKSB7JyArXHJcbiAgICAgICAgICAgICAgICAnbGV0IGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7JyArXHJcbiAgICAgICAgICAgICAgICAnbGV0IHRhcExlbmd0aCA9IGN1cnJlbnRUaW1lIC0gbGFzdFRhcDsnICtcclxuICAgICAgICAgICAgICAgICdpZiAodGFwTGVuZ3RoIDwgNTAwICYmIHRhcExlbmd0aCA+IDApIHsnICtcclxuICAgICAgICAgICAgICAgICdlLnByZXZlbnREZWZhdWx0KCk7fScgK1xyXG4gICAgICAgICAgICAgICAgJ2xhc3RUYXAgPSBjdXJyZW50VGltZTsnICtcclxuICAgICAgICAgICAgICAgIC8vaW5pdCBtb3VzZSBjbGljayBldmVudFxyXG4gICAgICAgICAgICAgICAgJ3BhcmVudC5pbml0TW91c2VDbGlja0V2ZW50KCk7IH0nICtcclxuICAgICAgICAgICAgICAgIC8vYmxvY2sgcGluY2ggem9vbVxyXG4gICAgICAgICAgICAgICAgJ2Z1bmN0aW9uIGJsb2NrUGluY2hUb1pvb20gKCBlICkgeycgK1xyXG4gICAgICAgICAgICAgICAgJ2lmIChlLnRvdWNoZXMubGVuZ3RoID4gMSkgeycgK1xyXG4gICAgICAgICAgICAgICAgJ2UucHJldmVudERlZmF1bHQoKTt9JyArXHJcbiAgICAgICAgICAgICAgICAnfSc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy9pbmNsdXNlIHNjcmlwdCB0byBpbml0IG1vdXNlIGNsaWNrIGV2ZW50IGluIHBhcmVudCB3aW5kb3cgZm9yIGFueSAndG91Y2gnIGluIGN1cnJlbnQgd2luZG93XHJcbiAgICAgICAgICAgIHNjcmlwdEJsb2NrICs9XHJcbiAgICAgICAgICAgICAgICAnd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXFwndG91Y2hlbmRcXCcsIGZ1bmN0aW9uKCkgeyBwYXJlbnQuaW5pdE1vdXNlQ2xpY2tFdmVudCgpOyB9KTsnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGNvbnRlbnQ6IHN0cmluZyA9IGUuZ2V0Q29udGVudCgpLnRyaW0oKSArXHJcbiAgICAgICAgICAgICc8c2NyaXB0PicgKyBzY3JpcHRCbG9jayArICc8L3NjcmlwdCA+JztcclxuICAgICAgICAvLyBwdXQgYSB0aW1lb3V0IG9mIDAsIG90aGVyd2lzZSBtZXNzYWdlIGRldGFpbHMgYXJlIG5vdCByZW5kZXJpbmcgb24gZmlyc3QgbWVzc2FnZSBpdGVtIGNsaWNrXHJcbiAgICAgICAgaWYgKCFodG1sVXRpbGl0aWVzLmlzVGFibGV0T3JNb2JpbGVEZXZpY2UgJiYgaHRtbFV0aWxpdGllcy5nZXRVc2VyRGV2aWNlKCkuYnJvd3NlciA9PT0gJ0ZpcmVmb3gnKSB7XHJcbiAgICAgICAgICAgIHRpbWVvdXQgPSA1MDtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICQoJyNtc2ctaWZyYW1lX2lmcicpLmNvbnRlbnRzKCkuZmluZCgnaGVhZCcpLmh0bWwoaGVhZFRhZ0NvbnRlbnQpO1xyXG4gICAgICAgICAgICAkKCcjbXNnLWlmcmFtZV9pZnInKS5jb250ZW50cygpLmZpbmQoJ2JvZHknKS5odG1sKGNvbnRlbnQpO1xyXG4gICAgICAgIH0sIHRpbWVvdXQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWV0aG9kIHdoaWNoIGdldHMgdGhlIHNlbGVjdGVkIFFJRydzIG5hbWUgYmFzZWQgb24gdGhlIEF3YXJkaW5nIEJvZHkgc3BlY2lmaWMgUUlHIE5hbWluZyBmb3JtYXRcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRDdXJyZW50UUlHTmFtZSA9ICgpID0+IHtcclxuICAgICAgICAvLyBDYWxsaW5nIHRoZSBoZWxwZXIgbWV0aG9kIHRvIGZvcm1hdCB0aGUgUUlHIE5hbWVcclxuICAgICAgICBpZiAocWlnU3RvcmUuaW5zdGFuY2Uuc2VsZWN0ZWRRSUdGb3JNYXJrZXJPcGVyYXRpb24gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBsZXQgc2VsZWN0ZWRRaWcgPSBxaWdTdG9yZS5pbnN0YW5jZS5zZWxlY3RlZFFJR0Zvck1hcmtlck9wZXJhdGlvbjtcclxuICAgICAgICAgICAgcmV0dXJuIHN0cmluZ0Zvcm1hdEhlbHBlci5mb3JtYXRBd2FyZGluZ0JvZHlRSUcoXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFFpZy5tYXJrU2NoZW1lR3JvdXBOYW1lLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRRaWcuYXNzZXNzbWVudENvZGUsXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFFpZy5zZXNzaW9uTmFtZSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkUWlnLmNvbXBvbmVudElkLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRRaWcucXVlc3Rpb25QYXBlck5hbWUsXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFFpZy5hc3Nlc3NtZW50TmFtZSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkUWlnLmNvbXBvbmVudE5hbWUsXHJcbiAgICAgICAgICAgICAgICBzdHJpbmdGb3JtYXRIZWxwZXIuZ2V0T3ZlcnZpZXdRSUdOYW1lRm9ybWF0KCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiBhIFFJRyBpcyBub3Qgc2VsZWN0ZWQsIHJldHVybiB0aGUgZGVmYXVsdCB0ZXh0IHRvIGJlIHNob3duIG9uIHRoZSBkcm9wIGRvd25cclxuICAgICAgICByZXR1cm4gbG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dCgnbWVzc2FnaW5nLmNvbXBvc2UtbWVzc2FnZS5wbGVhc2Utc2VsZWN0LXFpZy1wbGFjZWhvbGRlcicpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSBib29sZWFuIGluZGljYXRpbmcgd2hldGhlciB0aGUgbWVzc2FnZSBwYW5lbCBpcyBlZGl0ZWQuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgaXNNZXNzYWdlUGFuZWxFZGl0ZWQobWVzc2FnZVR5cGU6IGVudW1zLk1lc3NhZ2VUeXBlLCBtZXNzYWdlVG9GaWVsZFZhbHVlczogQXJyYXk8c3RyaW5nPixcclxuICAgICAgICBtZXNzYWdlVG9GaWVsZElkczogQXJyYXk8bnVtYmVyPikge1xyXG4gICAgICAgIGlmIChtZXNzYWdlc3RvcmUuaW5zdGFuY2UuaXNNZXNzYWdlUGFuZWxBY3RpdmUpIHtcclxuICAgICAgICAgICAgbGV0IGN1cnJlbnRBY3RpdmVFZGl0b3JJZCA9IHRpbnltY2UuYWN0aXZlRWRpdG9yLmlkO1xyXG4gICAgICAgICAgICBsZXQgYWN0aXZlRWRpdG9yID0gdGlueW1jZS5nZXQoTWVzc2FnZUhlbHBlci5tZXNzYWdlRWRpdG9ySWQpO1xyXG4gICAgICAgICAgICBpZiAobWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLkluYm94Q29tcG9zZSB8fCBtZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hGb3J3YXJkIHx8XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hSZXBseSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE1lc3NhZ2VIZWxwZXIubWVzc2FnZVN1YmplY3QgJiYgTWVzc2FnZUhlbHBlci5tZXNzYWdlU3ViamVjdC50cmltKCkubGVuZ3RoID4gMCB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUVkaXRvci5nZXRDb250ZW50KHsgZm9ybWF0OiAndGV4dCcgfSkudHJpbSgpLmxlbmd0aCA+IDAgfHxcclxuICAgICAgICAgICAgICAgICAgICAoKG1lc3NhZ2VUb0ZpZWxkVmFsdWVzICYmIG1lc3NhZ2VUb0ZpZWxkVmFsdWVzLmxlbmd0aCA+IDApICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChtZXNzYWdlVG9GaWVsZElkcyAmJiBtZXNzYWdlVG9GaWVsZElkcy5sZW5ndGggPiAwKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLlJlc3BvbnNlQ29tcG9zZVxyXG4gICAgICAgICAgICAgICAgfHwgbWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLldvcmtsaXN0Q29tcG9zZSB8fCBtZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuUmVzcG9uc2VSZXBseVxyXG4gICAgICAgICAgICAgICAgfHwgbWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLlJlc3BvbnNlRm9yd2FyZCB8fCBtZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuVGVhbUNvbXBvc2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNZXNzYWdlSGVscGVyLm1lc3NhZ2VTdWJqZWN0ICYmIE1lc3NhZ2VIZWxwZXIubWVzc2FnZVN1YmplY3QudHJpbSgpLmxlbmd0aCA+IDAgfHxcclxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVFZGl0b3IuZ2V0Q29udGVudCh7IGZvcm1hdDogJ3RleHQnIH0pLnRyaW0oKS5sZW5ndGggPiAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGFuZGxlcyBjaGFuZ2VzIGluIHRoZSBtZXNzYWdlIHBhbmVsIHN1YmplY3Qgc2VjdGlvbi5cclxuICAgICAqIEBwYXJhbSBlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgaGFuZGxlU3ViamVjdENoYW5nZSA9IChzdWJqZWN0OiBzdHJpbmcpID0+IHtcclxuICAgICAgICBNZXNzYWdlSGVscGVyLm1lc3NhZ2VTdWJqZWN0ID0gc3ViamVjdDtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCByZXZhbXBzIHRoZSBtYXJraW5nIG1vZGUgbmFtaW5nIGZvciBkaXNwbGF5IGluIG1lc3NhZ2VcclxuICAgICAqIEBwYXJhbSBtYXJraW5nTW9kZVxyXG4gICAgICogQHBhcmFtIGlzRWxlY3Ryb25pY1N0YW5kYXJkaXNhdGlvblRlYW1NZW1iZXJcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRNYXJraW5nTW9kZVRleHQobWFya2luZ01vZGU6IG51bWJlciwgaXNFbGVjdHJvbmljU3RhbmRhcmRpc2F0aW9uVGVhbU1lbWJlcjogbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKG1hcmtpbmdNb2RlID09PSBlbnVtcy5NYXJraW5nTW9kZS5FU19UZWFtQXBwcm92YWwpIHtcclxuICAgICAgICAgICAgaWYgKGlzRWxlY3Ryb25pY1N0YW5kYXJkaXNhdGlvblRlYW1NZW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoKGxvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHRcclxuICAgICAgICAgICAgICAgICAgICAoJ21hcmtpbmcud29ya2xpc3QucmVzcG9uc2UtZGF0YS5zdG0tc3RhbmRhcmRpc2F0aW9uLXJlc3BvbnNlLXRpdGxlJykpICsgJyAnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoKGxvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHRcclxuICAgICAgICAgICAgICAgICAgICAoJ21hcmtpbmcud29ya2xpc3QucmVzcG9uc2UtZGF0YS5zZWNvbmQtc3RhbmRhcmRpc2F0aW9uLXJlc3BvbnNlLXRpdGxlJykpICsgJyAnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAobWFya2luZ01vZGUgPT09IGVudW1zLk1hcmtpbmdNb2RlLlByYWN0aWNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoKGxvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21hcmtpbmcud29ya2xpc3QucmVzcG9uc2UtZGF0YS5wcmFjdGljZS1yZXNwb25zZS10aXRsZScpKSArICcgJyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChtYXJraW5nTW9kZSA9PT0gZW51bXMuTWFya2luZ01vZGUuQXBwcm92YWwpIHtcclxuICAgICAgICAgICAgcmV0dXJuICgobG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dCgnbWFya2luZy53b3JrbGlzdC5yZXNwb25zZS1kYXRhLnN0YW5kYXJkaXNhdGlvbi1yZXNwb25zZS10aXRsZScpKSArICcgJyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChtYXJraW5nTW9kZSA9PT0gZW51bXMuTWFya2luZ01vZGUuRVNfVGVhbUFwcHJvdmFsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoKGxvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHRcclxuICAgICAgICAgICAgICAgICgnbWFya2luZy53b3JrbGlzdC5yZXNwb25zZS1kYXRhLnNlY29uZC1zdGFuZGFyZGlzYXRpb24tcmVzcG9uc2UtdGl0bGUnKSkgKyAnICcpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCA9IE1lc3NhZ2VIZWxwZXI7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vfi9zb3VyY2UtbWFwLWxvYWRlciEuL3NyYy9jb21wb25lbnRzL3V0aWxpdHkvbWVzc2FnZS9tZXNzYWdlaGVscGVyLnRzIl0sIm1hcHBpbmdzIjoiO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFNQTtBQUFBO0FBd2hCQTtBQWhoQkE7OztBQUdBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7Ozs7QUFJQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFFQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTs7OztBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFLQTtBQUhBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFBQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBMkVBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF1QkE7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQXJoQkE7QUFFQTtBQTRVQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQXFEQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQXlCQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUEyQkE7QUFBQTtBQUVBOztBIiwic291cmNlUm9vdCI6IiJ9");

/***/ }),

/***/ 290:
/* no static exports found */
/* all exports used */
/*!**************************************************!*\
  !*** ./src/components/utility/genericbutton.tsx ***!
  \**************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n/*\r\n  React component for Generic button.\r\n*/\r\n/* tslint:disable:no-unused-variable */\r\nvar React = __webpack_require__(/*! react */ 0);\r\n/* tslint:disable:no-unused-variable */\r\nvar pureRenderComponent = __webpack_require__(/*! ../base/purerendercomponent */ 227);\r\nvar applicationStore = __webpack_require__(/*! ../../stores/applicationoffline/applicationstore */ 247);\r\n/**\r\n * React component class for Generic button implementation.\r\n */\r\nvar GenericButton = /** @class */ (function (_super) {\r\n    __extends(GenericButton, _super);\r\n    /**\r\n     * constructor\r\n     * @param props\r\n     * @param state\r\n     */\r\n    function GenericButton(props, state) {\r\n        var _this = _super.call(this, props, state) || this;\r\n        _this.onClick = _this.onClick.bind(_this);\r\n        _this.onDoubleClick = _this.onDoubleClick.bind(_this);\r\n        _this.onMouseEnter = _this.onMouseEnter.bind(_this);\r\n        _this.onMouseLeave = _this.onMouseLeave.bind(_this);\r\n        _this.onMouseOver = _this.onMouseOver.bind(_this);\r\n        return _this;\r\n    }\r\n    /**\r\n     * Render method\r\n     */\r\n    GenericButton.prototype.render = function () {\r\n        var buttonElement;\r\n        buttonElement = (React.createElement(\"button\", { id: this.props.id, title: this.props.title, className: this.props.className, onClick: this.onClick, disabled: this.props.disabled, onDoubleClick: this.onDoubleClick, onMouseEnter: this.onMouseEnter, onMouseLeave: this.onMouseLeave, onMouseOver: this.onMouseOver },\r\n            this.props.content,\r\n            this.props.childrens != null ? this.props.childrens : null));\r\n        return buttonElement;\r\n    };\r\n    /**\r\n     * Component did mount\r\n     */\r\n    GenericButton.prototype.componentDidMount = function () {\r\n        applicationStore.instance.setMaxListeners(0);\r\n    };\r\n    /**\r\n     * Handles the single click event.\r\n     * @param evnt\r\n     */\r\n    GenericButton.prototype.onClick = function (evnt) {\r\n        if (this.props.onClick != null) {\r\n            this.props.onClick(evnt);\r\n        }\r\n    };\r\n    /**\r\n     * Handles the double click event.\r\n     * @param evnt\r\n     */\r\n    GenericButton.prototype.onDoubleClick = function (evnt) {\r\n        if (this.props.onDoubleClick != null) {\r\n            this.props.onDoubleClick();\r\n        }\r\n    };\r\n    /**\r\n     * Handles the mouse enter event.\r\n     * @param evnt\r\n     */\r\n    GenericButton.prototype.onMouseEnter = function (evnt) {\r\n        if (this.props.onMouseEnter != null) {\r\n            this.props.onMouseEnter();\r\n        }\r\n    };\r\n    /**\r\n     * Handles the mouse leave event.\r\n     * @param evnt\r\n     */\r\n    GenericButton.prototype.onMouseLeave = function (evnt) {\r\n        if (this.props.onMouseLeave != null) {\r\n            this.props.onMouseLeave();\r\n        }\r\n    };\r\n    /**\r\n     * Handles the mouse over event.\r\n     * @param evnt\r\n     */\r\n    GenericButton.prototype.onMouseOver = function (evnt) {\r\n        if (this.props.onMouseOver != null) {\r\n            this.props.onMouseOver();\r\n        }\r\n    };\r\n    return GenericButton;\r\n}(pureRenderComponent));\r\nmodule.exports = GenericButton;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjkwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS9nZW5lcmljYnV0dG9uLnRzeD9kNzJhIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAgUmVhY3QgY29tcG9uZW50IGZvciBHZW5lcmljIGJ1dHRvbi5cclxuKi9cclxuLyogdHNsaW50OmRpc2FibGU6bm8tdW51c2VkLXZhcmlhYmxlICovXHJcbmltcG9ydCBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XHJcbi8qIHRzbGludDpkaXNhYmxlOm5vLXVudXNlZC12YXJpYWJsZSAqL1xyXG5pbXBvcnQgcHVyZVJlbmRlckNvbXBvbmVudCA9IHJlcXVpcmUoJy4uL2Jhc2UvcHVyZXJlbmRlcmNvbXBvbmVudCcpO1xyXG5pbXBvcnQgYXBwbGljYXRpb25TdG9yZSA9IHJlcXVpcmUoJy4uLy4uL3N0b3Jlcy9hcHBsaWNhdGlvbm9mZmxpbmUvYXBwbGljYXRpb25zdG9yZScpO1xyXG5pbXBvcnQgZW51bXMgPSByZXF1aXJlKCcuL2VudW1zJyk7XHJcbmltcG9ydCBsb2NhbGVTdG9yZSA9IHJlcXVpcmUoJy4uLy4uL3N0b3Jlcy9sb2NhbGUvbG9jYWxlc3RvcmUnKTtcclxuXHJcbmludGVyZmFjZSBQcm9wcyBleHRlbmRzIExvY2FsZVNlbGVjdGlvbkJhc2UsIFByb3BzQmFzZSB7XHJcbiAgICB0aXRsZT86IHN0cmluZztcclxuICAgIGNvbnRlbnQ/OiBzdHJpbmc7XHJcbiAgICBjbGFzc05hbWU/OiBzdHJpbmc7XHJcbiAgICB0YWJJbmRleD86IG51bWJlcjtcclxuICAgIGRpc2FibGVkPzogYm9vbGVhbjtcclxuICAgIGNoaWxkcmVucz86IEFycmF5PEpTWC5FbGVtZW50PjtcclxuICAgIG9uQ2xpY2s/OiBGdW5jdGlvbjtcclxuICAgIG9uRG91YmxlQ2xpY2s/OiBGdW5jdGlvbjtcclxuICAgIG9uTW91c2VFbnRlcj86IEZ1bmN0aW9uO1xyXG4gICAgb25Nb3VzZUxlYXZlPzogRnVuY3Rpb247XHJcbiAgICBvbk1vdXNlT3Zlcj86IEZ1bmN0aW9uO1xyXG4gICAgYnV0dG9uVHlwZT86IGVudW1zLkJ1dHRvblR5cGU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZWFjdCBjb21wb25lbnQgY2xhc3MgZm9yIEdlbmVyaWMgYnV0dG9uIGltcGxlbWVudGF0aW9uLlxyXG4gKi9cclxuY2xhc3MgR2VuZXJpY0J1dHRvbiBleHRlbmRzIHB1cmVSZW5kZXJDb21wb25lbnQ8UHJvcHMsIGFueT4ge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogY29uc3RydWN0b3JcclxuICAgICAqIEBwYXJhbSBwcm9wc1xyXG4gICAgICogQHBhcmFtIHN0YXRlXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcywgc3RhdGU6IGFueSkge1xyXG4gICAgICAgIHN1cGVyKHByb3BzLCBzdGF0ZSk7XHJcbiAgICAgICAgdGhpcy5vbkNsaWNrID0gdGhpcy5vbkNsaWNrLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5vbkRvdWJsZUNsaWNrID0gdGhpcy5vbkRvdWJsZUNsaWNrLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5vbk1vdXNlRW50ZXIgPSB0aGlzLm9uTW91c2VFbnRlci5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMub25Nb3VzZUxlYXZlID0gdGhpcy5vbk1vdXNlTGVhdmUuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLm9uTW91c2VPdmVyID0gdGhpcy5vbk1vdXNlT3Zlci5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVuZGVyIG1ldGhvZFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcmVuZGVyKCkge1xyXG4gICAgICAgIGxldCBidXR0b25FbGVtZW50OiBKU1guRWxlbWVudDtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbkVsZW1lbnQgPSAoPGJ1dHRvbiBpZD17dGhpcy5wcm9wcy5pZH1cclxuICAgICAgICAgICAgICAgICAgICB0aXRsZT17dGhpcy5wcm9wcy50aXRsZX1cclxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e3RoaXMucHJvcHMuY2xhc3NOYW1lfVxyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25DbGlja31cclxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5wcm9wcy5kaXNhYmxlZH1cclxuICAgICAgICAgICAgICAgICAgICBvbkRvdWJsZUNsaWNrPXt0aGlzLm9uRG91YmxlQ2xpY2t9XHJcbiAgICAgICAgICAgICAgICAgICAgb25Nb3VzZUVudGVyPXt0aGlzLm9uTW91c2VFbnRlcn1cclxuICAgICAgICAgICAgICAgICAgICBvbk1vdXNlTGVhdmU9e3RoaXMub25Nb3VzZUxlYXZlfVxyXG4gICAgICAgICAgICAgICAgICAgIG9uTW91c2VPdmVyPXt0aGlzLm9uTW91c2VPdmVyfT5cclxuICAgICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5jb250ZW50fVxyXG4gICAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLmNoaWxkcmVucyAhPSBudWxsID8gdGhpcy5wcm9wcy5jaGlsZHJlbnMgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgPC9idXR0b24+KTtcclxuICAgICAgICByZXR1cm4gYnV0dG9uRWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbXBvbmVudCBkaWQgbW91bnRcclxuICAgICAqL1xyXG4gICAgcHVibGljIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgICAgIGFwcGxpY2F0aW9uU3RvcmUuaW5zdGFuY2Uuc2V0TWF4TGlzdGVuZXJzKDApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGFuZGxlcyB0aGUgc2luZ2xlIGNsaWNrIGV2ZW50LlxyXG4gICAgICogQHBhcmFtIGV2bnRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBvbkNsaWNrKGV2bnQ6IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3BzLm9uQ2xpY2sgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uQ2xpY2soZXZudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGFuZGxlcyB0aGUgZG91YmxlIGNsaWNrIGV2ZW50LlxyXG4gICAgICogQHBhcmFtIGV2bnRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBvbkRvdWJsZUNsaWNrKGV2bnQ6IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3BzLm9uRG91YmxlQ2xpY2sgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uRG91YmxlQ2xpY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBIYW5kbGVzIHRoZSBtb3VzZSBlbnRlciBldmVudC5cclxuICAgICAqIEBwYXJhbSBldm50XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgb25Nb3VzZUVudGVyKGV2bnQ6IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3BzLm9uTW91c2VFbnRlciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJvcHMub25Nb3VzZUVudGVyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGFuZGxlcyB0aGUgbW91c2UgbGVhdmUgZXZlbnQuXHJcbiAgICAgKiBAcGFyYW0gZXZudFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uTW91c2VMZWF2ZShldm50OiBhbnkpIHtcclxuICAgICAgICBpZiAodGhpcy5wcm9wcy5vbk1vdXNlTGVhdmUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uTW91c2VMZWF2ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhhbmRsZXMgdGhlIG1vdXNlIG92ZXIgZXZlbnQuXHJcbiAgICAgKiBAcGFyYW0gZXZudFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uTW91c2VPdmVyKGV2bnQ6IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3BzLm9uTW91c2VPdmVyICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5vbk1vdXNlT3ZlcigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0ID0gR2VuZXJpY0J1dHRvbjtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9+L3NvdXJjZS1tYXAtbG9hZGVyIS4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS9nZW5lcmljYnV0dG9uLnRzeCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFtQkE7O0FBRUE7QUFDQTtBQUFBO0FBRUE7Ozs7QUFJQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ }),

/***/ 325:
/* no static exports found */
/* all exports used */
/*!**********************************************************!*\
  !*** ./src/components/utility/messageeditorconstants.ts ***!
  \**********************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar MessageEditorConstants;\r\n(function (MessageEditorConstants) {\r\n    MessageEditorConstants.TINYMCE_THEME = 'advanced';\r\n    MessageEditorConstants.TINYMCE_PLUGINS = 'link textcolor advlist';\r\n    MessageEditorConstants.TINYMCE_TOOLBAR = 'bold italic underline | fontselect fontsizeselect | alignleft aligncenter alignright | bullist numlist | link';\r\n    MessageEditorConstants.TINYMCE_FONTSIZES = '8px 10px 12px 14px 18px 24px 36px';\r\n    MessageEditorConstants.TINYMCE_FONTS = 'Andale Mono=andale mono,times;'\r\n        + 'Arial=arial,helvetica,sans-serif;'\r\n        + 'Arial Black=arial black,avant garde;'\r\n        + 'Book Antiqua=book antiqua,palatino;'\r\n        + 'Comic Sans MS=comic sans ms,sans-serif;'\r\n        + 'Courier New=courier new,courier;'\r\n        + 'Georgia=georgia,palatino;'\r\n        + 'Helvetica=helvetica;'\r\n        + 'Impact=impact,chicago;'\r\n        + 'Tahoma=tahoma,arial,helvetica,sans-serif;'\r\n        + 'Terminal=terminal,monaco;'\r\n        + 'Times New Roman=times new roman,times;'\r\n        + 'Trebuchet MS=trebuchet ms,geneva;'\r\n        + 'Verdana=verdana,geneva;';\r\n    MessageEditorConstants.TINYMCE_TEXTCOLOR_PALETTE = [\r\n        '000000', '',\r\n        '993300', '',\r\n        '333300', '',\r\n        '003300', '',\r\n        '003366', '',\r\n        '000080', '',\r\n        '333399', '',\r\n        '333333', '',\r\n        '800000', '',\r\n        '808000', '',\r\n        '008000', '',\r\n        '008080', '',\r\n        '0000FF', '',\r\n        '666699', '',\r\n        '808080', '',\r\n        'FF0000', '',\r\n        '99CC00', '',\r\n        '339966', '',\r\n        '33CCCC', '',\r\n        '3366FF', '',\r\n        '800080', '',\r\n        '999999', '',\r\n        'FF00FF', '',\r\n        '00FF00', '',\r\n        '00FFFF', '',\r\n        '00CCFF', '',\r\n        '993366', '',\r\n        'FFFFFF', '',\r\n        '99CCFF', '',\r\n    ];\r\n    MessageEditorConstants.TINYMCE_FONTNAME_CMD = 'FontName';\r\n    MessageEditorConstants.TINYMCE_FONTSIZE_CMD = 'FontSize';\r\n    MessageEditorConstants.TINYMCE_DEFAULT_FONT = 'arial,helvetica,sans-serif';\r\n    MessageEditorConstants.TINYMCE_DEFAULT_FONTSIZE = '12px';\r\n})(MessageEditorConstants || (MessageEditorConstants = {}));\r\nmodule.exports = MessageEditorConstants;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzI1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS9tZXNzYWdlZWRpdG9yY29uc3RhbnRzLnRzP2NkZmYiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlIE1lc3NhZ2VFZGl0b3JDb25zdGFudHMge1xyXG4gICAgZXhwb3J0IGNvbnN0IFRJTllNQ0VfVEhFTUUgPSAnYWR2YW5jZWQnO1xyXG4gICAgZXhwb3J0IGNvbnN0IFRJTllNQ0VfUExVR0lOUyA9ICdsaW5rIHRleHRjb2xvciBhZHZsaXN0JztcclxuICAgIGV4cG9ydCBjb25zdCBUSU5ZTUNFX1RPT0xCQVIgPVxyXG4gICAgICAgICdib2xkIGl0YWxpYyB1bmRlcmxpbmUgfCBmb250c2VsZWN0IGZvbnRzaXplc2VsZWN0IHwgYWxpZ25sZWZ0IGFsaWduY2VudGVyIGFsaWducmlnaHQgfCBidWxsaXN0IG51bWxpc3QgfCBsaW5rJztcclxuICAgIGV4cG9ydCBjb25zdCBUSU5ZTUNFX0ZPTlRTSVpFUyA9ICc4cHggMTBweCAxMnB4IDE0cHggMThweCAyNHB4IDM2cHgnO1xyXG4gICAgZXhwb3J0IGNvbnN0IFRJTllNQ0VfRk9OVFMgPSAnQW5kYWxlIE1vbm89YW5kYWxlIG1vbm8sdGltZXM7J1xyXG4gICAgICAgICsgJ0FyaWFsPWFyaWFsLGhlbHZldGljYSxzYW5zLXNlcmlmOydcclxuICAgICAgICArICdBcmlhbCBCbGFjaz1hcmlhbCBibGFjayxhdmFudCBnYXJkZTsnXHJcbiAgICAgICAgKyAnQm9vayBBbnRpcXVhPWJvb2sgYW50aXF1YSxwYWxhdGlubzsnXHJcbiAgICAgICAgKyAnQ29taWMgU2FucyBNUz1jb21pYyBzYW5zIG1zLHNhbnMtc2VyaWY7J1xyXG4gICAgICAgICsgJ0NvdXJpZXIgTmV3PWNvdXJpZXIgbmV3LGNvdXJpZXI7J1xyXG4gICAgICAgICsgJ0dlb3JnaWE9Z2VvcmdpYSxwYWxhdGlubzsnXHJcbiAgICAgICAgKyAnSGVsdmV0aWNhPWhlbHZldGljYTsnXHJcbiAgICAgICAgKyAnSW1wYWN0PWltcGFjdCxjaGljYWdvOydcclxuICAgICAgICArICdUYWhvbWE9dGFob21hLGFyaWFsLGhlbHZldGljYSxzYW5zLXNlcmlmOydcclxuICAgICAgICArICdUZXJtaW5hbD10ZXJtaW5hbCxtb25hY287J1xyXG4gICAgICAgICsgJ1RpbWVzIE5ldyBSb21hbj10aW1lcyBuZXcgcm9tYW4sdGltZXM7J1xyXG4gICAgICAgICsgJ1RyZWJ1Y2hldCBNUz10cmVidWNoZXQgbXMsZ2VuZXZhOydcclxuICAgICAgICArICdWZXJkYW5hPXZlcmRhbmEsZ2VuZXZhOyc7XHJcbiAgICBleHBvcnQgY29uc3QgVElOWU1DRV9URVhUQ09MT1JfUEFMRVRURSA9IFtcclxuICAgICAgICAnMDAwMDAwJywgJycsXHJcbiAgICAgICAgJzk5MzMwMCcsICcnLFxyXG4gICAgICAgICczMzMzMDAnLCAnJyxcclxuICAgICAgICAnMDAzMzAwJywgJycsXHJcbiAgICAgICAgJzAwMzM2NicsICcnLFxyXG4gICAgICAgICcwMDAwODAnLCAnJyxcclxuICAgICAgICAnMzMzMzk5JywgJycsXHJcbiAgICAgICAgJzMzMzMzMycsICcnLFxyXG4gICAgICAgICc4MDAwMDAnLCAnJyxcclxuICAgICAgICAnODA4MDAwJywgJycsXHJcbiAgICAgICAgJzAwODAwMCcsICcnLFxyXG4gICAgICAgICcwMDgwODAnLCAnJyxcclxuICAgICAgICAnMDAwMEZGJywgJycsXHJcbiAgICAgICAgJzY2NjY5OScsICcnLFxyXG4gICAgICAgICc4MDgwODAnLCAnJyxcclxuICAgICAgICAnRkYwMDAwJywgJycsXHJcbiAgICAgICAgJzk5Q0MwMCcsICcnLFxyXG4gICAgICAgICczMzk5NjYnLCAnJyxcclxuICAgICAgICAnMzNDQ0NDJywgJycsXHJcbiAgICAgICAgJzMzNjZGRicsICcnLFxyXG4gICAgICAgICc4MDAwODAnLCAnJyxcclxuICAgICAgICAnOTk5OTk5JywgJycsXHJcbiAgICAgICAgJ0ZGMDBGRicsICcnLFxyXG4gICAgICAgICcwMEZGMDAnLCAnJyxcclxuICAgICAgICAnMDBGRkZGJywgJycsXHJcbiAgICAgICAgJzAwQ0NGRicsICcnLFxyXG4gICAgICAgICc5OTMzNjYnLCAnJyxcclxuICAgICAgICAnRkZGRkZGJywgJycsXHJcbiAgICAgICAgJzk5Q0NGRicsICcnLFxyXG4gICAgXTtcclxuICAgIGV4cG9ydCBjb25zdCBUSU5ZTUNFX0ZPTlROQU1FX0NNRCA9ICdGb250TmFtZSc7XHJcbiAgICBleHBvcnQgY29uc3QgVElOWU1DRV9GT05UU0laRV9DTUQgPSAnRm9udFNpemUnO1xyXG4gICAgZXhwb3J0IGNvbnN0IFRJTllNQ0VfREVGQVVMVF9GT05UID0gJ2FyaWFsLGhlbHZldGljYSxzYW5zLXNlcmlmJztcclxuICAgIGV4cG9ydCBjb25zdCBUSU5ZTUNFX0RFRkFVTFRfRk9OVFNJWkUgPSAnMTJweCc7XHJcbn1cclxuZXhwb3J0ID0gTWVzc2FnZUVkaXRvckNvbnN0YW50cztcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9+L3NvdXJjZS1tYXAtbG9hZGVyIS4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS9tZXNzYWdlZWRpdG9yY29uc3RhbnRzLnRzIl0sIm1hcHBpbmdzIjoiO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),

/***/ 457:
/* no static exports found */
/* all exports used */
/*!*************************************************!*\
  !*** ./src/components/message/messagepopup.tsx ***!
  \*************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar React = __webpack_require__(/*! react */ 0);\r\nvar MessagePriorityDropDown = __webpack_require__(/*! ./messageprioritydropdown */ 464);\r\nvar localeStore = __webpack_require__(/*! ../../stores/locale/localestore */ 226);\r\nvar GenericButton = __webpack_require__(/*! ../utility/genericbutton */ 290);\r\nvar messageStore = __webpack_require__(/*! ../../stores/message/messagestore */ 240);\r\nvar enums = __webpack_require__(/*! ../utility/enums */ 225);\r\nvar MessageBase = __webpack_require__(/*! ./messagebase */ 462);\r\nvar MessageEditor = __webpack_require__(/*! ./messageeditor */ 463);\r\nvar Subject = __webpack_require__(/*! ./subject */ 466);\r\nvar classNames = __webpack_require__(/*! classnames */ 39);\r\nvar messagingActionCreator = __webpack_require__(/*! ../../actions/messaging/messagingactioncreator */ 268);\r\nvar popupHelper = __webpack_require__(/*! ../utility/popup/popuphelper */ 288);\r\nvar QigDropDown = __webpack_require__(/*! ../utility/dropdown */ 467);\r\nvar messageHelper = __webpack_require__(/*! ../utility/message/messagehelper */ 283);\r\nvar keyDownHelper = __webpack_require__(/*! ../../utility/generic/keydownhelper */ 258);\r\nvar htmlUtilities = __webpack_require__(/*! ../../utility/generic/htmlutilities */ 243);\r\nvar TeamListPopup = __webpack_require__(/*! ./teamlistpopup */ 478);\r\nvar configurablecharacteristicshelper = __webpack_require__(/*! ../../utility/configurablecharacteristic/configurablecharacteristicshelper */ 233);\r\nvar configurablecharacteristicsnames = __webpack_require__(/*! ../../utility/configurablecharacteristic/configurablecharacteristicsnames */ 234);\r\nvar teamManagementStore = __webpack_require__(/*! ../../stores/teammanagement/teammanagementstore */ 245);\r\nvar applicationStore = __webpack_require__(/*! ../../stores/applicationoffline/applicationstore */ 247);\r\nvar MessagePopup = /** @class */ (function (_super) {\r\n    __extends(MessagePopup, _super);\r\n    /**\r\n     * Constructor Messagepopup\r\n     * @param props\r\n     * @param state\r\n     */\r\n    function MessagePopup(props, state) {\r\n        var _this = _super.call(this, props, state) || this;\r\n        _this.isShowTeamListPopup = false;\r\n        _this._isEntireTeamSelected = false;\r\n        _this._mandatoryMessagesFromMarkingToolCC = false;\r\n        _this.doTriggerMessageOpenEvent = false;\r\n        /**\r\n         * This method will render QIG section for Compose, Reply and Forward message types\r\n         */\r\n        _this.renderQigSection = function () {\r\n            switch (_this.props.messageType) {\r\n                case enums.MessageType.InboxCompose:\r\n                    return (React.createElement(\"div\", { className: 'message-qig' },\r\n                        React.createElement(\"span\", { className: 'dim-text msg-qig-label', id: 'qig-dropdown-label' }, localeStore.instance.TranslateText('messaging.compose-message.question-group') + ':'),\r\n                        React.createElement(QigDropDown, { dropDownType: enums.DropDownType.QIG, id: 'select_qig', style: _this.state.qigDropDownStyle, className: 'dropdown-wrap message-qig-name', selectedItem: _this.selectedQig, isOpen: _this.clickedDropDown === enums.DropDownType.QIG ? _this.isQigDropDownOpen : undefined, items: _this.props.qigItemsList, onClick: _this.onQigDropDownClick, onSelect: _this.onQigItemSelected, title: localeStore.instance.TranslateText('messaging.compose-message.question-group-tooltip') })));\r\n                case enums.MessageType.InboxForward:\r\n                case enums.MessageType.InboxReply:\r\n                case enums.MessageType.WorklistCompose:\r\n                case enums.MessageType.TeamCompose:\r\n                    return (React.createElement(\"div\", { className: 'message-qig' },\r\n                        React.createElement(\"span\", { className: 'dim-text msg-qig-label', id: 'question-group-text' }, localeStore.instance.TranslateText('messaging.compose-message.question-group') + ':'),\r\n                        React.createElement(\"div\", { className: 'message-qig-name', id: 'selected-qig-name' }, _this.selectedQig)));\r\n            }\r\n        };\r\n        /**\r\n         * This method will return associtated response section for Forward and Reply message types\r\n         */\r\n        _this.renderAssociatedResponseSection = function () {\r\n            if ((_this.props.messageType === enums.MessageType.InboxForward || _this.props.messageType === enums.MessageType.InboxReply)\r\n                && (_this.props.responseId != null && _this.props.responseId !== '' && _this.props.responseId !== undefined)) {\r\n                return (React.createElement(\"div\", { className: 'clearfix padding-bottom-10' },\r\n                    React.createElement(\"div\", { className: 'comp-resp-id shift-left' },\r\n                        React.createElement(\"span\", { className: 'dim-text', id: 'associated-response-text' }, localeStore.instance.TranslateText('messaging.compose-message.associated-response') + ':'),\r\n                        React.createElement(\"div\", { className: 'message-resonse-id', id: 'associated-response-id' }, messageHelper.getMarkingModeText(_this.props.selectedMsgDetails.markingModeId, _this.props.selectedMsgDetails.isElectronicStandardisationTeamMember) + _this.props.responseId))));\r\n            }\r\n        };\r\n        /**\r\n         * This method will call on qig dropdown select\r\n         */\r\n        _this.onQigItemSelected = function (selectedItem) {\r\n            // resetting to standard message priority while qig selected\r\n            _this.priorityDropDownSelectedItem = enums.MessagePriority.Standard;\r\n            _this.props.onQigItemSelected(selectedItem);\r\n            var selectedQigItem = _this.props.qigItemsList.filter(function (x) { return x.id === selectedItem; });\r\n            var qigId = selectedItem;\r\n            var examinerRoleId = selectedQigItem[0].examinerRoleId;\r\n            var args = {\r\n                examinerRoleId: examinerRoleId,\r\n                qigId: qigId\r\n            };\r\n            messagingActionCreator.getTeamDetails(args);\r\n        };\r\n        /**\r\n         * On navigate away from inbox\r\n         */\r\n        _this.onNavigateAwayFromInbox = function (navigateTo) {\r\n            if ((navigateTo === enums.SaveAndNavigate.toReplyMessage || navigateTo === enums.SaveAndNavigate.toForwardMessage ||\r\n                navigateTo === enums.SaveAndNavigate.newMessageButtonClick)\r\n                && !messageHelper.isMessagePanelEdited(_this.props.messageType, _this.toFieldValues, _this.toFieldIds)) {\r\n                _this.props.onResetPopupCallback(navigateTo);\r\n            }\r\n            else {\r\n                _this.onNavigateAwayFromResponse(navigateTo);\r\n            }\r\n        };\r\n        /**\r\n         *  This will set the required variables\r\n         */\r\n        _this.onOpen = function (messageType) {\r\n            // if tinymce is not loaded we need to skip this method and retrigger this after editor is loaded\r\n            if (!_this.state.isTinyMCELoaded) {\r\n                _this.doTriggerMessageOpenEvent = true;\r\n                _this.msgType = messageType;\r\n                return;\r\n            }\r\n            // if message type is inbox compose or worklist compose then set the default content for setting default fonts\r\n            if (messageType === enums.MessageType.InboxCompose || messageType === enums.MessageType.WorklistCompose ||\r\n                messageType === enums.MessageType.TeamCompose) {\r\n                _this.messageBody = messageHelper.getMessageContent(messageType);\r\n                if (_this.isMessagePopupMinimized === true) {\r\n                    _this.onMaximizeMessagePanel();\r\n                }\r\n            }\r\n            // if message type is work list compose then set supervisior details in to address fields.\r\n            if (messageType === enums.MessageType.WorklistCompose || messageType === enums.MessageType.TeamCompose) {\r\n                _this._selectedTeamList = new Array();\r\n                _this.toFieldIds = new Array();\r\n                _this.toFieldValues = new Array();\r\n                _this.toFieldIds.push(_this.props.supervisorId);\r\n                _this.toFieldValues.push(_this.props.supervisorName);\r\n                _this._selectedTeamList.push(_this.props.supervisorName);\r\n            }\r\n            // Fix for defect 54276. Reply forward message details has to be set only once. \r\n            if (messageType === enums.MessageType.InboxReply || messageType === enums.MessageType.InboxForward) {\r\n                _this.setInboxForwardReplyMessageDetails();\r\n            }\r\n            // Fix for defect 54276. Reply forward message details has to be set only once. \r\n            if (messageType === enums.MessageType.InboxReply || messageType === enums.MessageType.InboxForward) {\r\n                _this.setInboxForwardReplyMessageDetails();\r\n            }\r\n            // Fix for defect 54276. Reply forward message details has to be set only once. \r\n            if (messageType === enums.MessageType.InboxReply || messageType === enums.MessageType.InboxForward) {\r\n                _this.setInboxForwardReplyMessageDetails();\r\n            }\r\n            _this.setState({ renderedOn: Date.now() });\r\n            // enable send button\r\n            _this.enableDisableSendButton();\r\n        };\r\n        /**\r\n         * Method fired to minimize the message panel.\r\n         */\r\n        _this.onMinimizeMessagePanel = function () {\r\n            // added as part of defect #29269\r\n            if (htmlUtilities.isIPadDevice) {\r\n                htmlUtilities.setFocusToElement('message-subject');\r\n                htmlUtilities.blurElement('message-subject');\r\n            }\r\n            _this.isMessagePopupMinimized = true;\r\n            _this.setState({ renderedOn: Date.now() });\r\n        };\r\n        /**\r\n         * Method fired to maximize the message panel.\r\n         */\r\n        _this.onMaximizeMessagePanel = function () {\r\n            _this.isMessagePopupMinimized = false;\r\n            _this.setState({ renderedOn: Date.now() });\r\n            // enable send button\r\n            _this.enableDisableSendButton();\r\n        };\r\n        /**\r\n         * Method fired to close the message panel.\r\n         */\r\n        _this.onMessagePanelClose = function () {\r\n            keyDownHelper.instance.Activate(enums.MarkEntryDeactivator.Messaging);\r\n            _this.isMessagePopupMinimized = false;\r\n            _this.messageSubject = '';\r\n            if (_this.selectedQigItemId && _this.selectedQigItemId !== 0) {\r\n                var selectedQigItem = _this.props.qigItemsList.filter(function (x) { return x.id === _this.selectedQigItemId; });\r\n                if (selectedQigItem && selectedQigItem.length > 0) {\r\n                    var qigId = _this.selectedQigItemId;\r\n                    var examinerRoleId = selectedQigItem[0].examinerRoleId;\r\n                    messagingActionCreator.clearTeamSelection(examinerRoleId);\r\n                }\r\n            }\r\n            _this._selectedTeamList = new Array();\r\n            _this._isEntireTeamSelected = false;\r\n            /**\r\n             * Defect 64542 fix: setting isShowTeamListPopup to false to prevent TeamList Popup from persisting\r\n             * when closing and opening a new message with only 1 QIG item\r\n             */\r\n            _this.isShowTeamListPopup = false;\r\n            _this.setState({ renderedOn: Date.now() });\r\n        };\r\n        /**\r\n         * This method is handling the letious popup events.\r\n         */\r\n        _this.onPopUpDisplayEvent = function (popUpType, popUpActionType) {\r\n            switch (popUpType) {\r\n                case enums.PopUpType.DiscardMessage:\r\n                case enums.PopUpType.DiscardMessageNavigateAway:\r\n                    switch (popUpActionType) {\r\n                        case enums.PopUpActionType.Yes:\r\n                            popupHelper.handlePopUpEvents(popUpType, popUpActionType, _this.onDiscardMessageConfirmed);\r\n                            break;\r\n                        case enums.PopUpActionType.No:\r\n                            popupHelper.handlePopUpEvents(popUpType, popUpActionType, _this.onDiscardMessageCancelled);\r\n                            break;\r\n                    }\r\n                    break;\r\n                case enums.PopUpType.DiscardOnNewMessageButtonClick:\r\n                    switch (popUpActionType) {\r\n                        case enums.PopUpActionType.Show:\r\n                            _this.isMessagePopupMinimized = false;\r\n                            _this.setState({ renderedOn: Date.now() });\r\n                            break;\r\n                        case enums.PopUpActionType.Yes:\r\n                            popupHelper.handlePopUpEvents(popUpType, popUpActionType, _this.onDiscardNewPopupConfirmed);\r\n                            break;\r\n                        case enums.PopUpActionType.No:\r\n                            //Reset the navigate to variable when the user chooses to stay on the message panel\r\n                            _this.navigateTo = enums.SaveAndNavigate.none;\r\n                    }\r\n                    break;\r\n            }\r\n        };\r\n        _this.onDiscardNewPopupConfirmed = function () {\r\n            if (_this.navigateTo === enums.SaveAndNavigate.newMessageButtonClick) {\r\n                _this.priorityDropDownSelectedItem = enums.MessagePriority.Standard;\r\n                _this.messageSubject = '';\r\n                _this.messageBody = '';\r\n                _this.isDropDownOpen = undefined;\r\n                _this.isQigDropDownOpen = undefined;\r\n                _this.toFieldValues = null;\r\n                _this.toFieldIds = null;\r\n                _this._selectedTeamList = new Array();\r\n                _this._isEntireTeamSelected = false;\r\n                tinymce.activeEditor.setContent('');\r\n                _this.enableDisableSendButton();\r\n                _this.props.onResetPopupCallback(_this.navigateTo);\r\n            }\r\n            else {\r\n                _this.props.onResetPopupCallback(_this.navigateTo);\r\n            }\r\n            _this.navigateTo = enums.SaveAndNavigate.none;\r\n        };\r\n        /**\r\n         *  Callback function for dropdown click\r\n         */\r\n        _this.onQigDropDownClick = function (dropDown, width) {\r\n            if (width) {\r\n                var style = {};\r\n                style.minWidth = width;\r\n                _this.setState({\r\n                    qigDropDownStyle: style\r\n                });\r\n            }\r\n            _this.onDropDownClick(dropDown);\r\n        };\r\n        _this.showToAddressList = function () {\r\n            _this.isShowTeamListPopup = true;\r\n            _this.setState({ renderedOn: Date.now() });\r\n        };\r\n        _this.hideToAddressList = function () {\r\n            _this.setState({ isshowToAddressList: false });\r\n        };\r\n        _this.saveToAddressList = function () {\r\n            _this.setState({ isshowToAddressList: false });\r\n        };\r\n        /**\r\n         * Handles the action event on team list Received.\r\n         */\r\n        _this.updatedTeamListReceived = function (isSaved) {\r\n            if (isSaved === void 0) { isSaved = false; }\r\n            _this.toFieldValues = new Array();\r\n            _this.toFieldIds = new Array();\r\n            _this._selectedTeamList = new Array();\r\n            _this._isEntireTeamSelected = false;\r\n            _this.isSubordinateSelected = false;\r\n            var teams = messageStore.instance.teamDetails;\r\n            if (teams && teams.team) {\r\n                if (teams.team.toTeam) {\r\n                    _this._isEntireTeamSelected = true;\r\n                    _this.isSubordinateSelected = true;\r\n                }\r\n                else {\r\n                    if (teams.team.parent && teams.team.parent.isChecked) {\r\n                        _this._selectedTeamList.push(teams.team.parent.fullName + ';');\r\n                    }\r\n                    if (teams.team.subordinates.length > 0) {\r\n                        _this.getSelectedSubordinateList(teams.team.subordinates);\r\n                    }\r\n                }\r\n                // the logged in user has subordinates, check the store for new TO list\r\n                // if there are no subordinates, the the supervisor details (if any) will be populated via props\r\n                if (messageStore.instance.teamDetails.team.subordinates &&\r\n                    messageStore.instance.teamDetails.team.subordinates.length > 0) {\r\n                    _this.populateToField(teams.team);\r\n                }\r\n                _this.isShowTeamListPopup = false;\r\n                if (isSaved && _this.priorityDropDownSelectedItem === enums.MessagePriority.Mandatory &&\r\n                    !_this.isSubordinateSelected) {\r\n                    messagingActionCreator.displayMandatoryValidationPopup(true);\r\n                }\r\n                _this.setState({ renderedOn: Date.now() });\r\n            }\r\n        };\r\n        /**\r\n         * Populates the To Fields based on the values in the store\r\n         */\r\n        _this.populateToField = function (team) {\r\n            if (team) {\r\n                // Add Parent Examiner of the current examiner if the parent is selected\r\n                if (team.isCurrentExaminer && team.parent && team.parent.isChecked) {\r\n                    _this.toFieldIds.push(team.parent.examinerId);\r\n                    _this.toFieldValues.push(team.parent.fullName);\r\n                }\r\n                if (!team.isCurrentExaminer && team.isChecked) {\r\n                    _this.toFieldIds.push(team.examinerId);\r\n                    _this.toFieldValues.push(team.fullName);\r\n                }\r\n                for (var _i = 0, _a = team.subordinates; _i < _a.length; _i++) {\r\n                    var subTeam = _a[_i];\r\n                    _this.populateToField(subTeam);\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * Handles the action event on To address list Received.\r\n         */\r\n        _this.teamListReceived = function () {\r\n            var teams = messageStore.instance.teamDetails;\r\n            var qigId = _this.props.selectedQigItemId;\r\n            _this._disableToButtonForStandardisationQig = false;\r\n            //Flag to identify whether the qig is in standardisation setup progress\r\n            var selectedQig = _this.props.qigItemsList.filter(function (x) { return x.id === _this.selectedQigItemId; });\r\n            var coordinationComplete = selectedQig[0].coordinationComplete;\r\n            if (teams && teams.team.subordinates) {\r\n                _this._isEntireTeamSelected = teams.team.toTeam;\r\n                _this.toFieldValues = new Array();\r\n                _this.toFieldIds = new Array();\r\n                _this._selectedTeamList = new Array();\r\n                if (_this.props.messageType === enums.MessageType.InboxReply) {\r\n                    _this.toFieldIds.push(_this.props.selectedMessage.fromExaminerId);\r\n                    _this.toFieldValues.push(_this.props.selectedMessage.examinerDetails.fullName);\r\n                    _this._selectedTeamList.push(_this.props.selectedMessage.examinerDetails.fullName);\r\n                    _this.isSubordinateSelected = _this.isReplyToSubordinate(teams.team.subordinates);\r\n                }\r\n                else if (!coordinationComplete) {\r\n                    // If the message is against standardisationsetup qig or response the receiver \r\n                    // should be stm parent else all work as existing\r\n                    if (teams.team.stmParent) {\r\n                        _this.toFieldIds.push(teams.team.stmParent.examinerId);\r\n                        _this.toFieldValues.push(teams.team.stmParent.fullName);\r\n                        _this._selectedTeamList.push(teams.team.stmParent.fullName);\r\n                        _this.isShowTeamListPopup = false;\r\n                        _this.isSubordinateSelected = false;\r\n                        // Disabling button if the user sends message against standardisation response or Qig\r\n                        _this._disableToButtonForStandardisationQig = true;\r\n                    }\r\n                }\r\n                else if (teams.team.subordinates.length === 0) {\r\n                    if (teams.team.parent) {\r\n                        _this.setMessagePanelToTabForParent(teams.team.parent);\r\n                    }\r\n                }\r\n            }\r\n            _this.setState({\r\n                renderedOn: Date.now()\r\n            });\r\n        };\r\n        /**\r\n         * Handles the action event on To address list Received.\r\n         */\r\n        _this.messagePriorityUpdate = function () {\r\n            _this.priorityDropDownSelectedItem = enums.MessagePriority.Standard;\r\n            _this.setState({\r\n                renderedOn: Date.now()\r\n            });\r\n        };\r\n        /**\r\n         * Set the selected language state upon successfull confirmation from locale store.\r\n         */\r\n        _this.languageChanged = function () {\r\n            _this.setState({\r\n                renderedOn: Date.now()\r\n            });\r\n        };\r\n        /**\r\n         * Handles the action event on To address list Received.\r\n         */\r\n        _this.isTinyMCELoaded = function (isLoaded) {\r\n            _this.setState({\r\n                isTinyMCELoaded: isLoaded\r\n            });\r\n        };\r\n        // Set the default states\r\n        _this.state = {\r\n            renderedOn: 0,\r\n            qigDropDownStyle: {},\r\n            isTinyMCELoaded: false\r\n        };\r\n        _this._selectedTeamList = new Array();\r\n        _this.teamListReceived = _this.teamListReceived.bind(_this);\r\n        _this._mandatoryMessagesFromMarkingToolCC = configurablecharacteristicshelper.getCharacteristicValue(configurablecharacteristicsnames.MandatoryMessagesFromMarkingTool).toLowerCase() === 'true' ? true : false;\r\n        _this.doShowMandatoryMessagePriority = _this.doShowMandatoryMessagePriority.bind(_this);\r\n        _this.doHideToButton = _this.doHideToButton.bind(_this);\r\n        return _this;\r\n    }\r\n    /**\r\n     * Render component\r\n     * @returns\r\n     */\r\n    MessagePopup.prototype.render = function () {\r\n        var _this = this;\r\n        var addressListPopup = this.isShowTeamListPopup ? (React.createElement(TeamListPopup, { isShowTeamListPopup: this.isShowTeamListPopup, id: 'teamlist-popup', key: 'teamlist-popup', selectedLanguage: this.props.selectedLanguage })) : null;\r\n        var toAddressListPopup = (React.createElement(\"div\", null,\r\n            React.createElement(\"button\", { className: 'secondary rounded popup-nav to-address-btn', \"aria-haspopup\": 'true', \"data-popup\": 'addressListPopUp', onClick: this.showToAddressList, id: 'messageToButton', key: 'messageToButton_key', disabled: this.doDisableToButton() }, localeStore.instance.TranslateText('messaging.compose-message.to-button')),\r\n            addressListPopup));\r\n        var _showMandatoryMessagePriority = this.doShowMandatoryMessagePriority();\r\n        var _doHideToButton = this.doHideToButton();\r\n        return (React.createElement(\"div\", { className: classNames('popup full-width popup-overlay  messaging', { 'open': this.props.isOpen }, { 'minimized': this.isMessagePopupMinimized }), id: 'composeMessage', role: 'dialog', \"aria-labelledby\": 'popup2Title', \"aria-describedby\": 'popup2Desc' },\r\n            React.createElement(\"div\", { className: 'popup-wrap compose-new-msg' },\r\n                React.createElement(\"div\", { className: 'popup-content', id: 'popup2Desc' },\r\n                    React.createElement(\"div\", { className: 'comp-msg-top' },\r\n                        React.createElement(\"div\", { className: 'qig-menu-holder' },\r\n                            this.renderQigSection(),\r\n                            React.createElement(\"div\", { className: 'set-priority' },\r\n                                React.createElement(MessagePriorityDropDown, { id: 'select_priority', dropDownType: enums.DropDownType.Priority, className: 'dropdown-wrap align-right', selectedItem: this.getPriorityDropDownItem(this.priorityDropDownSelectedItem), isOpen: this.clickedDropDown === enums.DropDownType.Priority ? this.isDropDownOpen : undefined, items: [{\r\n                                            id: enums.MessagePriority.Standard,\r\n                                            name: this.getPriorityDropDownItem(enums.MessagePriority.Standard)\r\n                                        },\r\n                                        {\r\n                                            id: enums.MessagePriority.Important,\r\n                                            name: this.getPriorityDropDownItem(enums.MessagePriority.Important)\r\n                                        },\r\n                                        _showMandatoryMessagePriority ? {\r\n                                            id: enums.MessagePriority.Mandatory,\r\n                                            name: this.getPriorityDropDownItem(enums.MessagePriority.Mandatory)\r\n                                        } : null], onClick: this.onDropDownClick, onSelect: this.onSelect }))),\r\n                        this.renderAssociatedResponseSection(),\r\n                        React.createElement(\"div\", { className: 'msg-recipient-wrap' },\r\n                            React.createElement(\"div\", { className: 'rec-address-label', id: 'message-popup-to-label' }, _doHideToButton ?\r\n                                localeStore.instance.TranslateText('messaging.compose-message.to-button') + ':' :\r\n                                toAddressListPopup),\r\n                            React.createElement(\"div\", { className: 'recipiants-list-wrap' }, this._isEntireTeamSelected ?\r\n                                React.createElement(\"span\", { className: 'recipiant-name', id: 'message-recipiant-name' }, localeStore.instance.TranslateText('messaging.compose-message.recipient-selector.entire-team') + ';') :\r\n                                this._selectedTeamList.map(function (item, index) {\r\n                                    return React.createElement(\"span\", { className: 'recipiant-name', key: 'recipiant-name' + index.toString() }, item);\r\n                                }))),\r\n                        React.createElement(\"div\", { className: 'comp-subject-wrap' },\r\n                            React.createElement(\"label\", { htmlFor: 'message-subject', id: 'subject-label-popup', className: 'comp-subject-label' }, localeStore.instance.TranslateText('messaging.compose-message.subject') + ':'),\r\n                            React.createElement(Subject, { id: 'message-subject', key: 'key-message-subject', outerClass: 'subject-input-wrap', refName: 'subjectInput', hasFocus: (this.props.messageType === enums.MessageType.InboxCompose ||\r\n                                    this.props.messageType === enums.MessageType.WorklistCompose ||\r\n                                    this.props.messageType === enums.MessageType.TeamCompose), className: 'subject-input', onChange: this.handleSubjectChange, maxLength: 120, isVisible: this.props.isOpen, value: this.messageSubject }))),\r\n                    React.createElement(\"div\", { className: 'comp-msg-bottom', ref: 'msgEditor' },\r\n                        React.createElement(\"div\", { className: 'msg-editor' },\r\n                            React.createElement(MessageEditor, { htmlContent: this.messageBody, id: this.msgEditorId, key: 'key-' + this.msgEditorId, hasFocus: messageHelper.hasFocus(this.props.messageType), \"aria-label\": this.msgEditorId, toggleSaveButtonState: this.toggleSaveButtonState, selectedLanguage: this.props.selectedLanguage, isTinyMCELoaded: this.isTinyMCELoaded })))),\r\n                React.createElement(\"div\", { className: 'popup-header compose-msg-header' },\r\n                    React.createElement(\"h3\", { id: 'popup2Title', className: 'shift-left comp-msg-title' }, messageHelper.getMessageHeader(this.props.messageType)),\r\n                    React.createElement(\"div\", { className: 'shift-left comp-msg-butons' },\r\n                        React.createElement(GenericButton, { id: 'message_send_btn', key: 'key_message_send_btn', className: 'button primary rounded', title: localeStore.instance.TranslateText('messaging.compose-message.send-button-tooltip'), content: localeStore.instance.TranslateText('messaging.compose-message.send-button'), disabled: this.isSendButtonDisabled || this.isShowTeamListPopup, onClick: function () { _this.messageSendValidationCheck(_this.props.messageType); } })),\r\n                    React.createElement(\"div\", { className: 'shift-right minimize-message' },\r\n                        React.createElement(\"a\", { href: 'javascript:void(0)', className: 'minimize-message-link', id: 'message-minimize', title: localeStore.instance.TranslateText('messaging.compose-message.minimise-icon-tooltip'), onClick: this.onMinimize },\r\n                            React.createElement(\"span\", { className: 'minimize-icon lite' }, localeStore.instance.TranslateText('messaging.compose-message.minimise-icon-tooltip'))),\r\n                        React.createElement(\"a\", { href: 'javascript:void(0)', className: 'maximize-message-link', id: 'message-maximize', title: localeStore.instance.TranslateText('messaging.compose-message.maximise-icon-tooltip'), onClick: this.onMaximize },\r\n                            React.createElement(\"span\", { className: 'maxmize-icon lite' }, localeStore.instance.TranslateText('messaging.compose-message.maximise-icon-tooltip'))),\r\n                        React.createElement(\"a\", { href: 'javascript:void(0)', className: 'close-message-link', title: localeStore.instance.TranslateText('messaging.compose-message.close-icon-tooltip'), id: 'message-close', onClick: this.onMessageClose },\r\n                            React.createElement(\"span\", { className: 'close-icon lite' }, localeStore.instance.TranslateText('messaging.compose-message.close-icon-tooltip'))))))));\r\n    };\r\n    /**\r\n     * Component did mount\r\n     */\r\n    MessagePopup.prototype.componentDidMount = function () {\r\n        messageStore.instance.addListener(messageStore.MessageStore.SEND_MESSAGE_SUCCESS_EVENT, this.resetAndCloseMessagePanel);\r\n        messageStore.instance.addListener(messageStore.MessageStore.MESSAGE_OPEN_EVENT, this.onOpen);\r\n        messageStore.instance.addListener(messageStore.MessageStore.MESSAGE_NAVIGATE_EVENT, this.onNavigateAwayFromInbox);\r\n        messageStore.instance.addListener(messageStore.MessageStore.POPUP_DISPLAY_EVENT, this.onPopUpDisplayEvent);\r\n        window.addEventListener('click', this._boundHandleOnClick);\r\n        messageStore.instance.addListener(messageStore.MessageStore.MESSAGE_MINIMIZE_EVENT, this.onMinimizeMessagePanel);\r\n        messageStore.instance.addListener(messageStore.MessageStore.MESSAGE_MAXIMIZE_EVENT, this.onMaximizeMessagePanel);\r\n        messageStore.instance.addListener(messageStore.MessageStore.MESSAGE_CLOSE_EVENT, this.onMessagePanelClose);\r\n        messageStore.instance.addListener(messageStore.MessageStore.MESSAGE_NAVIGATION_EVENT, this.onNavigateFromMessagePanel);\r\n        messageStore.instance.addListener(messageStore.MessageStore.UPDATE_TEAM_LIST_RECEIVED, this.updatedTeamListReceived);\r\n        messageStore.instance.addListener(messageStore.MessageStore.TEAM_LIST_RECEIVED, this.teamListReceived);\r\n        messageStore.instance.addListener(messageStore.MessageStore.UPDATE_MESSAGE_PRIORITY_EVENT, this.messagePriorityUpdate);\r\n        teamManagementStore.instance.addListener(teamManagementStore.TeamManagementStore.APPROVAL_MANAGEMENT_ACTION_EXECUTED, this.examinerValidation);\r\n        applicationStore.instance.addListener(applicationStore.ApplicationStore.ONLINE_STATUS_UPDATED_EVENT, this.onOnlineStatusChanged);\r\n        localeStore.instance.addListener(localeStore.LocaleStore.LOCALE_CHANGE_EVENT, this.languageChanged);\r\n        // Set the variables from props.\r\n        if (this.props.messageType === enums.MessageType.TeamCompose) {\r\n            this.selectedQig = this.props.selectedQigItem;\r\n            this.selectedQigItemId = this.props.selectedQigItemId;\r\n            this.questionPaperPartId = this.props.questionPaperPartId;\r\n            this.onOpen(enums.MessageType.TeamCompose);\r\n        }\r\n    };\r\n    /**\r\n     * Component will unmount\r\n     */\r\n    MessagePopup.prototype.componentWillUnmount = function () {\r\n        messageStore.instance.removeListener(messageStore.MessageStore.SEND_MESSAGE_SUCCESS_EVENT, this.resetAndCloseMessagePanel);\r\n        messageStore.instance.removeListener(messageStore.MessageStore.MESSAGE_OPEN_EVENT, this.onOpen);\r\n        messageStore.instance.removeListener(messageStore.MessageStore.MESSAGE_NAVIGATE_EVENT, this.onNavigateAwayFromInbox);\r\n        messageStore.instance.removeListener(messageStore.MessageStore.POPUP_DISPLAY_EVENT, this.onPopUpDisplayEvent);\r\n        window.removeEventListener('click', this._boundHandleOnClick);\r\n        messageStore.instance.removeListener(messageStore.MessageStore.MESSAGE_MINIMIZE_EVENT, this.onMinimizeMessagePanel);\r\n        messageStore.instance.removeListener(messageStore.MessageStore.MESSAGE_MAXIMIZE_EVENT, this.onMaximizeMessagePanel);\r\n        messageStore.instance.removeListener(messageStore.MessageStore.MESSAGE_CLOSE_EVENT, this.onMessagePanelClose);\r\n        messageStore.instance.removeListener(messageStore.MessageStore.MESSAGE_NAVIGATION_EVENT, this.onNavigateFromMessagePanel);\r\n        keyDownHelper.instance.Activate(enums.MarkEntryDeactivator.Messaging);\r\n        if (messageStore.instance.messageViewAction !== enums.MessageViewAction.None) {\r\n            messagingActionCreator.messageAction(enums.MessageViewAction.None);\r\n        }\r\n        messageStore.instance.removeListener(messageStore.MessageStore.UPDATE_TEAM_LIST_RECEIVED, this.updatedTeamListReceived);\r\n        messageStore.instance.removeListener(messageStore.MessageStore.TEAM_LIST_RECEIVED, this.teamListReceived);\r\n        messageStore.instance.removeListener(messageStore.MessageStore.UPDATE_MESSAGE_PRIORITY_EVENT, this.messagePriorityUpdate);\r\n        teamManagementStore.instance.removeListener(teamManagementStore.TeamManagementStore.APPROVAL_MANAGEMENT_ACTION_EXECUTED, this.examinerValidation);\r\n        applicationStore.instance.removeListener(applicationStore.ApplicationStore.ONLINE_STATUS_UPDATED_EVENT, this.onOnlineStatusChanged);\r\n        localeStore.instance.removeListener(localeStore.LocaleStore.LOCALE_CHANGE_EVENT, this.languageChanged);\r\n    };\r\n    /**\r\n     * Component will receive props\r\n     * @param {Props} nextProps\r\n     */\r\n    MessagePopup.prototype.componentWillReceiveProps = function (nextProps) {\r\n        // Defect 44392 fix - select a qig text in message area is not getting localized upon changing language \r\n        if (nextProps.selectedQigItemId > 0) {\r\n            this.selectedQig = nextProps.selectedQigItem;\r\n        }\r\n        else {\r\n            this.selectedQig = localeStore.instance.TranslateText('messaging.compose-message.select-qig-placeholder');\r\n        }\r\n        this.selectedQigItemId = nextProps.selectedQigItemId;\r\n        this.questionPaperPartId = nextProps.questionPaperPartId;\r\n        // to close teamlist popup while opening new message\r\n        if (this.selectedQigItemId === 0) {\r\n            this.isShowTeamListPopup = false;\r\n        }\r\n    };\r\n    /**\r\n     * Set Inbox Forward and Replay Message details\r\n     */\r\n    MessagePopup.prototype.setInboxForwardReplyMessageDetails = function () {\r\n        keyDownHelper.instance.DeActivate(enums.MarkEntryDeactivator.Messaging);\r\n        // set messageSubject for reply and forward messages\r\n        if ((this.props.messageType === enums.MessageType.InboxForward || this.props.messageType === enums.MessageType.InboxReply)\r\n            && this.props.isReplyOrForwardClicked && this.props.selectedMessage) {\r\n            // reset isMessagePopupMinimized variable\r\n            this.isMessagePopupMinimized = false;\r\n            this.messageSubject = messageHelper.getSubjectContent(this.props.messageType, this.props.subject);\r\n            this.priorityDropDownSelectedItem = this.props.priorityDropDownSelectedItem;\r\n            this.messageBody = this.props.messageBody;\r\n            var qigId_1 = this.props.selectedQigItemId;\r\n            var examinerRoleId = this.props.qigItemsList.filter(function (x) { return x.id === qigId_1; })[0].examinerRoleId;\r\n            var args = {\r\n                examinerRoleId: examinerRoleId,\r\n                qigId: qigId_1\r\n            };\r\n            // get the teamdetails to find whether atleast one subordinate is\r\n            // selected(for displaying mandatory priority options)\r\n            messagingActionCreator.getTeamDetails(args);\r\n        }\r\n    };\r\n    /**\r\n     * Component did update\r\n     */\r\n    MessagePopup.prototype.componentDidUpdate = function () {\r\n        // enable or disable send button while changing QIG dropdown\r\n        if (this.props.isOpen) {\r\n            this.enableDisableSendButton();\r\n        }\r\n        if (this.doTriggerMessageOpenEvent) {\r\n            this.doTriggerMessageOpenEvent = false;\r\n            this.onOpen(this.msgType);\r\n        }\r\n    };\r\n    /**\r\n     * To avoid the qigs in which the selected examiner has no supervisor\r\n     * @param {Array<Item>} qigItemsList\r\n     * @returns\r\n     */\r\n    MessagePopup.prototype.filterQigItems = function (qigItemsList) {\r\n        return qigItemsList.filter(function (x) { return x.parentExaminerId !== 0; });\r\n    };\r\n    /**\r\n     * To show madatory message priority option in dropdown\r\n     */\r\n    MessagePopup.prototype.doShowMandatoryMessagePriority = function () {\r\n        var _this = this;\r\n        var isMandatoryPriorityAvailable = false;\r\n        // Mandatory Message Priority is availability only if :\r\n        // 1. It is a TeamCompose as TeamCompose is always to subordinates. OR\r\n        // 2. If not WorklistCompose as WorklistCompose will be always to Supervisor. AND\r\n        //      (i).[QIG is not selected.] OR\r\n        //      (ii).[If QIG is selected AND there are no selected examiners.] OR\r\n        //      (iii).[If QIG is selected AND there are selected examiners AND atleast one subordinate is selected.]\r\n        // PS : ResponseCompose Scenarios are handled in message.tsx\r\n        if (this.props.messageType === enums.MessageType.TeamCompose ||\r\n            (this.props.messageType !== enums.MessageType.WorklistCompose &&\r\n                (this.selectedQigItemId === 0 ||\r\n                    (this.selectedQigItemId > 0 && this._selectedTeamList && this._selectedTeamList.length === 0) ||\r\n                    (this.selectedQigItemId > 0 && this._selectedTeamList && this._selectedTeamList.length > 0 && this.isSubordinateSelected)))) {\r\n            isMandatoryPriorityAvailable = true;\r\n        }\r\n        if (this.props.qigItemsList.length > 0 && this.selectedQigItemId > 0) {\r\n            var selectedQig = this.props.qigItemsList.filter(function (x) { return x.id === _this.selectedQigItemId; });\r\n            var currentExaminerApprovalStatus = selectedQig[0].approvalStatusId;\r\n            if (currentExaminerApprovalStatus === enums.ExaminerApproval.NotApproved ||\r\n                currentExaminerApprovalStatus === enums.ExaminerApproval.Suspended) {\r\n                isMandatoryPriorityAvailable = false;\r\n            }\r\n        }\r\n        return this._mandatoryMessagesFromMarkingToolCC && isMandatoryPriorityAvailable;\r\n    };\r\n    /**\r\n     * show or hide 'To' button\r\n     */\r\n    MessagePopup.prototype.doHideToButton = function () {\r\n        var _subordinates = null;\r\n        if (messageStore.instance.teamDetails &&\r\n            messageStore.instance.teamDetails.team &&\r\n            messageStore.instance.teamDetails.team.subordinates) {\r\n            _subordinates = messageStore.instance.teamDetails.team.subordinates;\r\n        }\r\n        return ((_subordinates && _subordinates.length) === 0 ||\r\n            this.props.messageType === enums.MessageType.InboxReply ||\r\n            this.props.messageType === enums.MessageType.WorklistCompose ||\r\n            this.props.messageType === enums.MessageType.TeamCompose);\r\n    };\r\n    /**\r\n     * Get selected subordinated list.\r\n     */\r\n    MessagePopup.prototype.getSelectedSubordinateList = function (teamList) {\r\n        var that = this;\r\n        teamList.map(function (examinerInfo) {\r\n            if (examinerInfo.isChecked) {\r\n                that.isSubordinateSelected = true;\r\n                that._selectedTeamList.push(examinerInfo.fullName + ';');\r\n            }\r\n            if (examinerInfo.subordinates.length > 0) {\r\n                that.getSelectedSubordinateList(examinerInfo.subordinates);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Ensure Reply is done to a subordinate.\r\n     */\r\n    MessagePopup.prototype.isReplyToSubordinate = function (teamList) {\r\n        // Suboridinates of the current examiner will be passed here\r\n        // If the selectedMessage.fromExaminerId is one among them, set isSubordinate as true.\r\n        var that = this;\r\n        var isSubordinate = false;\r\n        teamList.map(function (examinerInfo) {\r\n            if (examinerInfo.examinerId === that.props.selectedMessage.fromExaminerId) {\r\n                isSubordinate = true;\r\n            }\r\n            if (examinerInfo.subordinates.length > 0) {\r\n                that.isReplyToSubordinate(examinerInfo.subordinates);\r\n            }\r\n        });\r\n        return isSubordinate;\r\n    };\r\n    /**\r\n     * This method will set message panel property for sending message to the parent\r\n     */\r\n    MessagePopup.prototype.setMessagePanelToTabForParent = function (parent) {\r\n        this.toFieldIds.push(parent.examinerId);\r\n        this.toFieldValues.push(parent.fullName);\r\n        this._selectedTeamList.push(parent.fullName);\r\n        this.isSubordinateSelected = false;\r\n    };\r\n    /**\r\n     * check to enable to button\r\n     */\r\n    MessagePopup.prototype.doDisableToButton = function () {\r\n        if (this.selectedQigItemId === 0 ||\r\n            !messageStore.instance.teamDetails ||\r\n            messageStore.instance.teamDetails.team.subordinates.length === 0 || this._disableToButtonForStandardisationQig) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return MessagePopup;\r\n}(MessageBase));\r\nmodule.exports = MessagePopup;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDU3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWVzc2FnZS9tZXNzYWdlcG9wdXAudHN4PzA3OTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcclxuaW1wb3J0IFJlYWN0RG9tID0gcmVxdWlyZSgncmVhY3QtZG9tJyk7XHJcbmltcG9ydCBwdXJlUmVuZGVyQ29tcG9uZW50ID0gcmVxdWlyZSgnLi4vYmFzZS9wdXJlcmVuZGVyY29tcG9uZW50Jyk7XHJcbmltcG9ydCBNZXNzYWdlUHJpb3JpdHlEcm9wRG93biA9IHJlcXVpcmUoJy4vbWVzc2FnZXByaW9yaXR5ZHJvcGRvd24nKTtcclxuaW1wb3J0IGxvY2FsZVN0b3JlID0gcmVxdWlyZSgnLi4vLi4vc3RvcmVzL2xvY2FsZS9sb2NhbGVzdG9yZScpO1xyXG5pbXBvcnQgR2VuZXJpY0J1dHRvbiA9IHJlcXVpcmUoJy4uL3V0aWxpdHkvZ2VuZXJpY2J1dHRvbicpO1xyXG5pbXBvcnQgbWVzc2FnZVN0b3JlID0gcmVxdWlyZSgnLi4vLi4vc3RvcmVzL21lc3NhZ2UvbWVzc2FnZXN0b3JlJyk7XHJcbmltcG9ydCBlbnVtcyA9IHJlcXVpcmUoJy4uL3V0aWxpdHkvZW51bXMnKTtcclxuaW1wb3J0IE1lc3NhZ2VCYXNlID0gcmVxdWlyZSgnLi9tZXNzYWdlYmFzZScpO1xyXG5pbXBvcnQgTWVzc2FnZUVkaXRvciA9IHJlcXVpcmUoJy4vbWVzc2FnZWVkaXRvcicpO1xyXG5pbXBvcnQgU3ViamVjdCA9IHJlcXVpcmUoJy4vc3ViamVjdCcpO1xyXG5sZXQgY2xhc3NOYW1lcyA9IHJlcXVpcmUoJ2NsYXNzbmFtZXMnKTtcclxuaW1wb3J0IGV4YW1pbmVyU3RvcmUgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvbWFya2VyaW5mb3JtYXRpb24vZXhhbWluZXJzdG9yZScpO1xyXG5pbXBvcnQgcWlnU3RvcmUgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvcWlnc2VsZWN0b3IvcWlnc3RvcmUnKTtcclxuaW1wb3J0IG1lc3NhZ2luZ0FjdGlvbkNyZWF0b3IgPSByZXF1aXJlKCcuLi8uLi9hY3Rpb25zL21lc3NhZ2luZy9tZXNzYWdpbmdhY3Rpb25jcmVhdG9yJyk7XHJcbmltcG9ydCBwb3B1cEhlbHBlciA9IHJlcXVpcmUoJy4uL3V0aWxpdHkvcG9wdXAvcG9wdXBoZWxwZXInKTtcclxuaW1wb3J0IFFpZ0Ryb3BEb3duID0gcmVxdWlyZSgnLi4vdXRpbGl0eS9kcm9wZG93bicpO1xyXG5pbXBvcnQgbWVzc2FnZUhlbHBlciA9IHJlcXVpcmUoJy4uL3V0aWxpdHkvbWVzc2FnZS9tZXNzYWdlaGVscGVyJyk7XHJcbmltcG9ydCBrZXlEb3duSGVscGVyID0gcmVxdWlyZSgnLi4vLi4vdXRpbGl0eS9nZW5lcmljL2tleWRvd25oZWxwZXInKTtcclxuaW1wb3J0IGh0bWxVdGlsaXRpZXMgPSByZXF1aXJlKCcuLi8uLi91dGlsaXR5L2dlbmVyaWMvaHRtbHV0aWxpdGllcycpO1xyXG5pbXBvcnQgdGVhbUFyZ3VtZW50ID0gcmVxdWlyZSgnLi4vLi4vZGF0YXNlcnZpY2VzL21lc3NhZ2luZy90ZWFtYXJndW1lbnQnKTtcclxuaW1wb3J0IFRlYW1MaXN0UG9wdXAgPSByZXF1aXJlKCcuL3RlYW1saXN0cG9wdXAnKTtcclxuaW1wb3J0IHRvQWRkcmVzc0xpc3QgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvbWVzc2FnZS90eXBpbmdzL3RlYW1yZXR1cm4nKTtcclxuaW1wb3J0IGNvbmZpZ3VyYWJsZWNoYXJhY3RlcmlzdGljc2hlbHBlciA9IHJlcXVpcmUoJy4uLy4uL3V0aWxpdHkvY29uZmlndXJhYmxlY2hhcmFjdGVyaXN0aWMvY29uZmlndXJhYmxlY2hhcmFjdGVyaXN0aWNzaGVscGVyJyk7XHJcbmltcG9ydCBjb25maWd1cmFibGVjaGFyYWN0ZXJpc3RpY3NuYW1lcyA9IHJlcXVpcmUoJy4uLy4uL3V0aWxpdHkvY29uZmlndXJhYmxlY2hhcmFjdGVyaXN0aWMvY29uZmlndXJhYmxlY2hhcmFjdGVyaXN0aWNzbmFtZXMnKTtcclxuaW1wb3J0IHVzZXJJbmZvU3RvcmUgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvdXNlcmluZm8vdXNlcmluZm9zdG9yZScpO1xyXG5pbXBvcnQgdGVhbU1hbmFnZW1lbnRTdG9yZSA9IHJlcXVpcmUoJy4uLy4uL3N0b3Jlcy90ZWFtbWFuYWdlbWVudC90ZWFtbWFuYWdlbWVudHN0b3JlJyk7XHJcbmltcG9ydCBhcHBsaWNhdGlvblN0b3JlID0gcmVxdWlyZSgnLi4vLi4vc3RvcmVzL2FwcGxpY2F0aW9ub2ZmbGluZS9hcHBsaWNhdGlvbnN0b3JlJyk7XHJcbmRlY2xhcmUgbGV0IHRpbnltY2U6IGFueTtcclxuXHJcbmludGVyZmFjZSBQcm9wcyBleHRlbmRzIFByb3BzQmFzZSwgTG9jYWxlU2VsZWN0aW9uQmFzZSB7XHJcbiAgICBtZXNzYWdlVHlwZTogZW51bXMuTWVzc2FnZVR5cGU7XHJcbiAgICBjbG9zZU1lc3NhZ2VQYW5lbDogRnVuY3Rpb247XHJcbiAgICBvblFpZ0l0ZW1TZWxlY3RlZDogRnVuY3Rpb247XHJcbiAgICBvblJlc2V0UG9wdXBDYWxsYmFjazogRnVuY3Rpb247XHJcbiAgICBxaWdJdGVtc0xpc3Q6IEFycmF5PEl0ZW0+O1xyXG4gICAgc2VsZWN0ZWRRaWdJdGVtOiBzdHJpbmc7XHJcbiAgICBzZWxlY3RlZFFpZ0l0ZW1JZDogbnVtYmVyO1xyXG4gICAgc3VwZXJ2aXNvck5hbWU6IHN0cmluZztcclxuICAgIHN1cGVydmlzb3JJZDogbnVtYmVyO1xyXG4gICAgcmVzcG9uc2VJZDogc3RyaW5nO1xyXG4gICAgaXNPcGVuOiBib29sZWFuO1xyXG4gICAgcWlnTmFtZTogc3RyaW5nO1xyXG4gICAgbWVzc2FnZUJvZHk6IHN0cmluZztcclxuICAgIHByaW9yaXR5RHJvcERvd25TZWxlY3RlZEl0ZW06IGVudW1zLk1lc3NhZ2VQcmlvcml0eTtcclxuICAgIHF1ZXN0aW9uUGFwZXJQYXJ0SWQ6IG51bWJlcjtcclxuICAgIHNlbGVjdGVkTWVzc2FnZTogTWVzc2FnZTtcclxuICAgIHNlbGVjdGVkTWVzc2FnZURldGFpbHM6IE1lc3NhZ2VEZXRhaWxzO1xyXG4gICAgaXNSZXBseU9yRm9yd2FyZENsaWNrZWQ6IGJvb2xlYW47XHJcbiAgICBzdWJqZWN0OiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgICByZW5kZXJlZE9uPzogbnVtYmVyO1xyXG4gICAgcWlnRHJvcERvd25TdHlsZT86IFJlYWN0LkNTU1Byb3BlcnRpZXM7XHJcbiAgICBpc1RpbnlNQ0VMb2FkZWQ/OiBib29sZWFuO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgSXRlbSB7XHJcbiAgICBpZDogbnVtYmVyO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgcGFyZW50RXhhbWluZXJEaXNwbGF5TmFtZTogc3RyaW5nO1xyXG4gICAgcGFyZW50RXhhbWluZXJJZDogbnVtYmVyO1xyXG4gICAgZXhhbWluZXJSb2xlSWQ6IG51bWJlcjtcclxufVxyXG5cclxuY2xhc3MgTWVzc2FnZVBvcHVwIGV4dGVuZHMgTWVzc2FnZUJhc2Uge1xyXG5cclxuICAgIHByaXZhdGUgaXNTaG93VGVhbUxpc3RQb3B1cDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgIHByaXZhdGUgX3NlbGVjdGVkVGVhbUxpc3Q6IEFycmF5PHN0cmluZz47XHJcblxyXG4gICAgcHJpdmF0ZSBfaXNFbnRpcmVUZWFtU2VsZWN0ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICBwcml2YXRlIF9tYW5kYXRvcnlNZXNzYWdlc0Zyb21NYXJraW5nVG9vbENDOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gICAgcHJpdmF0ZSBfZGlzYWJsZVRvQnV0dG9uRm9yU3RhbmRhcmRpc2F0aW9uUWlnOiBib29sZWFuO1xyXG5cclxuICAgIHByaXZhdGUgZG9UcmlnZ2VyTWVzc2FnZU9wZW5FdmVudDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgIHByaXZhdGUgbXNnVHlwZTogZW51bXMuTWVzc2FnZVR5cGU7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RvciBNZXNzYWdlcG9wdXBcclxuICAgICAqIEBwYXJhbSBwcm9wc1xyXG4gICAgICogQHBhcmFtIHN0YXRlXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcywgc3RhdGU6IFN0YXRlKSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMsIHN0YXRlKTtcclxuXHJcbiAgICAgICAgLy8gU2V0IHRoZSBkZWZhdWx0IHN0YXRlc1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIHJlbmRlcmVkT246IDAsXHJcbiAgICAgICAgICAgIHFpZ0Ryb3BEb3duU3R5bGU6IHt9LFxyXG4gICAgICAgICAgICBpc1RpbnlNQ0VMb2FkZWQ6IGZhbHNlXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9zZWxlY3RlZFRlYW1MaXN0ID0gbmV3IEFycmF5PHN0cmluZz4oKTtcclxuICAgICAgICB0aGlzLnRlYW1MaXN0UmVjZWl2ZWQgPSB0aGlzLnRlYW1MaXN0UmVjZWl2ZWQuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLl9tYW5kYXRvcnlNZXNzYWdlc0Zyb21NYXJraW5nVG9vbENDID0gY29uZmlndXJhYmxlY2hhcmFjdGVyaXN0aWNzaGVscGVyLmdldENoYXJhY3RlcmlzdGljVmFsdWUoXHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZWNoYXJhY3RlcmlzdGljc25hbWVzLk1hbmRhdG9yeU1lc3NhZ2VzRnJvbU1hcmtpbmdUb29sKS50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZScgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgdGhpcy5kb1Nob3dNYW5kYXRvcnlNZXNzYWdlUHJpb3JpdHkgPSB0aGlzLmRvU2hvd01hbmRhdG9yeU1lc3NhZ2VQcmlvcml0eS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuZG9IaWRlVG9CdXR0b24gPSB0aGlzLmRvSGlkZVRvQnV0dG9uLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXIgY29tcG9uZW50XHJcbiAgICAgKiBAcmV0dXJuc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcmVuZGVyKCk6IEpTWC5FbGVtZW50IHtcclxuICAgICAgICBsZXQgYWRkcmVzc0xpc3RQb3B1cCA9IHRoaXMuaXNTaG93VGVhbUxpc3RQb3B1cCA/IChcclxuICAgICAgICAgICAgPFRlYW1MaXN0UG9wdXAgaXNTaG93VGVhbUxpc3RQb3B1cCA9IHt0aGlzLmlzU2hvd1RlYW1MaXN0UG9wdXB9XHJcbiAgICAgICAgICAgICAgICBpZCA9eyd0ZWFtbGlzdC1wb3B1cCd9IGtleSA9IHsndGVhbWxpc3QtcG9wdXAnfSBzZWxlY3RlZExhbmd1YWdlID0ge3RoaXMucHJvcHMuc2VsZWN0ZWRMYW5ndWFnZX0vPlxyXG4gICAgICAgICkgOiBudWxsO1xyXG5cclxuICAgICAgICBsZXQgdG9BZGRyZXNzTGlzdFBvcHVwID0gKFxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9J3NlY29uZGFyeSByb3VuZGVkIHBvcHVwLW5hdiB0by1hZGRyZXNzLWJ0bidcclxuICAgICAgICAgICAgICAgICAgICBhcmlhLWhhc3BvcHVwPSd0cnVlJ1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEtcG9wdXA9J2FkZHJlc3NMaXN0UG9wVXAnXHJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5zaG93VG9BZGRyZXNzTGlzdH1cclxuICAgICAgICAgICAgICAgICAgICBpZCA9IHsnbWVzc2FnZVRvQnV0dG9uJ31cclxuICAgICAgICAgICAgICAgICAgICBrZXkgPSB7J21lc3NhZ2VUb0J1dHRvbl9rZXknfVxyXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXt0aGlzLmRvRGlzYWJsZVRvQnV0dG9uKCl9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcuY29tcG9zZS1tZXNzYWdlLnRvLWJ1dHRvbicpfVxyXG4gICAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICB7YWRkcmVzc0xpc3RQb3B1cH1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuICAgICAgICBsZXQgX3Nob3dNYW5kYXRvcnlNZXNzYWdlUHJpb3JpdHk6IGJvb2xlYW4gPSB0aGlzLmRvU2hvd01hbmRhdG9yeU1lc3NhZ2VQcmlvcml0eSgpO1xyXG4gICAgICAgIGxldCBfZG9IaWRlVG9CdXR0b246IGJvb2xlYW4gPSB0aGlzLmRvSGlkZVRvQnV0dG9uKCk7XHJcbiAgICAgICAgcmV0dXJuICg8ZGl2IGNsYXNzTmFtZT17IGNsYXNzTmFtZXMoJ3BvcHVwIGZ1bGwtd2lkdGggcG9wdXAtb3ZlcmxheSAgbWVzc2FnaW5nJyxcclxuICAgICAgICAgICAgeyAnb3Blbic6IHRoaXMucHJvcHMuaXNPcGVuIH0sIHsgJ21pbmltaXplZCc6IHRoaXMuaXNNZXNzYWdlUG9wdXBNaW5pbWl6ZWQgfSkgfVxyXG4gICAgICAgICAgICBpZD0nY29tcG9zZU1lc3NhZ2UnIHJvbGU9J2RpYWxvZycgYXJpYS1sYWJlbGxlZGJ5PSdwb3B1cDJUaXRsZScgYXJpYS1kZXNjcmliZWRieT0ncG9wdXAyRGVzYyc+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdwb3B1cC13cmFwIGNvbXBvc2UtbmV3LW1zZyc+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ncG9wdXAtY29udGVudCcgaWQ9J3BvcHVwMkRlc2MnPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdjb21wLW1zZy10b3AnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ncWlnLW1lbnUtaG9sZGVyJz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGhpcy5yZW5kZXJRaWdTZWN0aW9uKCkgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3NldC1wcmlvcml0eSc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPE1lc3NhZ2VQcmlvcml0eURyb3BEb3duIGlkPXsnc2VsZWN0X3ByaW9yaXR5J31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcERvd25UeXBlID0ge2VudW1zLkRyb3BEb3duVHlwZS5Qcmlvcml0eX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lID0geydkcm9wZG93bi13cmFwIGFsaWduLXJpZ2h0J31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJdGVtID0geyB0aGlzLmdldFByaW9yaXR5RHJvcERvd25JdGVtKHRoaXMucHJpb3JpdHlEcm9wRG93blNlbGVjdGVkSXRlbSkgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc09wZW4gPSB7dGhpcy5jbGlja2VkRHJvcERvd24gPT09IGVudW1zLkRyb3BEb3duVHlwZS5Qcmlvcml0eSA/IHRoaXMuaXNEcm9wRG93bk9wZW4gOiB1bmRlZmluZWQgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtcyA9IHtbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGVudW1zLk1lc3NhZ2VQcmlvcml0eS5TdGFuZGFyZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMuZ2V0UHJpb3JpdHlEcm9wRG93bkl0ZW0oZW51bXMuTWVzc2FnZVByaW9yaXR5LlN0YW5kYXJkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogZW51bXMuTWVzc2FnZVByaW9yaXR5LkltcG9ydGFudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMuZ2V0UHJpb3JpdHlEcm9wRG93bkl0ZW0oZW51bXMuTWVzc2FnZVByaW9yaXR5LkltcG9ydGFudClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Nob3dNYW5kYXRvcnlNZXNzYWdlUHJpb3JpdHkgPyB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogZW51bXMuTWVzc2FnZVByaW9yaXR5Lk1hbmRhdG9yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMuZ2V0UHJpb3JpdHlEcm9wRG93bkl0ZW0oZW51bXMuTWVzc2FnZVByaW9yaXR5Lk1hbmRhdG9yeSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSA6IG51bGxdfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrID0geyB0aGlzLm9uRHJvcERvd25DbGlja31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25TZWxlY3QgPSB7IHRoaXMub25TZWxlY3QgfS8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IHRoaXMucmVuZGVyQXNzb2NpYXRlZFJlc3BvbnNlU2VjdGlvbigpIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdtc2ctcmVjaXBpZW50LXdyYXAnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3JlYy1hZGRyZXNzLWxhYmVsJyBpZD0nbWVzc2FnZS1wb3B1cC10by1sYWJlbCc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBfZG9IaWRlVG9CdXR0b24gP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcuY29tcG9zZS1tZXNzYWdlLnRvLWJ1dHRvbicpICsgJzonIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9BZGRyZXNzTGlzdFBvcHVwIH1cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ncmVjaXBpYW50cy1saXN0LXdyYXAnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faXNFbnRpcmVUZWFtU2VsZWN0ZWQgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdyZWNpcGlhbnQtbmFtZScgaWQ9J21lc3NhZ2UtcmVjaXBpYW50LW5hbWUnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgnbWVzc2FnaW5nLmNvbXBvc2UtbWVzc2FnZS5yZWNpcGllbnQtc2VsZWN0b3IuZW50aXJlLXRlYW0nKSArICc7J31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj4gOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0ZWRUZWFtTGlzdC5tYXAoKGl0ZW06IHN0cmluZywgaW5kZXg6IG51bWJlcikgPT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9J3JlY2lwaWFudC1uYW1lJyBrZXk9eydyZWNpcGlhbnQtbmFtZScgKyBpbmRleC50b1N0cmluZygpfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2l0ZW19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdjb21wLXN1YmplY3Qtd3JhcCc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgaHRtbEZvcj0nbWVzc2FnZS1zdWJqZWN0JyBpZCA9eydzdWJqZWN0LWxhYmVsLXBvcHVwJ30gY2xhc3NOYW1lPSdjb21wLXN1YmplY3QtbGFiZWwnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgbG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dCgnbWVzc2FnaW5nLmNvbXBvc2UtbWVzc2FnZS5zdWJqZWN0JykgKyAnOicgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTdWJqZWN0IGlkPSB7J21lc3NhZ2Utc3ViamVjdCd9IGtleT17J2tleS1tZXNzYWdlLXN1YmplY3QnfSBvdXRlckNsYXNzPSB7J3N1YmplY3QtaW5wdXQtd3JhcCd9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmTmFtZSA9IHsnc3ViamVjdElucHV0J30gaGFzRm9jdXMgPSB7ICh0aGlzLnByb3BzLm1lc3NhZ2VUeXBlID09PSBlbnVtcy5NZXNzYWdlVHlwZS5JbmJveENvbXBvc2UgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5tZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuV29ya2xpc3RDb21wb3NlIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMubWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLlRlYW1Db21wb3NlKSB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXsnc3ViamVjdC1pbnB1dCd9IG9uQ2hhbmdlPXt0aGlzLmhhbmRsZVN1YmplY3RDaGFuZ2V9IG1heExlbmd0aD17MTIwfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzVmlzaWJsZSA9IHt0aGlzLnByb3BzLmlzT3Blbn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHt0aGlzLm1lc3NhZ2VTdWJqZWN0fSAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nY29tcC1tc2ctYm90dG9tJyByZWY9J21zZ0VkaXRvcic+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdtc2ctZWRpdG9yJyA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8TWVzc2FnZUVkaXRvciAgaHRtbENvbnRlbnQ9e3RoaXMubWVzc2FnZUJvZHl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSB7IHRoaXMubXNnRWRpdG9ySWR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5ID0geydrZXktJyArIHRoaXMubXNnRWRpdG9ySWR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzRm9jdXMgPSB7IG1lc3NhZ2VIZWxwZXIuaGFzRm9jdXModGhpcy5wcm9wcy5tZXNzYWdlVHlwZSkgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9eyB0aGlzLm1zZ0VkaXRvcklkfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZVNhdmVCdXR0b25TdGF0ZT17dGhpcy50b2dnbGVTYXZlQnV0dG9uU3RhdGV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRMYW5ndWFnZT17dGhpcy5wcm9wcy5zZWxlY3RlZExhbmd1YWdlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzVGlueU1DRUxvYWRlZD17dGhpcy5pc1RpbnlNQ0VMb2FkZWR9Lz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdwb3B1cC1oZWFkZXIgY29tcG9zZS1tc2ctaGVhZGVyJz5cclxuICAgICAgICAgICAgICAgICAgICA8aDMgaWQ9J3BvcHVwMlRpdGxlJyBjbGFzc05hbWU9J3NoaWZ0LWxlZnQgY29tcC1tc2ctdGl0bGUnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IG1lc3NhZ2VIZWxwZXIuZ2V0TWVzc2FnZUhlYWRlcih0aGlzLnByb3BzLm1lc3NhZ2VUeXBlKSB9XHJcbiAgICAgICAgICAgICAgICAgICAgPC9oMz5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nc2hpZnQtbGVmdCBjb21wLW1zZy1idXRvbnMnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8R2VuZXJpY0J1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9eyAnbWVzc2FnZV9zZW5kX2J0bicgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PXsna2V5X21lc3NhZ2Vfc2VuZF9idG4nIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17J2J1dHRvbiBwcmltYXJ5IHJvdW5kZWQnfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2xvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2Uuc2VuZC1idXR0b24tdG9vbHRpcCcpIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e2xvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2Uuc2VuZC1idXR0b24nKSB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5pc1NlbmRCdXR0b25EaXNhYmxlZCB8fCB0aGlzLmlzU2hvd1RlYW1MaXN0UG9wdXB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7IHRoaXMubWVzc2FnZVNlbmRWYWxpZGF0aW9uQ2hlY2sodGhpcy5wcm9wcy5tZXNzYWdlVHlwZSk7IH0gfS8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3NoaWZ0LXJpZ2h0IG1pbmltaXplLW1lc3NhZ2UnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSdqYXZhc2NyaXB0OnZvaWQoMCknIGNsYXNzTmFtZT0nbWluaW1pemUtbWVzc2FnZS1saW5rJyBpZD0nbWVzc2FnZS1taW5pbWl6ZSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcuY29tcG9zZS1tZXNzYWdlLm1pbmltaXNlLWljb24tdG9vbHRpcCcpIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25NaW5pbWl6ZX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9J21pbmltaXplLWljb24gbGl0ZSc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2xvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UubWluaW1pc2UtaWNvbi10b29sdGlwJyl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj0namF2YXNjcmlwdDp2b2lkKDApJyBjbGFzc05hbWU9J21heGltaXplLW1lc3NhZ2UtbGluaycgaWQ9J21lc3NhZ2UtbWF4aW1pemUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17bG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dCgnbWVzc2FnaW5nLmNvbXBvc2UtbWVzc2FnZS5tYXhpbWlzZS1pY29uLXRvb2x0aXAnKSB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uTWF4aW1pemV9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdtYXhtaXplLWljb24gbGl0ZSc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2xvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UubWF4aW1pc2UtaWNvbi10b29sdGlwJyl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj0namF2YXNjcmlwdDp2b2lkKDApJyBjbGFzc05hbWU9J2Nsb3NlLW1lc3NhZ2UtbGluaydcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcuY29tcG9zZS1tZXNzYWdlLmNsb3NlLWljb24tdG9vbHRpcCcpIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSdtZXNzYWdlLWNsb3NlJyBvbkNsaWNrPXt0aGlzLm9uTWVzc2FnZUNsb3NlfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0nY2xvc2UtaWNvbiBsaXRlJz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dCgnbWVzc2FnaW5nLmNvbXBvc2UtbWVzc2FnZS5jbG9zZS1pY29uLXRvb2x0aXAnKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb21wb25lbnQgZGlkIG1vdW50XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjb21wb25lbnREaWRNb3VudCgpIHtcclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UuYWRkTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5TRU5EX01FU1NBR0VfU1VDQ0VTU19FVkVOVCwgdGhpcy5yZXNldEFuZENsb3NlTWVzc2FnZVBhbmVsKTtcclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UuYWRkTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5NRVNTQUdFX09QRU5fRVZFTlQsIHRoaXMub25PcGVuKTtcclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UuYWRkTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5NRVNTQUdFX05BVklHQVRFX0VWRU5ULCB0aGlzLm9uTmF2aWdhdGVBd2F5RnJvbUluYm94KTtcclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UuYWRkTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5QT1BVUF9ESVNQTEFZX0VWRU5ULFxyXG4gICAgICAgICAgICB0aGlzLm9uUG9wVXBEaXNwbGF5RXZlbnQpO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2JvdW5kSGFuZGxlT25DbGljayk7XHJcbiAgICAgICAgbWVzc2FnZVN0b3JlLmluc3RhbmNlLmFkZExpc3RlbmVyKG1lc3NhZ2VTdG9yZS5NZXNzYWdlU3RvcmUuTUVTU0FHRV9NSU5JTUlaRV9FVkVOVCwgdGhpcy5vbk1pbmltaXplTWVzc2FnZVBhbmVsKTtcclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UuYWRkTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5NRVNTQUdFX01BWElNSVpFX0VWRU5ULCB0aGlzLm9uTWF4aW1pemVNZXNzYWdlUGFuZWwpO1xyXG4gICAgICAgIG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS5hZGRMaXN0ZW5lcihtZXNzYWdlU3RvcmUuTWVzc2FnZVN0b3JlLk1FU1NBR0VfQ0xPU0VfRVZFTlQsIHRoaXMub25NZXNzYWdlUGFuZWxDbG9zZSk7XHJcbiAgICAgICAgbWVzc2FnZVN0b3JlLmluc3RhbmNlLmFkZExpc3RlbmVyKG1lc3NhZ2VTdG9yZS5NZXNzYWdlU3RvcmUuTUVTU0FHRV9OQVZJR0FUSU9OX0VWRU5ULCB0aGlzLm9uTmF2aWdhdGVGcm9tTWVzc2FnZVBhbmVsKTtcclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UuYWRkTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5VUERBVEVfVEVBTV9MSVNUX1JFQ0VJVkVELCB0aGlzLnVwZGF0ZWRUZWFtTGlzdFJlY2VpdmVkKTtcclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UuYWRkTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5URUFNX0xJU1RfUkVDRUlWRUQsIHRoaXMudGVhbUxpc3RSZWNlaXZlZCk7XHJcbiAgICAgICAgbWVzc2FnZVN0b3JlLmluc3RhbmNlLmFkZExpc3RlbmVyKG1lc3NhZ2VTdG9yZS5NZXNzYWdlU3RvcmUuVVBEQVRFX01FU1NBR0VfUFJJT1JJVFlfRVZFTlQsIHRoaXMubWVzc2FnZVByaW9yaXR5VXBkYXRlKTtcclxuICAgICAgICB0ZWFtTWFuYWdlbWVudFN0b3JlLmluc3RhbmNlLmFkZExpc3RlbmVyXHJcbiAgICAgICAgICAgICh0ZWFtTWFuYWdlbWVudFN0b3JlLlRlYW1NYW5hZ2VtZW50U3RvcmUuQVBQUk9WQUxfTUFOQUdFTUVOVF9BQ1RJT05fRVhFQ1VURUQsIHRoaXMuZXhhbWluZXJWYWxpZGF0aW9uKTtcclxuICAgICAgICBhcHBsaWNhdGlvblN0b3JlLmluc3RhbmNlLmFkZExpc3RlbmVyKGFwcGxpY2F0aW9uU3RvcmUuQXBwbGljYXRpb25TdG9yZS5PTkxJTkVfU1RBVFVTX1VQREFURURfRVZFTlQsIHRoaXMub25PbmxpbmVTdGF0dXNDaGFuZ2VkKTtcclxuICAgICAgICBsb2NhbGVTdG9yZS5pbnN0YW5jZS5hZGRMaXN0ZW5lcihsb2NhbGVTdG9yZS5Mb2NhbGVTdG9yZS5MT0NBTEVfQ0hBTkdFX0VWRU5ULCB0aGlzLmxhbmd1YWdlQ2hhbmdlZCk7XHJcblxyXG4gICAgICAgIC8vIFNldCB0aGUgdmFyaWFibGVzIGZyb20gcHJvcHMuXHJcbiAgICAgICAgaWYgKHRoaXMucHJvcHMubWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLlRlYW1Db21wb3NlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRRaWcgPSB0aGlzLnByb3BzLnNlbGVjdGVkUWlnSXRlbTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFFpZ0l0ZW1JZCA9IHRoaXMucHJvcHMuc2VsZWN0ZWRRaWdJdGVtSWQ7XHJcbiAgICAgICAgICAgIHRoaXMucXVlc3Rpb25QYXBlclBhcnRJZCA9IHRoaXMucHJvcHMucXVlc3Rpb25QYXBlclBhcnRJZDtcclxuICAgICAgICAgICAgdGhpcy5vbk9wZW4oZW51bXMuTWVzc2FnZVR5cGUuVGVhbUNvbXBvc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbXBvbmVudCB3aWxsIHVubW91bnRcclxuICAgICAqL1xyXG4gICAgcHVibGljIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xyXG4gICAgICAgIG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS5yZW1vdmVMaXN0ZW5lcihtZXNzYWdlU3RvcmUuTWVzc2FnZVN0b3JlLlNFTkRfTUVTU0FHRV9TVUNDRVNTX0VWRU5ULCB0aGlzLnJlc2V0QW5kQ2xvc2VNZXNzYWdlUGFuZWwpO1xyXG4gICAgICAgIG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS5yZW1vdmVMaXN0ZW5lcihtZXNzYWdlU3RvcmUuTWVzc2FnZVN0b3JlLk1FU1NBR0VfT1BFTl9FVkVOVCwgdGhpcy5vbk9wZW4pO1xyXG4gICAgICAgIG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS5yZW1vdmVMaXN0ZW5lcihtZXNzYWdlU3RvcmUuTWVzc2FnZVN0b3JlLk1FU1NBR0VfTkFWSUdBVEVfRVZFTlQsIHRoaXMub25OYXZpZ2F0ZUF3YXlGcm9tSW5ib3gpO1xyXG4gICAgICAgIG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS5yZW1vdmVMaXN0ZW5lcihtZXNzYWdlU3RvcmUuTWVzc2FnZVN0b3JlLlBPUFVQX0RJU1BMQVlfRVZFTlQsXHJcbiAgICAgICAgICAgIHRoaXMub25Qb3BVcERpc3BsYXlFdmVudCk7XHJcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fYm91bmRIYW5kbGVPbkNsaWNrKTtcclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UucmVtb3ZlTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5NRVNTQUdFX01JTklNSVpFX0VWRU5ULCB0aGlzLm9uTWluaW1pemVNZXNzYWdlUGFuZWwpO1xyXG4gICAgICAgIG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS5yZW1vdmVMaXN0ZW5lcihtZXNzYWdlU3RvcmUuTWVzc2FnZVN0b3JlLk1FU1NBR0VfTUFYSU1JWkVfRVZFTlQsIHRoaXMub25NYXhpbWl6ZU1lc3NhZ2VQYW5lbCk7XHJcbiAgICAgICAgbWVzc2FnZVN0b3JlLmluc3RhbmNlLnJlbW92ZUxpc3RlbmVyKG1lc3NhZ2VTdG9yZS5NZXNzYWdlU3RvcmUuTUVTU0FHRV9DTE9TRV9FVkVOVCwgdGhpcy5vbk1lc3NhZ2VQYW5lbENsb3NlKTtcclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UucmVtb3ZlTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5NRVNTQUdFX05BVklHQVRJT05fRVZFTlQsIHRoaXMub25OYXZpZ2F0ZUZyb21NZXNzYWdlUGFuZWwpO1xyXG4gICAgICAgIGtleURvd25IZWxwZXIuaW5zdGFuY2UuQWN0aXZhdGUoZW51bXMuTWFya0VudHJ5RGVhY3RpdmF0b3IuTWVzc2FnaW5nKTtcclxuICAgICAgICBpZiAobWVzc2FnZVN0b3JlLmluc3RhbmNlLm1lc3NhZ2VWaWV3QWN0aW9uICE9PSBlbnVtcy5NZXNzYWdlVmlld0FjdGlvbi5Ob25lKSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2luZ0FjdGlvbkNyZWF0b3IubWVzc2FnZUFjdGlvbihlbnVtcy5NZXNzYWdlVmlld0FjdGlvbi5Ob25lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbWVzc2FnZVN0b3JlLmluc3RhbmNlLnJlbW92ZUxpc3RlbmVyKG1lc3NhZ2VTdG9yZS5NZXNzYWdlU3RvcmUuVVBEQVRFX1RFQU1fTElTVF9SRUNFSVZFRCwgdGhpcy51cGRhdGVkVGVhbUxpc3RSZWNlaXZlZCk7XHJcbiAgICAgICAgbWVzc2FnZVN0b3JlLmluc3RhbmNlLnJlbW92ZUxpc3RlbmVyKG1lc3NhZ2VTdG9yZS5NZXNzYWdlU3RvcmUuVEVBTV9MSVNUX1JFQ0VJVkVELCB0aGlzLnRlYW1MaXN0UmVjZWl2ZWQpO1xyXG4gICAgICAgIG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS5yZW1vdmVMaXN0ZW5lcihtZXNzYWdlU3RvcmUuTWVzc2FnZVN0b3JlLlVQREFURV9NRVNTQUdFX1BSSU9SSVRZX0VWRU5ULCB0aGlzLm1lc3NhZ2VQcmlvcml0eVVwZGF0ZSk7XHJcbiAgICAgICAgdGVhbU1hbmFnZW1lbnRTdG9yZS5pbnN0YW5jZS5yZW1vdmVMaXN0ZW5lclxyXG4gICAgICAgICAgICAodGVhbU1hbmFnZW1lbnRTdG9yZS5UZWFtTWFuYWdlbWVudFN0b3JlLkFQUFJPVkFMX01BTkFHRU1FTlRfQUNUSU9OX0VYRUNVVEVELCB0aGlzLmV4YW1pbmVyVmFsaWRhdGlvbik7XHJcbiAgICAgICAgYXBwbGljYXRpb25TdG9yZS5pbnN0YW5jZS5yZW1vdmVMaXN0ZW5lcihhcHBsaWNhdGlvblN0b3JlLkFwcGxpY2F0aW9uU3RvcmUuT05MSU5FX1NUQVRVU19VUERBVEVEX0VWRU5ULCB0aGlzLm9uT25saW5lU3RhdHVzQ2hhbmdlZCk7XHJcbiAgICAgICAgbG9jYWxlU3RvcmUuaW5zdGFuY2UucmVtb3ZlTGlzdGVuZXIobG9jYWxlU3RvcmUuTG9jYWxlU3RvcmUuTE9DQUxFX0NIQU5HRV9FVkVOVCwgdGhpcy5sYW5ndWFnZUNoYW5nZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29tcG9uZW50IHdpbGwgcmVjZWl2ZSBwcm9wc1xyXG4gICAgICogQHBhcmFtIHtQcm9wc30gbmV4dFByb3BzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wczogUHJvcHMpIHtcclxuICAgICAgICAvLyBEZWZlY3QgNDQzOTIgZml4IC0gc2VsZWN0IGEgcWlnIHRleHQgaW4gbWVzc2FnZSBhcmVhIGlzIG5vdCBnZXR0aW5nIGxvY2FsaXplZCB1cG9uIGNoYW5naW5nIGxhbmd1YWdlIFxyXG4gICAgICAgIGlmIChuZXh0UHJvcHMuc2VsZWN0ZWRRaWdJdGVtSWQgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRRaWcgPSBuZXh0UHJvcHMuc2VsZWN0ZWRRaWdJdGVtO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRRaWcgPSBsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcuY29tcG9zZS1tZXNzYWdlLnNlbGVjdC1xaWctcGxhY2Vob2xkZXInKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZFFpZ0l0ZW1JZCA9IG5leHRQcm9wcy5zZWxlY3RlZFFpZ0l0ZW1JZDtcclxuICAgICAgICB0aGlzLnF1ZXN0aW9uUGFwZXJQYXJ0SWQgPSBuZXh0UHJvcHMucXVlc3Rpb25QYXBlclBhcnRJZDtcclxuXHJcbiAgICAgICAgLy8gdG8gY2xvc2UgdGVhbWxpc3QgcG9wdXAgd2hpbGUgb3BlbmluZyBuZXcgbWVzc2FnZVxyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkUWlnSXRlbUlkID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNTaG93VGVhbUxpc3RQb3B1cCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldCBJbmJveCBGb3J3YXJkIGFuZCBSZXBsYXkgTWVzc2FnZSBkZXRhaWxzXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgc2V0SW5ib3hGb3J3YXJkUmVwbHlNZXNzYWdlRGV0YWlscygpOiB2b2lkIHtcclxuICAgICAgICBrZXlEb3duSGVscGVyLmluc3RhbmNlLkRlQWN0aXZhdGUoZW51bXMuTWFya0VudHJ5RGVhY3RpdmF0b3IuTWVzc2FnaW5nKTtcclxuXHJcbiAgICAgICAgLy8gc2V0IG1lc3NhZ2VTdWJqZWN0IGZvciByZXBseSBhbmQgZm9yd2FyZCBtZXNzYWdlc1xyXG4gICAgICAgIGlmICgodGhpcy5wcm9wcy5tZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hGb3J3YXJkIHx8IHRoaXMucHJvcHMubWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLkluYm94UmVwbHkpXHJcbiAgICAgICAgICAgICYmIHRoaXMucHJvcHMuaXNSZXBseU9yRm9yd2FyZENsaWNrZWQgJiYgdGhpcy5wcm9wcy5zZWxlY3RlZE1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgLy8gcmVzZXQgaXNNZXNzYWdlUG9wdXBNaW5pbWl6ZWQgdmFyaWFibGVcclxuICAgICAgICAgICAgdGhpcy5pc01lc3NhZ2VQb3B1cE1pbmltaXplZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VTdWJqZWN0ID0gbWVzc2FnZUhlbHBlci5nZXRTdWJqZWN0Q29udGVudCh0aGlzLnByb3BzLm1lc3NhZ2VUeXBlLCB0aGlzLnByb3BzLnN1YmplY3QgKTtcclxuICAgICAgICAgICAgdGhpcy5wcmlvcml0eURyb3BEb3duU2VsZWN0ZWRJdGVtID0gdGhpcy5wcm9wcy5wcmlvcml0eURyb3BEb3duU2VsZWN0ZWRJdGVtO1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VCb2R5ID0gdGhpcy5wcm9wcy5tZXNzYWdlQm9keTtcclxuXHJcbiAgICAgICAgICAgIGxldCBxaWdJZDogbnVtYmVyID0gdGhpcy5wcm9wcy5zZWxlY3RlZFFpZ0l0ZW1JZDtcclxuICAgICAgICAgICAgbGV0IGV4YW1pbmVyUm9sZUlkOiBudW1iZXIgPSB0aGlzLnByb3BzLnFpZ0l0ZW1zTGlzdC5maWx0ZXIoKHg6IEl0ZW0pID0+IHguaWQgPT09IHFpZ0lkKVswXS5leGFtaW5lclJvbGVJZDtcclxuXHJcbiAgICAgICAgICAgIGxldCBhcmdzOiB0ZWFtQXJndW1lbnQgPSB7XHJcbiAgICAgICAgICAgICAgICBleGFtaW5lclJvbGVJZDogZXhhbWluZXJSb2xlSWQsXHJcbiAgICAgICAgICAgICAgICBxaWdJZDogcWlnSWRcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIC8vIGdldCB0aGUgdGVhbWRldGFpbHMgdG8gZmluZCB3aGV0aGVyIGF0bGVhc3Qgb25lIHN1Ym9yZGluYXRlIGlzXHJcbiAgICAgICAgICAgIC8vIHNlbGVjdGVkKGZvciBkaXNwbGF5aW5nIG1hbmRhdG9yeSBwcmlvcml0eSBvcHRpb25zKVxyXG4gICAgICAgICAgICBtZXNzYWdpbmdBY3Rpb25DcmVhdG9yLmdldFRlYW1EZXRhaWxzKGFyZ3MpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbXBvbmVudCBkaWQgdXBkYXRlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjb21wb25lbnREaWRVcGRhdGUoKSB7XHJcblxyXG4gICAgICAgIC8vIGVuYWJsZSBvciBkaXNhYmxlIHNlbmQgYnV0dG9uIHdoaWxlIGNoYW5naW5nIFFJRyBkcm9wZG93blxyXG4gICAgICAgIGlmICh0aGlzLnByb3BzLmlzT3Blbikge1xyXG4gICAgICAgICAgICB0aGlzLmVuYWJsZURpc2FibGVTZW5kQnV0dG9uKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kb1RyaWdnZXJNZXNzYWdlT3BlbkV2ZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZG9UcmlnZ2VyTWVzc2FnZU9wZW5FdmVudCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLm9uT3Blbih0aGlzLm1zZ1R5cGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgcmVuZGVyIFFJRyBzZWN0aW9uIGZvciBDb21wb3NlLCBSZXBseSBhbmQgRm9yd2FyZCBtZXNzYWdlIHR5cGVzXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVuZGVyUWlnU2VjdGlvbiA9ICgpID0+IHtcclxuICAgICAgICBzd2l0Y2ggKHRoaXMucHJvcHMubWVzc2FnZVR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5NZXNzYWdlVHlwZS5JbmJveENvbXBvc2U6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKDxkaXYgY2xhc3NOYW1lPSdtZXNzYWdlLXFpZyc+XHJcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdkaW0tdGV4dCBtc2ctcWlnLWxhYmVsJyBpZD0ncWlnLWRyb3Bkb3duLWxhYmVsJz5cclxuICAgICAgICAgICAgICAgICAgICAgICAge2xvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UucXVlc3Rpb24tZ3JvdXAnKSArICc6J31cclxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgPFFpZ0Ryb3BEb3duIGRyb3BEb3duVHlwZSA9IHtlbnVtcy5Ecm9wRG93blR5cGUuUUlHfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZCA9IHsnc2VsZWN0X3FpZyd9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlID0ge3RoaXMuc3RhdGUucWlnRHJvcERvd25TdHlsZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lID0geydkcm9wZG93bi13cmFwIG1lc3NhZ2UtcWlnLW5hbWUnfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEl0ZW0gPSB7IHRoaXMuc2VsZWN0ZWRRaWcgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc09wZW4gPSB7dGhpcy5jbGlja2VkRHJvcERvd24gPT09IGVudW1zLkRyb3BEb3duVHlwZS5RSUcgPyB0aGlzLmlzUWlnRHJvcERvd25PcGVuIDogdW5kZWZpbmVkIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXMgPSB7dGhpcy5wcm9wcy5xaWdJdGVtc0xpc3R9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2sgPSB7IHRoaXMub25RaWdEcm9wRG93bkNsaWNrIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25TZWxlY3Q9e3RoaXMub25RaWdJdGVtU2VsZWN0ZWR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcuY29tcG9zZS1tZXNzYWdlLnF1ZXN0aW9uLWdyb3VwLXRvb2x0aXAnKX0gLz5cclxuICAgICAgICAgICAgICAgIDwvZGl2Pik7XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hGb3J3YXJkOlxyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLkluYm94UmVwbHk6XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZVR5cGUuV29ya2xpc3RDb21wb3NlOlxyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLlRlYW1Db21wb3NlOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICg8ZGl2IGNsYXNzTmFtZT0nbWVzc2FnZS1xaWcnPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0nZGltLXRleHQgbXNnLXFpZy1sYWJlbCcgaWQ9J3F1ZXN0aW9uLWdyb3VwLXRleHQnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGxvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UucXVlc3Rpb24tZ3JvdXAnKSArICc6JyB9XHJcbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdtZXNzYWdlLXFpZy1uYW1lJyBpZD0nc2VsZWN0ZWQtcWlnLW5hbWUnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5zZWxlY3RlZFFpZyB9XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj4pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCB3aWxsIHJldHVybiBhc3NvY2l0YXRlZCByZXNwb25zZSBzZWN0aW9uIGZvciBGb3J3YXJkIGFuZCBSZXBseSBtZXNzYWdlIHR5cGVzXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcmVuZGVyQXNzb2NpYXRlZFJlc3BvbnNlU2VjdGlvbiA9ICgpID0+IHtcclxuICAgICAgICBpZiAoKHRoaXMucHJvcHMubWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLkluYm94Rm9yd2FyZCB8fCB0aGlzLnByb3BzLm1lc3NhZ2VUeXBlID09PSBlbnVtcy5NZXNzYWdlVHlwZS5JbmJveFJlcGx5KVxyXG4gICAgICAgICAgICAmJiAodGhpcy5wcm9wcy5yZXNwb25zZUlkICE9IG51bGwgJiYgdGhpcy5wcm9wcy5yZXNwb25zZUlkICE9PSAnJyAmJiB0aGlzLnByb3BzLnJlc3BvbnNlSWQgIT09IHVuZGVmaW5lZCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuICg8ZGl2IGNsYXNzTmFtZT0nY2xlYXJmaXggcGFkZGluZy1ib3R0b20tMTAnPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2NvbXAtcmVzcC1pZCBzaGlmdC1sZWZ0Jz5cclxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9J2RpbS10ZXh0JyBpZD0nYXNzb2NpYXRlZC1yZXNwb25zZS10ZXh0Jz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcuY29tcG9zZS1tZXNzYWdlLmFzc29jaWF0ZWQtcmVzcG9uc2UnKSArICc6JyB9XHJcbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdtZXNzYWdlLXJlc29uc2UtaWQnIGlkPSdhc3NvY2lhdGVkLXJlc3BvbnNlLWlkJz5cclxuICAgICAgICAgICAgICAgICAgICAgICAge21lc3NhZ2VIZWxwZXIuZ2V0TWFya2luZ01vZGVUZXh0KHRoaXMucHJvcHMuc2VsZWN0ZWRNc2dEZXRhaWxzLm1hcmtpbmdNb2RlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnNlbGVjdGVkTXNnRGV0YWlscy5pc0VsZWN0cm9uaWNTdGFuZGFyZGlzYXRpb25UZWFtTWVtYmVyKSArIHRoaXMucHJvcHMucmVzcG9uc2VJZH1cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj4pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCB3aWxsIGNhbGwgb24gcWlnIGRyb3Bkb3duIHNlbGVjdFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uUWlnSXRlbVNlbGVjdGVkID0gKHNlbGVjdGVkSXRlbTogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgLy8gcmVzZXR0aW5nIHRvIHN0YW5kYXJkIG1lc3NhZ2UgcHJpb3JpdHkgd2hpbGUgcWlnIHNlbGVjdGVkXHJcbiAgICAgICAgdGhpcy5wcmlvcml0eURyb3BEb3duU2VsZWN0ZWRJdGVtID0gZW51bXMuTWVzc2FnZVByaW9yaXR5LlN0YW5kYXJkO1xyXG4gICAgICAgIHRoaXMucHJvcHMub25RaWdJdGVtU2VsZWN0ZWQoc2VsZWN0ZWRJdGVtKTtcclxuICAgICAgICBsZXQgc2VsZWN0ZWRRaWdJdGVtID0gdGhpcy5wcm9wcy5xaWdJdGVtc0xpc3QuZmlsdGVyKCh4OiBJdGVtKSA9PiB4LmlkID09PSBzZWxlY3RlZEl0ZW0pO1xyXG4gICAgICAgIGxldCBxaWdJZDogbnVtYmVyID0gc2VsZWN0ZWRJdGVtO1xyXG4gICAgICAgIGxldCBleGFtaW5lclJvbGVJZDogbnVtYmVyID0gc2VsZWN0ZWRRaWdJdGVtWzBdLmV4YW1pbmVyUm9sZUlkO1xyXG4gICAgICAgIGxldCBhcmdzOiB0ZWFtQXJndW1lbnQgPSB7XHJcbiAgICAgICAgICAgIGV4YW1pbmVyUm9sZUlkOiBleGFtaW5lclJvbGVJZCxcclxuICAgICAgICAgICAgcWlnSWQ6IHFpZ0lkXHJcbiAgICAgICAgfTtcclxuICAgICAgICBtZXNzYWdpbmdBY3Rpb25DcmVhdG9yLmdldFRlYW1EZXRhaWxzKGFyZ3MpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIE9uIG5hdmlnYXRlIGF3YXkgZnJvbSBpbmJveFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uTmF2aWdhdGVBd2F5RnJvbUluYm94ID0gKG5hdmlnYXRlVG86IGVudW1zLlNhdmVBbmROYXZpZ2F0ZSkgPT4ge1xyXG4gICAgICAgIGlmICgobmF2aWdhdGVUbyA9PT0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLnRvUmVwbHlNZXNzYWdlIHx8IG5hdmlnYXRlVG8gPT09IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS50b0ZvcndhcmRNZXNzYWdlIHx8XHJcbiAgICAgICAgICAgIG5hdmlnYXRlVG8gPT09IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5uZXdNZXNzYWdlQnV0dG9uQ2xpY2spXHJcbiAgICAgICAgICAgICYmICFtZXNzYWdlSGVscGVyLmlzTWVzc2FnZVBhbmVsRWRpdGVkKHRoaXMucHJvcHMubWVzc2FnZVR5cGUsIHRoaXMudG9GaWVsZFZhbHVlcywgdGhpcy50b0ZpZWxkSWRzKSkge1xyXG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uUmVzZXRQb3B1cENhbGxiYWNrKG5hdmlnYXRlVG8pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMub25OYXZpZ2F0ZUF3YXlGcm9tUmVzcG9uc2UobmF2aWdhdGVUbyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqICBUaGlzIHdpbGwgc2V0IHRoZSByZXF1aXJlZCB2YXJpYWJsZXNcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBvbk9wZW4gPSAobWVzc2FnZVR5cGU6IGVudW1zLk1lc3NhZ2VUeXBlKSA9PiB7XHJcbiAgICAgICAgLy8gaWYgdGlueW1jZSBpcyBub3QgbG9hZGVkIHdlIG5lZWQgdG8gc2tpcCB0aGlzIG1ldGhvZCBhbmQgcmV0cmlnZ2VyIHRoaXMgYWZ0ZXIgZWRpdG9yIGlzIGxvYWRlZFxyXG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5pc1RpbnlNQ0VMb2FkZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5kb1RyaWdnZXJNZXNzYWdlT3BlbkV2ZW50ID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5tc2dUeXBlID0gbWVzc2FnZVR5cGU7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGlmIG1lc3NhZ2UgdHlwZSBpcyBpbmJveCBjb21wb3NlIG9yIHdvcmtsaXN0IGNvbXBvc2UgdGhlbiBzZXQgdGhlIGRlZmF1bHQgY29udGVudCBmb3Igc2V0dGluZyBkZWZhdWx0IGZvbnRzXHJcbiAgICAgICAgaWYgKG1lc3NhZ2VUeXBlID09PSBlbnVtcy5NZXNzYWdlVHlwZS5JbmJveENvbXBvc2UgfHwgbWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLldvcmtsaXN0Q29tcG9zZSB8fFxyXG4gICAgICAgICAgICBtZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuVGVhbUNvbXBvc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQm9keSA9IG1lc3NhZ2VIZWxwZXIuZ2V0TWVzc2FnZUNvbnRlbnQobWVzc2FnZVR5cGUpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc01lc3NhZ2VQb3B1cE1pbmltaXplZCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbk1heGltaXplTWVzc2FnZVBhbmVsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGlmIG1lc3NhZ2UgdHlwZSBpcyB3b3JrIGxpc3QgY29tcG9zZSB0aGVuIHNldCBzdXBlcnZpc2lvciBkZXRhaWxzIGluIHRvIGFkZHJlc3MgZmllbGRzLlxyXG4gICAgICAgIGlmIChtZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuV29ya2xpc3RDb21wb3NlIHx8IG1lc3NhZ2VUeXBlID09PSBlbnVtcy5NZXNzYWdlVHlwZS5UZWFtQ29tcG9zZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RlZFRlYW1MaXN0ID0gbmV3IEFycmF5PHN0cmluZz4oKTtcclxuICAgICAgICAgICAgdGhpcy50b0ZpZWxkSWRzID0gbmV3IEFycmF5PG51bWJlcj4oKTtcclxuICAgICAgICAgICAgdGhpcy50b0ZpZWxkVmFsdWVzID0gbmV3IEFycmF5PHN0cmluZz4oKTtcclxuICAgICAgICAgICAgdGhpcy50b0ZpZWxkSWRzLnB1c2godGhpcy5wcm9wcy5zdXBlcnZpc29ySWQpO1xyXG4gICAgICAgICAgICB0aGlzLnRvRmllbGRWYWx1ZXMucHVzaCh0aGlzLnByb3BzLnN1cGVydmlzb3JOYW1lKTtcclxuICAgICAgICAgICAgdGhpcy5fc2VsZWN0ZWRUZWFtTGlzdC5wdXNoKHRoaXMucHJvcHMuc3VwZXJ2aXNvck5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBGaXggZm9yIGRlZmVjdCA1NDI3Ni4gUmVwbHkgZm9yd2FyZCBtZXNzYWdlIGRldGFpbHMgaGFzIHRvIGJlIHNldCBvbmx5IG9uY2UuIFxyXG4gICAgICAgIGlmIChtZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hSZXBseSB8fCBtZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hGb3J3YXJkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0SW5ib3hGb3J3YXJkUmVwbHlNZXNzYWdlRGV0YWlscygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRml4IGZvciBkZWZlY3QgNTQyNzYuIFJlcGx5IGZvcndhcmQgbWVzc2FnZSBkZXRhaWxzIGhhcyB0byBiZSBzZXQgb25seSBvbmNlLiBcclxuICAgICAgICBpZiAobWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLkluYm94UmVwbHkgfHwgbWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLkluYm94Rm9yd2FyZCkge1xyXG4gICAgICAgICAgICB0aGlzLnNldEluYm94Rm9yd2FyZFJlcGx5TWVzc2FnZURldGFpbHMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEZpeCBmb3IgZGVmZWN0IDU0Mjc2LiBSZXBseSBmb3J3YXJkIG1lc3NhZ2UgZGV0YWlscyBoYXMgdG8gYmUgc2V0IG9ubHkgb25jZS4gXHJcbiAgICAgICAgaWYgKG1lc3NhZ2VUeXBlID09PSBlbnVtcy5NZXNzYWdlVHlwZS5JbmJveFJlcGx5IHx8IG1lc3NhZ2VUeXBlID09PSBlbnVtcy5NZXNzYWdlVHlwZS5JbmJveEZvcndhcmQpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRJbmJveEZvcndhcmRSZXBseU1lc3NhZ2VEZXRhaWxzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgcmVuZGVyZWRPbjogRGF0ZS5ub3coKSB9KTtcclxuICAgICAgICAvLyBlbmFibGUgc2VuZCBidXR0b25cclxuICAgICAgICB0aGlzLmVuYWJsZURpc2FibGVTZW5kQnV0dG9uKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWV0aG9kIGZpcmVkIHRvIG1pbmltaXplIHRoZSBtZXNzYWdlIHBhbmVsLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uTWluaW1pemVNZXNzYWdlUGFuZWwgPSAoKSA9PiB7XHJcbiAgICAgICAgLy8gYWRkZWQgYXMgcGFydCBvZiBkZWZlY3QgIzI5MjY5XHJcbiAgICAgICAgaWYgKGh0bWxVdGlsaXRpZXMuaXNJUGFkRGV2aWNlKSB7XHJcbiAgICAgICAgICAgIGh0bWxVdGlsaXRpZXMuc2V0Rm9jdXNUb0VsZW1lbnQoJ21lc3NhZ2Utc3ViamVjdCcpO1xyXG4gICAgICAgICAgICBodG1sVXRpbGl0aWVzLmJsdXJFbGVtZW50KCdtZXNzYWdlLXN1YmplY3QnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc01lc3NhZ2VQb3B1cE1pbmltaXplZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHJlbmRlcmVkT246IERhdGUubm93KCkgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWV0aG9kIGZpcmVkIHRvIG1heGltaXplIHRoZSBtZXNzYWdlIHBhbmVsLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uTWF4aW1pemVNZXNzYWdlUGFuZWwgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5pc01lc3NhZ2VQb3B1cE1pbmltaXplZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyByZW5kZXJlZE9uOiBEYXRlLm5vdygpIH0pO1xyXG4gICAgICAgIC8vIGVuYWJsZSBzZW5kIGJ1dHRvblxyXG4gICAgICAgIHRoaXMuZW5hYmxlRGlzYWJsZVNlbmRCdXR0b24oKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNZXRob2QgZmlyZWQgdG8gY2xvc2UgdGhlIG1lc3NhZ2UgcGFuZWwuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgb25NZXNzYWdlUGFuZWxDbG9zZSA9ICgpID0+IHtcclxuICAgICAgICBrZXlEb3duSGVscGVyLmluc3RhbmNlLkFjdGl2YXRlKGVudW1zLk1hcmtFbnRyeURlYWN0aXZhdG9yLk1lc3NhZ2luZyk7XHJcbiAgICAgICAgdGhpcy5pc01lc3NhZ2VQb3B1cE1pbmltaXplZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZVN1YmplY3QgPSAnJztcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRRaWdJdGVtSWQgJiYgdGhpcy5zZWxlY3RlZFFpZ0l0ZW1JZCAhPT0gMCkge1xyXG4gICAgICAgICAgICBsZXQgc2VsZWN0ZWRRaWdJdGVtID0gdGhpcy5wcm9wcy5xaWdJdGVtc0xpc3QuZmlsdGVyKCh4OiBJdGVtKSA9PiB4LmlkID09PSB0aGlzLnNlbGVjdGVkUWlnSXRlbUlkKTtcclxuICAgICAgICAgICAgaWYgKHNlbGVjdGVkUWlnSXRlbSAmJiBzZWxlY3RlZFFpZ0l0ZW0ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHFpZ0lkOiBudW1iZXIgPSB0aGlzLnNlbGVjdGVkUWlnSXRlbUlkO1xyXG4gICAgICAgICAgICAgICAgbGV0IGV4YW1pbmVyUm9sZUlkOiBudW1iZXIgPSBzZWxlY3RlZFFpZ0l0ZW1bMF0uZXhhbWluZXJSb2xlSWQ7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdpbmdBY3Rpb25DcmVhdG9yLmNsZWFyVGVhbVNlbGVjdGlvbihleGFtaW5lclJvbGVJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc2VsZWN0ZWRUZWFtTGlzdCA9IG5ldyBBcnJheTxzdHJpbmc+KCk7XHJcbiAgICAgICAgdGhpcy5faXNFbnRpcmVUZWFtU2VsZWN0ZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRGVmZWN0IDY0NTQyIGZpeDogc2V0dGluZyBpc1Nob3dUZWFtTGlzdFBvcHVwIHRvIGZhbHNlIHRvIHByZXZlbnQgVGVhbUxpc3QgUG9wdXAgZnJvbSBwZXJzaXN0aW5nIFxyXG4gICAgICAgICAqIHdoZW4gY2xvc2luZyBhbmQgb3BlbmluZyBhIG5ldyBtZXNzYWdlIHdpdGggb25seSAxIFFJRyBpdGVtXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5pc1Nob3dUZWFtTGlzdFBvcHVwID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHJlbmRlcmVkT246IERhdGUubm93KCkgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBtZXRob2QgaXMgaGFuZGxpbmcgdGhlIGxldGlvdXMgcG9wdXAgZXZlbnRzLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uUG9wVXBEaXNwbGF5RXZlbnQgPSAocG9wVXBUeXBlOiBlbnVtcy5Qb3BVcFR5cGUsIHBvcFVwQWN0aW9uVHlwZTogZW51bXMuUG9wVXBBY3Rpb25UeXBlKSA9PiB7XHJcbiAgICAgICAgc3dpdGNoIChwb3BVcFR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5Qb3BVcFR5cGUuRGlzY2FyZE1lc3NhZ2U6XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuUG9wVXBUeXBlLkRpc2NhcmRNZXNzYWdlTmF2aWdhdGVBd2F5OlxyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChwb3BVcEFjdGlvblR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIGVudW1zLlBvcFVwQWN0aW9uVHlwZS5ZZXM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwSGVscGVyLmhhbmRsZVBvcFVwRXZlbnRzKHBvcFVwVHlwZSwgcG9wVXBBY3Rpb25UeXBlLCB0aGlzLm9uRGlzY2FyZE1lc3NhZ2VDb25maXJtZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIGVudW1zLlBvcFVwQWN0aW9uVHlwZS5ObzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBIZWxwZXIuaGFuZGxlUG9wVXBFdmVudHMocG9wVXBUeXBlLCBwb3BVcEFjdGlvblR5cGUsIHRoaXMub25EaXNjYXJkTWVzc2FnZUNhbmNlbGxlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuUG9wVXBUeXBlLkRpc2NhcmRPbk5ld01lc3NhZ2VCdXR0b25DbGljazpcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAocG9wVXBBY3Rpb25UeXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBlbnVtcy5Qb3BVcEFjdGlvblR5cGUuU2hvdzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc01lc3NhZ2VQb3B1cE1pbmltaXplZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgcmVuZGVyZWRPbjogRGF0ZS5ub3coKSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBlbnVtcy5Qb3BVcEFjdGlvblR5cGUuWWVzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3B1cEhlbHBlci5oYW5kbGVQb3BVcEV2ZW50cyhwb3BVcFR5cGUsIHBvcFVwQWN0aW9uVHlwZSwgdGhpcy5vbkRpc2NhcmROZXdQb3B1cENvbmZpcm1lZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgZW51bXMuUG9wVXBBY3Rpb25UeXBlLk5vOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1Jlc2V0IHRoZSBuYXZpZ2F0ZSB0byB2YXJpYWJsZSB3aGVuIHRoZSB1c2VyIGNob29zZXMgdG8gc3RheSBvbiB0aGUgbWVzc2FnZSBwYW5lbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlVG8gPSBlbnVtcy5TYXZlQW5kTmF2aWdhdGUubm9uZTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHByaXZhdGUgb25EaXNjYXJkTmV3UG9wdXBDb25maXJtZWQgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMubmF2aWdhdGVUbyA9PT0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLm5ld01lc3NhZ2VCdXR0b25DbGljaykge1xyXG4gICAgICAgICAgICB0aGlzLnByaW9yaXR5RHJvcERvd25TZWxlY3RlZEl0ZW0gPSBlbnVtcy5NZXNzYWdlUHJpb3JpdHkuU3RhbmRhcmQ7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZVN1YmplY3QgPSAnJztcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQm9keSA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLmlzRHJvcERvd25PcGVuID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB0aGlzLmlzUWlnRHJvcERvd25PcGVuID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB0aGlzLnRvRmllbGRWYWx1ZXMgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLnRvRmllbGRJZHMgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RlZFRlYW1MaXN0ID0gbmV3IEFycmF5PHN0cmluZz4oKTtcclxuICAgICAgICAgICAgdGhpcy5faXNFbnRpcmVUZWFtU2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGlueW1jZS5hY3RpdmVFZGl0b3Iuc2V0Q29udGVudCgnJyk7XHJcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlRGlzYWJsZVNlbmRCdXR0b24oKTtcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5vblJlc2V0UG9wdXBDYWxsYmFjayh0aGlzLm5hdmlnYXRlVG8pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJvcHMub25SZXNldFBvcHVwQ2FsbGJhY2sodGhpcy5uYXZpZ2F0ZVRvKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5uYXZpZ2F0ZVRvID0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLm5vbmU7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogIENhbGxiYWNrIGZ1bmN0aW9uIGZvciBkcm9wZG93biBjbGlja1xyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uUWlnRHJvcERvd25DbGljayA9IChkcm9wRG93bjogZW51bXMuRHJvcERvd25UeXBlLCB3aWR0aDogbnVtYmVyKTogdm9pZCA9PiB7XHJcbiAgICAgICAgaWYgKHdpZHRoKSB7XHJcbiAgICAgICAgICAgIGxldCBzdHlsZTogUmVhY3QuQ1NTUHJvcGVydGllcyA9IHt9O1xyXG4gICAgICAgICAgICBzdHlsZS5taW5XaWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgIHFpZ0Ryb3BEb3duU3R5bGU6IHN0eWxlXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm9uRHJvcERvd25DbGljayhkcm9wRG93bik7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVG8gYXZvaWQgdGhlIHFpZ3MgaW4gd2hpY2ggdGhlIHNlbGVjdGVkIGV4YW1pbmVyIGhhcyBubyBzdXBlcnZpc29yXHJcbiAgICAgKiBAcGFyYW0ge0FycmF5PEl0ZW0+fSBxaWdJdGVtc0xpc3RcclxuICAgICAqIEByZXR1cm5zXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZmlsdGVyUWlnSXRlbXMocWlnSXRlbXNMaXN0OiBBcnJheTxJdGVtPik6IEFycmF5PEl0ZW0+IHtcclxuICAgICAgICByZXR1cm4gcWlnSXRlbXNMaXN0LmZpbHRlcigoeDogSXRlbSkgPT4geC5wYXJlbnRFeGFtaW5lcklkICE9PSAwKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRvIHNob3cgbWFkYXRvcnkgbWVzc2FnZSBwcmlvcml0eSBvcHRpb24gaW4gZHJvcGRvd25cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBkb1Nob3dNYW5kYXRvcnlNZXNzYWdlUHJpb3JpdHkoKTogYm9vbGVhbiB7XHJcblxyXG4gICAgICAgIGxldCBpc01hbmRhdG9yeVByaW9yaXR5QXZhaWxhYmxlOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gICAgICAgIC8vIE1hbmRhdG9yeSBNZXNzYWdlIFByaW9yaXR5IGlzIGF2YWlsYWJpbGl0eSBvbmx5IGlmIDpcclxuICAgICAgICAvLyAxLiBJdCBpcyBhIFRlYW1Db21wb3NlIGFzIFRlYW1Db21wb3NlIGlzIGFsd2F5cyB0byBzdWJvcmRpbmF0ZXMuIE9SXHJcbiAgICAgICAgLy8gMi4gSWYgbm90IFdvcmtsaXN0Q29tcG9zZSBhcyBXb3JrbGlzdENvbXBvc2Ugd2lsbCBiZSBhbHdheXMgdG8gU3VwZXJ2aXNvci4gQU5EXHJcbiAgICAgICAgLy8gICAgICAoaSkuW1FJRyBpcyBub3Qgc2VsZWN0ZWQuXSBPUlxyXG4gICAgICAgIC8vICAgICAgKGlpKS5bSWYgUUlHIGlzIHNlbGVjdGVkIEFORCB0aGVyZSBhcmUgbm8gc2VsZWN0ZWQgZXhhbWluZXJzLl0gT1JcclxuICAgICAgICAvLyAgICAgIChpaWkpLltJZiBRSUcgaXMgc2VsZWN0ZWQgQU5EIHRoZXJlIGFyZSBzZWxlY3RlZCBleGFtaW5lcnMgQU5EIGF0bGVhc3Qgb25lIHN1Ym9yZGluYXRlIGlzIHNlbGVjdGVkLl1cclxuICAgICAgICAvLyBQUyA6IFJlc3BvbnNlQ29tcG9zZSBTY2VuYXJpb3MgYXJlIGhhbmRsZWQgaW4gbWVzc2FnZS50c3hcclxuXHJcbiAgICAgICAgaWYgKHRoaXMucHJvcHMubWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLlRlYW1Db21wb3NlIHx8XHJcbiAgICAgICAgICAgICh0aGlzLnByb3BzLm1lc3NhZ2VUeXBlICE9PSBlbnVtcy5NZXNzYWdlVHlwZS5Xb3JrbGlzdENvbXBvc2UgJiZcclxuICAgICAgICAgICAgICAodGhpcy5zZWxlY3RlZFFpZ0l0ZW1JZCA9PT0gMCB8fFxyXG4gICAgICAgICAgICAgICh0aGlzLnNlbGVjdGVkUWlnSXRlbUlkID4gMCAmJiB0aGlzLl9zZWxlY3RlZFRlYW1MaXN0ICYmIHRoaXMuX3NlbGVjdGVkVGVhbUxpc3QubGVuZ3RoID09PSAwKSB8fFxyXG4gICAgICAgICAgICAgICh0aGlzLnNlbGVjdGVkUWlnSXRlbUlkID4gMCAmJiB0aGlzLl9zZWxlY3RlZFRlYW1MaXN0ICYmIHRoaXMuX3NlbGVjdGVkVGVhbUxpc3QubGVuZ3RoID4gMCAmJiB0aGlzLmlzU3Vib3JkaW5hdGVTZWxlY3RlZCkpKSkge1xyXG5cclxuICAgICAgICAgICAgaXNNYW5kYXRvcnlQcmlvcml0eUF2YWlsYWJsZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5wcm9wcy5xaWdJdGVtc0xpc3QubGVuZ3RoID4gMCAmJiB0aGlzLnNlbGVjdGVkUWlnSXRlbUlkID4gMCkge1xyXG5cclxuICAgICAgICAgICAgbGV0IHNlbGVjdGVkUWlnID0gdGhpcy5wcm9wcy5xaWdJdGVtc0xpc3QuZmlsdGVyKCh4OiBJdGVtKSA9PiB4LmlkID09PSB0aGlzLnNlbGVjdGVkUWlnSXRlbUlkKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50RXhhbWluZXJBcHByb3ZhbFN0YXR1czogZW51bXMuRXhhbWluZXJBcHByb3ZhbCA9IHNlbGVjdGVkUWlnWzBdLmFwcHJvdmFsU3RhdHVzSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoY3VycmVudEV4YW1pbmVyQXBwcm92YWxTdGF0dXMgPT09IGVudW1zLkV4YW1pbmVyQXBwcm92YWwuTm90QXBwcm92ZWQgfHxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRFeGFtaW5lckFwcHJvdmFsU3RhdHVzID09PSBlbnVtcy5FeGFtaW5lckFwcHJvdmFsLlN1c3BlbmRlZCkge1xyXG5cclxuICAgICAgICAgICAgICAgIGlzTWFuZGF0b3J5UHJpb3JpdHlBdmFpbGFibGUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9tYW5kYXRvcnlNZXNzYWdlc0Zyb21NYXJraW5nVG9vbENDICYmIGlzTWFuZGF0b3J5UHJpb3JpdHlBdmFpbGFibGU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBzaG93IG9yIGhpZGUgJ1RvJyBidXR0b25cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBkb0hpZGVUb0J1dHRvbigpOiBib29sZWFuIHtcclxuICAgICAgICBsZXQgX3N1Ym9yZGluYXRlczogQXJyYXk8RXhhbWluZXJJbmZvPiA9IG51bGw7XHJcbiAgICAgICAgaWYgKG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscyAmJlxyXG4gICAgICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UudGVhbURldGFpbHMudGVhbSAmJlxyXG4gICAgICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UudGVhbURldGFpbHMudGVhbS5zdWJvcmRpbmF0ZXMpIHtcclxuICAgICAgICAgICAgX3N1Ym9yZGluYXRlcyA9IG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscy50ZWFtLnN1Ym9yZGluYXRlcztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICgoX3N1Ym9yZGluYXRlcyAmJiBfc3Vib3JkaW5hdGVzLmxlbmd0aCkgPT09IDAgfHxcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5tZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hSZXBseSB8fFxyXG4gICAgICAgICAgICB0aGlzLnByb3BzLm1lc3NhZ2VUeXBlID09PSBlbnVtcy5NZXNzYWdlVHlwZS5Xb3JrbGlzdENvbXBvc2UgfHxcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5tZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuVGVhbUNvbXBvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2hvd1RvQWRkcmVzc0xpc3QgPSAoKTogdm9pZCA9PiB7XHJcbiAgICAgICAgdGhpcy5pc1Nob3dUZWFtTGlzdFBvcHVwID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgcmVuZGVyZWRPbjogRGF0ZS5ub3coKSB9KTtcclxuICAgIH07XHJcblxyXG4gICAgcHJpdmF0ZSBoaWRlVG9BZGRyZXNzTGlzdCA9ICgpOiB2b2lkID0+IHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgaXNzaG93VG9BZGRyZXNzTGlzdDogZmFsc2UgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHByaXZhdGUgc2F2ZVRvQWRkcmVzc0xpc3QgPSAoKTogdm9pZCA9PiB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzc2hvd1RvQWRkcmVzc0xpc3Q6IGZhbHNlIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEhhbmRsZXMgdGhlIGFjdGlvbiBldmVudCBvbiB0ZWFtIGxpc3QgUmVjZWl2ZWQuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgdXBkYXRlZFRlYW1MaXN0UmVjZWl2ZWQgPSAoaXNTYXZlZDogYm9vbGVhbiA9IGZhbHNlKSA9PiB7XHJcblxyXG4gICAgICAgIHRoaXMudG9GaWVsZFZhbHVlcyA9IG5ldyBBcnJheTxzdHJpbmc+KCk7XHJcbiAgICAgICAgdGhpcy50b0ZpZWxkSWRzID0gbmV3IEFycmF5PG51bWJlcj4oKTtcclxuICAgICAgICB0aGlzLl9zZWxlY3RlZFRlYW1MaXN0ID0gbmV3IEFycmF5PHN0cmluZz4oKTtcclxuXHJcbiAgICAgICAgdGhpcy5faXNFbnRpcmVUZWFtU2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzU3Vib3JkaW5hdGVTZWxlY3RlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgdGVhbXMgPSBtZXNzYWdlU3RvcmUuaW5zdGFuY2UudGVhbURldGFpbHM7XHJcblxyXG4gICAgICAgIGlmICh0ZWFtcyAmJiB0ZWFtcy50ZWFtKSB7XHJcbiAgICAgICAgICAgIGlmICh0ZWFtcy50ZWFtLnRvVGVhbSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faXNFbnRpcmVUZWFtU2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1N1Ym9yZGluYXRlU2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRlYW1zLnRlYW0ucGFyZW50ICYmIHRlYW1zLnRlYW0ucGFyZW50LmlzQ2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGVkVGVhbUxpc3QucHVzaCh0ZWFtcy50ZWFtLnBhcmVudC5mdWxsTmFtZSArICc7Jyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGVhbXMudGVhbS5zdWJvcmRpbmF0ZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0U2VsZWN0ZWRTdWJvcmRpbmF0ZUxpc3QodGVhbXMudGVhbS5zdWJvcmRpbmF0ZXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyB0aGUgbG9nZ2VkIGluIHVzZXIgaGFzIHN1Ym9yZGluYXRlcywgY2hlY2sgdGhlIHN0b3JlIGZvciBuZXcgVE8gbGlzdFxyXG4gICAgICAgICAgICAvLyBpZiB0aGVyZSBhcmUgbm8gc3Vib3JkaW5hdGVzLCB0aGUgdGhlIHN1cGVydmlzb3IgZGV0YWlscyAoaWYgYW55KSB3aWxsIGJlIHBvcHVsYXRlZCB2aWEgcHJvcHNcclxuICAgICAgICAgICAgaWYgKG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscy50ZWFtLnN1Ym9yZGluYXRlcyAmJlxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZVN0b3JlLmluc3RhbmNlLnRlYW1EZXRhaWxzLnRlYW0uc3Vib3JkaW5hdGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucG9wdWxhdGVUb0ZpZWxkKHRlYW1zLnRlYW0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmlzU2hvd1RlYW1MaXN0UG9wdXAgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpc1NhdmVkICYmIHRoaXMucHJpb3JpdHlEcm9wRG93blNlbGVjdGVkSXRlbSA9PT0gZW51bXMuTWVzc2FnZVByaW9yaXR5Lk1hbmRhdG9yeSAmJlxyXG4gICAgICAgICAgICAgICAgIXRoaXMuaXNTdWJvcmRpbmF0ZVNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdpbmdBY3Rpb25DcmVhdG9yLmRpc3BsYXlNYW5kYXRvcnlWYWxpZGF0aW9uUG9wdXAodHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHJlbmRlcmVkT246IERhdGUubm93KCkgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFBvcHVsYXRlcyB0aGUgVG8gRmllbGRzIGJhc2VkIG9uIHRoZSB2YWx1ZXMgaW4gdGhlIHN0b3JlXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgcG9wdWxhdGVUb0ZpZWxkID0gKHRlYW06IEV4YW1pbmVySW5mbykgPT4ge1xyXG4gICAgICAgIGlmICh0ZWFtKSB7XHJcbiAgICAgICAgICAgIC8vIEFkZCBQYXJlbnQgRXhhbWluZXIgb2YgdGhlIGN1cnJlbnQgZXhhbWluZXIgaWYgdGhlIHBhcmVudCBpcyBzZWxlY3RlZFxyXG4gICAgICAgICAgICBpZiAodGVhbS5pc0N1cnJlbnRFeGFtaW5lciAmJiB0ZWFtLnBhcmVudCAmJiB0ZWFtLnBhcmVudC5pc0NoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9GaWVsZElkcy5wdXNoKHRlYW0ucGFyZW50LmV4YW1pbmVySWQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b0ZpZWxkVmFsdWVzLnB1c2godGVhbS5wYXJlbnQuZnVsbE5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRlYW0uaXNDdXJyZW50RXhhbWluZXIgJiYgdGVhbS5pc0NoZWNrZWQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvRmllbGRJZHMucHVzaCh0ZWFtLmV4YW1pbmVySWQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b0ZpZWxkVmFsdWVzLnB1c2godGVhbS5mdWxsTmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvciAobGV0IHN1YlRlYW0gb2YgdGVhbS5zdWJvcmRpbmF0ZXMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucG9wdWxhdGVUb0ZpZWxkKHN1YlRlYW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgc2VsZWN0ZWQgc3Vib3JkaW5hdGVkIGxpc3QuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0U2VsZWN0ZWRTdWJvcmRpbmF0ZUxpc3QodGVhbUxpc3Q6IEFycmF5PEV4YW1pbmVySW5mbz4pIHtcclxuICAgICAgICBsZXQgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgdGVhbUxpc3QubWFwKGZ1bmN0aW9uIChleGFtaW5lckluZm86IEV4YW1pbmVySW5mbykge1xyXG4gICAgICAgICAgICBpZiAoZXhhbWluZXJJbmZvLmlzQ2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgdGhhdC5pc1N1Ym9yZGluYXRlU2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhhdC5fc2VsZWN0ZWRUZWFtTGlzdC5wdXNoKGV4YW1pbmVySW5mby5mdWxsTmFtZSArICc7Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV4YW1pbmVySW5mby5zdWJvcmRpbmF0ZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhhdC5nZXRTZWxlY3RlZFN1Ym9yZGluYXRlTGlzdChleGFtaW5lckluZm8uc3Vib3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEVuc3VyZSBSZXBseSBpcyBkb25lIHRvIGEgc3Vib3JkaW5hdGUuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgaXNSZXBseVRvU3Vib3JkaW5hdGUodGVhbUxpc3Q6IEFycmF5PEV4YW1pbmVySW5mbz4pOiBib29sZWFuIHtcclxuXHJcbiAgICAgICAgLy8gU3Vib3JpZGluYXRlcyBvZiB0aGUgY3VycmVudCBleGFtaW5lciB3aWxsIGJlIHBhc3NlZCBoZXJlXHJcbiAgICAgICAgLy8gSWYgdGhlIHNlbGVjdGVkTWVzc2FnZS5mcm9tRXhhbWluZXJJZCBpcyBvbmUgYW1vbmcgdGhlbSwgc2V0IGlzU3Vib3JkaW5hdGUgYXMgdHJ1ZS5cclxuXHJcbiAgICAgICAgbGV0IHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIGxldCBpc1N1Ym9yZGluYXRlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRlYW1MaXN0Lm1hcChmdW5jdGlvbiAoZXhhbWluZXJJbmZvOiBFeGFtaW5lckluZm8pIHtcclxuICAgICAgICAgICAgaWYgKGV4YW1pbmVySW5mby5leGFtaW5lcklkID09PSB0aGF0LnByb3BzLnNlbGVjdGVkTWVzc2FnZS5mcm9tRXhhbWluZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgaXNTdWJvcmRpbmF0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV4YW1pbmVySW5mby5zdWJvcmRpbmF0ZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhhdC5pc1JlcGx5VG9TdWJvcmRpbmF0ZShleGFtaW5lckluZm8uc3Vib3JkaW5hdGVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gaXNTdWJvcmRpbmF0ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhhbmRsZXMgdGhlIGFjdGlvbiBldmVudCBvbiBUbyBhZGRyZXNzIGxpc3QgUmVjZWl2ZWQuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgdGVhbUxpc3RSZWNlaXZlZCA9ICgpID0+IHtcclxuXHJcbiAgICAgICAgbGV0IHRlYW1zID0gbWVzc2FnZVN0b3JlLmluc3RhbmNlLnRlYW1EZXRhaWxzO1xyXG4gICAgICAgIGxldCBxaWdJZDogbnVtYmVyID0gdGhpcy5wcm9wcy5zZWxlY3RlZFFpZ0l0ZW1JZDtcclxuICAgICAgICB0aGlzLl9kaXNhYmxlVG9CdXR0b25Gb3JTdGFuZGFyZGlzYXRpb25RaWcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgLy9GbGFnIHRvIGlkZW50aWZ5IHdoZXRoZXIgdGhlIHFpZyBpcyBpbiBzdGFuZGFyZGlzYXRpb24gc2V0dXAgcHJvZ3Jlc3NcclxuICAgICAgICBsZXQgc2VsZWN0ZWRRaWcgPSB0aGlzLnByb3BzLnFpZ0l0ZW1zTGlzdC5maWx0ZXIoKHg6IEl0ZW0pID0+IHguaWQgPT09IHRoaXMuc2VsZWN0ZWRRaWdJdGVtSWQpO1xyXG4gICAgICAgIGxldCBjb29yZGluYXRpb25Db21wbGV0ZSA9IHNlbGVjdGVkUWlnWzBdLmNvb3JkaW5hdGlvbkNvbXBsZXRlO1xyXG5cclxuICAgICAgICBpZiAodGVhbXMgJiYgdGVhbXMudGVhbS5zdWJvcmRpbmF0ZXMpIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2lzRW50aXJlVGVhbVNlbGVjdGVkID0gdGVhbXMudGVhbS50b1RlYW07XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRvRmllbGRWYWx1ZXMgPSBuZXcgQXJyYXk8c3RyaW5nPigpO1xyXG4gICAgICAgICAgICB0aGlzLnRvRmllbGRJZHMgPSBuZXcgQXJyYXk8bnVtYmVyPigpO1xyXG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RlZFRlYW1MaXN0ID0gbmV3IEFycmF5PHN0cmluZz4oKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMubWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLkluYm94UmVwbHkpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvRmllbGRJZHMucHVzaCh0aGlzLnByb3BzLnNlbGVjdGVkTWVzc2FnZS5mcm9tRXhhbWluZXJJZCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvRmllbGRWYWx1ZXMucHVzaCh0aGlzLnByb3BzLnNlbGVjdGVkTWVzc2FnZS5leGFtaW5lckRldGFpbHMuZnVsbE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0ZWRUZWFtTGlzdC5wdXNoKHRoaXMucHJvcHMuc2VsZWN0ZWRNZXNzYWdlLmV4YW1pbmVyRGV0YWlscy5mdWxsTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzU3Vib3JkaW5hdGVTZWxlY3RlZCA9IHRoaXMuaXNSZXBseVRvU3Vib3JkaW5hdGUodGVhbXMudGVhbS5zdWJvcmRpbmF0ZXMpO1xyXG5cclxuICAgICAgICAgICAgfSBlbHNlIGlmICghY29vcmRpbmF0aW9uQ29tcGxldGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBtZXNzYWdlIGlzIGFnYWluc3Qgc3RhbmRhcmRpc2F0aW9uc2V0dXAgcWlnIG9yIHJlc3BvbnNlIHRoZSByZWNlaXZlciBcclxuICAgICAgICAgICAgICAgIC8vIHNob3VsZCBiZSBzdG0gcGFyZW50IGVsc2UgYWxsIHdvcmsgYXMgZXhpc3RpbmdcclxuICAgICAgICAgICAgICAgIGlmICh0ZWFtcy50ZWFtLnN0bVBhcmVudCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvRmllbGRJZHMucHVzaCh0ZWFtcy50ZWFtLnN0bVBhcmVudC5leGFtaW5lcklkKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvRmllbGRWYWx1ZXMucHVzaCh0ZWFtcy50ZWFtLnN0bVBhcmVudC5mdWxsTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0ZWRUZWFtTGlzdC5wdXNoKHRlYW1zLnRlYW0uc3RtUGFyZW50LmZ1bGxOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1Nob3dUZWFtTGlzdFBvcHVwID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1N1Ym9yZGluYXRlU2VsZWN0ZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gRGlzYWJsaW5nIGJ1dHRvbiBpZiB0aGUgdXNlciBzZW5kcyBtZXNzYWdlIGFnYWluc3Qgc3RhbmRhcmRpc2F0aW9uIHJlc3BvbnNlIG9yIFFpZ1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVUb0J1dHRvbkZvclN0YW5kYXJkaXNhdGlvblFpZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGVhbXMudGVhbS5zdWJvcmRpbmF0ZXMubGVuZ3RoID09PSAwKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRlYW1zLnRlYW0ucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRNZXNzYWdlUGFuZWxUb1RhYkZvclBhcmVudCh0ZWFtcy50ZWFtLnBhcmVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIHJlbmRlcmVkT246IERhdGUubm93KClcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCB3aWxsIHNldCBtZXNzYWdlIHBhbmVsIHByb3BlcnR5IGZvciBzZW5kaW5nIG1lc3NhZ2UgdG8gdGhlIHBhcmVudFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHNldE1lc3NhZ2VQYW5lbFRvVGFiRm9yUGFyZW50KHBhcmVudCA6IEV4YW1pbmVySW5mbyl7XHJcbiAgICAgICAgdGhpcy50b0ZpZWxkSWRzLnB1c2gocGFyZW50LmV4YW1pbmVySWQpO1xyXG4gICAgICAgIHRoaXMudG9GaWVsZFZhbHVlcy5wdXNoKHBhcmVudC5mdWxsTmFtZSk7XHJcbiAgICAgICAgdGhpcy5fc2VsZWN0ZWRUZWFtTGlzdC5wdXNoKHBhcmVudC5mdWxsTmFtZSk7XHJcbiAgICAgICAgdGhpcy5pc1N1Ym9yZGluYXRlU2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhhbmRsZXMgdGhlIGFjdGlvbiBldmVudCBvbiBUbyBhZGRyZXNzIGxpc3QgUmVjZWl2ZWQuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgbWVzc2FnZVByaW9yaXR5VXBkYXRlID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMucHJpb3JpdHlEcm9wRG93blNlbGVjdGVkSXRlbSA9IGVudW1zLk1lc3NhZ2VQcmlvcml0eS5TdGFuZGFyZDtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgcmVuZGVyZWRPbjogRGF0ZS5ub3coKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIGNoZWNrIHRvIGVuYWJsZSB0byBidXR0b25cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBkb0Rpc2FibGVUb0J1dHRvbigpOiBib29sZWFuIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRRaWdJdGVtSWQgPT09IDAgfHxcclxuICAgICAgICAgICAgIW1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscyB8fFxyXG4gICAgICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UudGVhbURldGFpbHMudGVhbS5zdWJvcmRpbmF0ZXMubGVuZ3RoID09PSAwIHx8IHRoaXMuX2Rpc2FibGVUb0J1dHRvbkZvclN0YW5kYXJkaXNhdGlvblFpZykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2V0IHRoZSBzZWxlY3RlZCBsYW5ndWFnZSBzdGF0ZSB1cG9uIHN1Y2Nlc3NmdWxsIGNvbmZpcm1hdGlvbiBmcm9tIGxvY2FsZSBzdG9yZS5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBsYW5ndWFnZUNoYW5nZWQgPSAoKTogdm9pZCA9PiB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIHJlbmRlcmVkT246IERhdGUubm93KClcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBIYW5kbGVzIHRoZSBhY3Rpb24gZXZlbnQgb24gVG8gYWRkcmVzcyBsaXN0IFJlY2VpdmVkLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGlzVGlueU1DRUxvYWRlZCA9IChpc0xvYWRlZDogYm9vbGVhbik6IHZvaWQgPT4ge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICBpc1RpbnlNQ0VMb2FkZWQ6IGlzTG9hZGVkXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCA9IE1lc3NhZ2VQb3B1cDtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9+L3NvdXJjZS1tYXAtbG9hZGVyIS4vc3JjL2NvbXBvbmVudHMvbWVzc2FnZS9tZXNzYWdlcG9wdXAudHN4Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQXVDQTtBQUFBO0FBZ0JBOzs7O0FBSUE7QUFDQTtBQUFBO0FBbkJBO0FBSUE7QUFFQTtBQUlBO0FBMlNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFJQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQU1BO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFvRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEyQ0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFlQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE5ekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7O0FBQ0E7QUFFQTs7O0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFLQTtBQUVBO0FBU0E7QUFHQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBSUE7QUFHQTtBQUlBO0FBQ0E7QUFBQTtBQU1BO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFXQTtBQUNBO0FBR0E7QUFDQTtBQVNBO0FBQ0E7QUFHQTtBQUlBO0FBR0E7QUFJQTtBQUdBO0FBU0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBK1BBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbUZBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUF3REE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFZQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFtQkE7QUFBQTtBQUVBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),

/***/ 462:
/* no static exports found */
/* all exports used */
/*!***********************************************!*\
  !*** ./src/components/message/messagebase.ts ***!
  \***********************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar pureRenderComponent = __webpack_require__(/*! ../base/purerendercomponent */ 227);\r\nvar enums = __webpack_require__(/*! ../utility/enums */ 225);\r\nvar localeStore = __webpack_require__(/*! ../../stores/locale/localestore */ 226);\r\nvar messagingActionCreator = __webpack_require__(/*! ../../actions/messaging/messagingactioncreator */ 268);\r\nvar popupHelper = __webpack_require__(/*! ../utility/popup/popuphelper */ 288);\r\nvar popUpDisplayActionCreator = __webpack_require__(/*! ../../actions/popupdisplay/popupdisplayactioncreator */ 328);\r\nvar qigStore = __webpack_require__(/*! ../../stores/qigselector/qigstore */ 230);\r\nvar messageStore = __webpack_require__(/*! ../../stores/message/messagestore */ 240);\r\nvar worklistStore = __webpack_require__(/*! ../../stores/worklist/workliststore */ 231);\r\nvar qualityfeedbackHelper = __webpack_require__(/*! ../../utility/qualityfeedback/qualityfeedbackhelper */ 309);\r\nvar messageHelper = __webpack_require__(/*! ../utility/message/messagehelper */ 283);\r\nvar markerOperationModeFactory = __webpack_require__(/*! ../utility/markeroperationmode/markeroperationmodefactory */ 232);\r\nvar teamManagementActionCreator = __webpack_require__(/*! ../../actions/teammanagement/teammanagementactioncreator */ 263);\r\nvar applicationStore = __webpack_require__(/*! ../../stores/applicationoffline/applicationstore */ 247);\r\nvar Immutable = __webpack_require__(/*! immutable */ 40);\r\nvar MessageBase = /** @class */ (function (_super) {\r\n    __extends(MessageBase, _super);\r\n    /**\r\n     * @constructor\r\n     */\r\n    function MessageBase(props, state) {\r\n        var _this = _super.call(this, props, state) || this;\r\n        _this.isSelectedItemClicked = false;\r\n        _this.navigateTo = enums.SaveAndNavigate.none;\r\n        _this.msgEditorId = 'msg-tinymce-editor';\r\n        _this._boundHandleOnClick = null;\r\n        _this.isSubordinateSelected = false;\r\n        _this.sendMessageActionInProgress = false;\r\n        _this.messageType = enums.MessageType.None;\r\n        /**\r\n         * Callback function for dropdown select\r\n         */\r\n        _this.onSelect = function (selectedItem, event) {\r\n            _this.priorityDropDownSelectedItem = selectedItem;\r\n            _this.setState({ renderedOn: Date.now() });\r\n        };\r\n        /**\r\n         *  Callback function for dropdown click\r\n         */\r\n        _this.onDropDownClick = function (dropDown) {\r\n            _this.clickedDropDown = dropDown;\r\n            _this.isSelectedItemClicked = true;\r\n            if (_this.clickedDropDown === enums.DropDownType.Priority) {\r\n                _this.isQigDropDownOpen = undefined;\r\n                _this.isDropDownOpen = _this.isDropDownOpen === undefined ? true : !_this.isDropDownOpen;\r\n            }\r\n            else if (_this.clickedDropDown === enums.DropDownType.QIG) {\r\n                _this.isDropDownOpen = undefined;\r\n                _this.isQigDropDownOpen = _this.isQigDropDownOpen === undefined ? true : !_this.isQigDropDownOpen;\r\n            }\r\n            _this.setState({ renderedOn: Date.now() });\r\n        };\r\n        /**\r\n         * Handle click events on the window and collapse priority selection dropdown\r\n         * @param {any} source - The source element\r\n         */\r\n        _this.handleOnClick = function () {\r\n            if (!_this.isSelectedItemClicked && ((_this.isDropDownOpen !== undefined && _this.isDropDownOpen)\r\n                || (_this.isQigDropDownOpen !== undefined && _this.isQigDropDownOpen))) {\r\n                // collapse the priority dropdown\r\n                _this.isDropDownOpen = false;\r\n                _this.isQigDropDownOpen = false;\r\n                _this.setState({ renderedOn: Date.now() });\r\n            }\r\n            else {\r\n                _this.isSelectedItemClicked = false;\r\n            }\r\n        };\r\n        /**\r\n         *  This will return the localised string for message priority dropdown\r\n         */\r\n        _this.getPriorityDropDownItem = function (dropDownItem) {\r\n            var localisedDropDownItem;\r\n            switch (dropDownItem) {\r\n                case enums.MessagePriority.Important:\r\n                    localisedDropDownItem = localeStore.instance.TranslateText('messaging.compose-message.priority.important');\r\n                    break;\r\n                case enums.MessagePriority.Mandatory:\r\n                    localisedDropDownItem = localeStore.instance.TranslateText('messaging.compose-message.priority.mandatory');\r\n                    break;\r\n                default:\r\n                    localisedDropDownItem = localeStore.instance.TranslateText('messaging.compose-message.priority.standard');\r\n                    break;\r\n            }\r\n            return localisedDropDownItem;\r\n        };\r\n        /**\r\n         * Method fired when the message is closed.\r\n         */\r\n        _this.onMessageClose = function () {\r\n            // Show discard message if content edited; or just close the panel.\r\n            if (_this.isMessagePanelEdited) {\r\n                messagingActionCreator.messageAction(enums.MessageViewAction.Maximize);\r\n                if (_this.navigateTo === enums.SaveAndNavigate.newMessageButtonClick\r\n                    || _this.navigateTo === enums.SaveAndNavigate.toReplyMessage\r\n                    || _this.navigateTo === enums.SaveAndNavigate.toForwardMessage) {\r\n                    popUpDisplayActionCreator.popUpDisplay(enums.PopUpType.DiscardOnNewMessageButtonClick, enums.PopUpActionType.Show, enums.SaveAndNavigate.none, {\r\n                        popupContent: localeStore.instance.TranslateText('messaging.compose-message.discard-message-dialog.body-start-new-message-while-composing')\r\n                    });\r\n                }\r\n                else if (_this.navigateTo === enums.SaveAndNavigate.toNewResponseMessageCompose) {\r\n                    popUpDisplayActionCreator.popUpDisplay(enums.PopUpType.DiscardOnNewMessageButtonClick, enums.PopUpActionType.Show, enums.SaveAndNavigate.none, {\r\n                        popupContent: localeStore.instance.TranslateText('marking.response.discard-message-or-exception-dialog.body')\r\n                    });\r\n                }\r\n                else {\r\n                    var messageType = _this.navigateTo !== enums.SaveAndNavigate.none\r\n                        ? enums.PopUpType.DiscardMessageNavigateAway : enums.PopUpType.DiscardMessage;\r\n                    popUpDisplayActionCreator.popUpDisplay(messageType, enums.PopUpActionType.Show, messageStore.instance.navigateFrom, {\r\n                        popupContent: (_this.navigateTo === enums.SaveAndNavigate.messageWithInResponse ?\r\n                            localeStore.instance.TranslateText('marking.response.discard-message-or-exception-dialog.body') : undefined)\r\n                    });\r\n                }\r\n            }\r\n            else if (_this.navigateTo !== enums.SaveAndNavigate.none && _this.navigateTo !== enums.SaveAndNavigate.messageWithInResponse\r\n                && _this.navigateTo !== enums.SaveAndNavigate.newMessageButtonClick) {\r\n                // hide the message panel and navigate away\r\n                _this.onDiscardMessageConfirmed();\r\n            }\r\n            else if (_this.navigateTo === enums.SaveAndNavigate.newMessageButtonClick) {\r\n                _this.navigateTo = enums.SaveAndNavigate.none;\r\n                _this.isMessagePopupMinimized = false;\r\n                _this.setState({ renderedOn: Date.now() });\r\n            }\r\n            else {\r\n                // Close the Message Panel.\r\n                _this.resetAndCloseMessagePanel();\r\n                _this.navigateTo = enums.SaveAndNavigate.none;\r\n            }\r\n        };\r\n        /**\r\n         * Navigate away from current response.\r\n         */\r\n        _this.onNavigateAwayFromResponse = function (navigateTo) {\r\n            _this.navigateTo = navigateTo;\r\n            _this.onMessageClose();\r\n        };\r\n        /**\r\n         * Reset message panel and close\r\n         */\r\n        _this.resetAndCloseMessagePanel = function () {\r\n            _this.priorityDropDownSelectedItem = enums.MessagePriority.Standard;\r\n            _this.toFieldValues = null;\r\n            _this.toFieldIds = null;\r\n            _this.messageSubject = '';\r\n            _this.messageBody = '';\r\n            _this.isDropDownOpen = undefined;\r\n            _this.isQigDropDownOpen = undefined;\r\n            _this.props.closeMessagePanel(_this.navigateTo);\r\n            _this.selectedQigItemId = undefined;\r\n            _this.questionPaperPartId = undefined;\r\n            messageHelper.handleSubjectChange(_this.messageSubject);\r\n            _this.sendMessageActionInProgress = false;\r\n            // updating message component with default values\r\n            // this enable or Disable send button will call setState\r\n            _this.enableDisableSendButton();\r\n            // Need to Update the UI (Subject box in the message, after closing the message : Bug 28224\r\n            _this.setState({ renderedOn: Date.now() });\r\n        };\r\n        /**\r\n         * Method fired when discard message is confirmed.\r\n         */\r\n        _this.onDiscardMessageConfirmed = function (actionFromCombinedPopup, navigateTo) {\r\n            if (actionFromCombinedPopup === void 0) { actionFromCombinedPopup = false; }\r\n            if (navigateTo === void 0) { navigateTo = enums.SaveAndNavigate.none; }\r\n            // If message panel is not edited, no need to change the UI while logout\r\n            if (_this.isMessagePanelEdited) {\r\n                // Close the Message Panel.\r\n                _this.resetAndCloseMessagePanel();\r\n            }\r\n            else if (!_this.isMessagePanelEdited && _this.navigateTo === enums.SaveAndNavigate.newMessageButtonClick) {\r\n                messagingActionCreator.messageAction(enums.MessageViewAction.Open);\r\n            }\r\n            else {\r\n                _this.resetAndCloseMessagePanel();\r\n            }\r\n            // on message close navigate away from response scenario\r\n            if (_this.navigateTo !== enums.SaveAndNavigate.none && _this.navigateTo !== enums.SaveAndNavigate.messageWithInResponse\r\n                && _this.navigateTo !== enums.SaveAndNavigate.toNewResponseMessageCompose &&\r\n                !(_this.navigateTo === enums.SaveAndNavigate.toResponse && qualityfeedbackHelper.isResponseNavigationBlocked())) {\r\n                if (_this.navigateTo === enums.SaveAndNavigate.toSupervisorRemark) {\r\n                    // Response Going from readonly mode to marking. Reset the message related values from response screen.\r\n                    _this.resetAndCloseMessagePanel();\r\n                }\r\n                // if navigate away from Resposne then close the response and move to worklist.\r\n                popupHelper.navigateAway(_this.navigateTo);\r\n            }\r\n            else if (actionFromCombinedPopup) {\r\n                popupHelper.navigateAway(navigateTo);\r\n            }\r\n            _this.navigateTo = enums.SaveAndNavigate.none;\r\n        };\r\n        /**\r\n         * Method fired when discard message is cancelled.\r\n         */\r\n        _this.onDiscardMessageCancelled = function () {\r\n            // reset navigate away from response\r\n            _this.navigateTo = enums.SaveAndNavigate.none;\r\n            messageHelper.handleSubjectChange(_this.messageSubject);\r\n        };\r\n        /**\r\n         * Handles changes in the message panel subject section.\r\n         * @param e\r\n         */\r\n        _this.handleSubjectChange = function (subject) {\r\n            _this.messageSubject = subject;\r\n            _this.enableDisableSendButton();\r\n            messageHelper.handleSubjectChange(subject);\r\n            _this.setState({ renderedOn: Date.now() });\r\n        };\r\n        /**\r\n         * Enable and disable send button on tinyMCE editor change.\r\n         */\r\n        _this.toggleSaveButtonState = function () {\r\n            _this.enableDisableSendButton();\r\n        };\r\n        /**\r\n         * Method fired when the message panel is minimized.\r\n         */\r\n        _this.onMinimize = function () {\r\n            messagingActionCreator.messageAction(enums.MessageViewAction.Minimize);\r\n        };\r\n        /**\r\n         * Method fired when the message panel is maximized.\r\n         */\r\n        _this.onMaximize = function () {\r\n            messagingActionCreator.messageAction(enums.MessageViewAction.Maximize);\r\n        };\r\n        /**\r\n         * This method will call on message send button click\r\n         */\r\n        _this.onMessageSend = function (messageType) {\r\n            _this.enableDisableSendButton();\r\n            var candidateScriptId = undefined;\r\n            var markGroupId = undefined;\r\n            var esMarkGroupId = undefined;\r\n            _this.messageBody = tinymce.get(_this.msgEditorId).getContent();\r\n            switch (messageType) {\r\n                case enums.MessageType.ResponseCompose:\r\n                case enums.MessageType.ResponseReply:\r\n                case enums.MessageType.ResponseForward:\r\n                    // selected Qig id for compose message in response screen\r\n                    _this.selectedQigItemId = qigStore.instance.selectedQIGForMarkerOperation.markSchemeGroupId;\r\n                    _this.questionPaperPartId = qigStore.instance.selectedQIGForMarkerOperation.questionPaperPartId;\r\n                    var openedResponseDetails = _this.props.responseId ?\r\n                        markerOperationModeFactory.operationMode.openedResponseDetails(_this.props.responseId.toString()) : null;\r\n                    var isEsResponse = (worklistStore.instance.currentWorklistType === enums.WorklistType.standardisation\r\n                        || worklistStore.instance.currentWorklistType === enums.WorklistType.practice ||\r\n                        worklistStore.instance.currentWorklistType === enums.WorklistType.secondstandardisation\r\n                        || markerOperationModeFactory.operationMode.isStandardisationSetupMode) ? true : false;\r\n                    if (openedResponseDetails) {\r\n                        candidateScriptId = openedResponseDetails.candidateScriptId;\r\n                        if (markerOperationModeFactory.operationMode.isStandardisationSetupMode) {\r\n                            esMarkGroupId = openedResponseDetails.esMarkGroupId;\r\n                        }\r\n                        else {\r\n                            markGroupId = isEsResponse ? undefined : openedResponseDetails.markGroupId;\r\n                            esMarkGroupId = isEsResponse ? openedResponseDetails.markGroupId : undefined;\r\n                        }\r\n                    }\r\n                    break;\r\n                // Not setting candidateScriptId, markGroupId, esMarkGroupId if composing message from response and worklist\r\n                // since not associated with any particular response.\r\n                case enums.MessageType.InboxCompose:\r\n                case enums.MessageType.WorklistCompose:\r\n                    break;\r\n                default:\r\n                    var currentMessageDetails = _this.props.selectedMsgDetails;\r\n                    if (currentMessageDetails !== undefined && currentMessageDetails !== null) {\r\n                        candidateScriptId = currentMessageDetails.candidateScriptId;\r\n                        markGroupId = currentMessageDetails.markGroupId;\r\n                        esMarkGroupId = currentMessageDetails.esMarkGroupId;\r\n                    }\r\n                    break;\r\n            }\r\n            // fetching currently selected qig's examiner roleId\r\n            var examinerRoleId = 0;\r\n            var msg = messageStore.instance.messagesMarkSchemes;\r\n            if (msg) {\r\n                msg.forEach(function (message) {\r\n                    if (message.markSchemeGroupId === _this.selectedQigItemId) {\r\n                        examinerRoleId = message.examinerRoleId;\r\n                    }\r\n                });\r\n            }\r\n            var toTeam = messageStore.instance.teamDetails ? messageStore.instance.teamDetails.team.toTeam : false;\r\n            messagingActionCreator.sendExaminerMessage(_this.toFieldIds, _this.messageBody, _this.messageSubject, _this.questionPaperPartId, _this.props.responseId, _this.priorityDropDownSelectedItem, _this.selectedQigItemId, candidateScriptId, markGroupId, esMarkGroupId, toTeam, examinerRoleId);\r\n        };\r\n        /**\r\n         * Navigating away from message panel when the pop up is opened\r\n         */\r\n        _this.onNavigateFromMessagePanel = function (messageNavigationArguments) {\r\n            if (messageNavigationArguments.hasMessageContainsDirtyValue === undefined) {\r\n                // Should be possible to open the response, If the message composed from Team management\r\n                if (_this.isMessagePanelEdited) {\r\n                    messagingActionCreator.messageAction(enums.MessageViewAction.Maximize);\r\n                    // To maximise the message panel when the discard popup is shown\r\n                    _this.isMessagePopupMinimized = false;\r\n                    _this.setState({ renderedOn: Date.now() });\r\n                    messageNavigationArguments.hasMessageContainsDirtyValue = true;\r\n                    messagingActionCreator.canMessageNavigate(messageNavigationArguments);\r\n                }\r\n                else if (!messageNavigationArguments.canNavigate) {\r\n                    messagingActionCreator.messageAction(enums.MessageViewAction.Close);\r\n                    messageNavigationArguments.hasMessageContainsDirtyValue = false;\r\n                    if (messageNavigationArguments.navigateTo === enums.MessageNavigation.newException) {\r\n                        _this.navigateTo = enums.SaveAndNavigate.newExceptionButtonClick;\r\n                    }\r\n                    else if (messageNavigationArguments.navigateTo === enums.MessageNavigation.exceptionWithInResponse) {\r\n                        _this.navigateTo = enums.SaveAndNavigate.exceptionWithInResponse;\r\n                    }\r\n                    else if (messageNavigationArguments.navigateTo === enums.MessageNavigation.newExceptionFromMediaErrorDialog) {\r\n                        _this.navigateTo = enums.SaveAndNavigate.newExceptionFromMediaErrorDialog;\r\n                    }\r\n                    _this.resetAndCloseMessagePanel();\r\n                    messageNavigationArguments.canNavigate = true;\r\n                    messagingActionCreator.canMessageNavigate(messageNavigationArguments);\r\n                }\r\n            }\r\n            else if (messageNavigationArguments.hasMessageContainsDirtyValue && messageNavigationArguments.canNavigate) {\r\n                _this.isMessagePopupMinimized = false;\r\n                if (messageNavigationArguments.navigateTo === enums.MessageNavigation.newException) {\r\n                    _this.navigateTo = enums.SaveAndNavigate.newExceptionButtonClick;\r\n                }\r\n                else if (messageNavigationArguments.navigateTo === enums.MessageNavigation.exceptionWithInResponse) {\r\n                    _this.navigateTo = enums.SaveAndNavigate.exceptionWithInResponse;\r\n                }\r\n                else if (messageNavigationArguments.navigateTo === enums.MessageNavigation.newExceptionFromMediaErrorDialog) {\r\n                    _this.navigateTo = enums.SaveAndNavigate.newExceptionFromMediaErrorDialog;\r\n                }\r\n                _this.resetAndCloseMessagePanel();\r\n            }\r\n        };\r\n        /**\r\n         * checks whether the supervisor examiner is valid to send a message or not\r\n         */\r\n        _this.messageSendValidationCheck = function (messageType) {\r\n            _this.sendMessageActionInProgress = true;\r\n            _this.messageType = messageType;\r\n            // While in SEP view we need to check whether the supervisor examiner is valid to send a message to subordinate examiner\r\n            if (markerOperationModeFactory.operationMode.isHelpExaminersView) {\r\n                _this.enableDisableSendButton();\r\n                var dataCollection = new Array();\r\n                var examinerSEPAction = {\r\n                    examinerRoleId: qigStore.instance.selectedQIGForMarkerOperation.examinerRoleId,\r\n                    markSchemeGroupId: qigStore.instance.getSelectedQIGForTheLoggedInUser.markSchemeGroupId,\r\n                    requestedByExaminerRoleId: qigStore.instance.getSelectedQIGForTheLoggedInUser.examinerRoleId\r\n                };\r\n                dataCollection.push(examinerSEPAction);\r\n                var examinerSEPActions = Immutable.List(dataCollection);\r\n                var doSEPApprovalManagementActionArgument = {\r\n                    actionIdentifier: enums.SEPAction.SendMessage,\r\n                    examiners: examinerSEPActions\r\n                };\r\n                teamManagementActionCreator.ExecuteApprovalManagementAction(doSEPApprovalManagementActionArgument);\r\n            }\r\n            else {\r\n                _this.onMessageSend(_this.messageType);\r\n            }\r\n        };\r\n        /**\r\n         * To check whether the examiner is valid to send a message\r\n         */\r\n        _this.examinerValidation = function (actionIdentifier) {\r\n            // No need to handle, If user clicks help examiners and immidietly navigated to inbox\r\n            if (_this.props.messageType === enums.MessageType.InboxCompose) {\r\n                return;\r\n            }\r\n            // If there is no failure code then the supervisor examiner is valid to send a message\r\n            if (actionIdentifier === enums.SEPAction.SendMessage) {\r\n                _this.onMessageSend(_this.messageType);\r\n            }\r\n        };\r\n        /**\r\n         * enable send button state on offline\r\n         */\r\n        _this.onOnlineStatusChanged = function () {\r\n            if (!applicationStore.instance.isOnline) {\r\n                _this.toggleSaveButtonState();\r\n            }\r\n        };\r\n        _this.priorityDropDownSelectedItem = enums.MessagePriority.Standard;\r\n        _this.isSendButtonDisabled = true;\r\n        _this.messageSubject = '';\r\n        _this.messageBody = '';\r\n        _this._boundHandleOnClick = _this.handleOnClick.bind(_this);\r\n        _this.isSubordinateSelected = false;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(MessageBase.prototype, \"isMessagePanelEdited\", {\r\n        /**\r\n         * Returns a boolean indicating whether the message panel is edited.\r\n         */\r\n        get: function () {\r\n            return messageHelper.isMessagePanelEdited(this.props.messageType, this.toFieldValues, this.toFieldIds);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Sets the enable/disable status of send button.\r\n     */\r\n    MessageBase.prototype.enableDisableSendButton = function () {\r\n        var currentSendButtonStatusAfterChange = true;\r\n        var activeEditorgetContentLength = 0;\r\n        // if sending message is in progress no need to execute logic to enabling/ disabling button\r\n        if (!this.sendMessageActionInProgress) {\r\n            var activeEditor = tinymce.get(this.msgEditorId);\r\n            //Defect Id:48277 First time active Editor does not contains 'Body' Then throws exception 'Body Undefined'\r\n            if (activeEditor && activeEditor.contentDocument != null) {\r\n                activeEditorgetContentLength = activeEditor.getContent({ format: 'text' }).trim().length;\r\n            }\r\n            if (this.props.messageType === enums.MessageType.InboxCompose ||\r\n                this.props.messageType === enums.MessageType.ResponseCompose\r\n                || this.props.messageType === enums.MessageType.WorklistCompose ||\r\n                this.props.messageType === enums.MessageType.ResponseReply\r\n                || this.props.messageType === enums.MessageType.ResponseForward ||\r\n                this.props.messageType === enums.MessageType.TeamCompose) {\r\n                currentSendButtonStatusAfterChange = !(this.messageSubject.trim().length > 0 &&\r\n                    (this.toFieldIds && this.toFieldIds.length > 0)\r\n                    && (this.toFieldValues && this.toFieldValues.length > 0)\r\n                    && (activeEditorgetContentLength > 0 ||\r\n                        messageHelper._isPasteEnabled));\r\n            }\r\n            else if (this.props.messageType === enums.MessageType.InboxForward ||\r\n                this.props.messageType === enums.MessageType.InboxReply) {\r\n                currentSendButtonStatusAfterChange = !(this.messageSubject.trim().length > 0\r\n                    && (this.toFieldIds && this.toFieldIds.length > 0)\r\n                    && (this.toFieldValues && this.toFieldValues.length > 0)\r\n                    && this.selectedQigItemId > 1\r\n                    && (activeEditorgetContentLength > 0\r\n                        || messageHelper._isPasteEnabled));\r\n            }\r\n        }\r\n        else {\r\n            // disable send button when send message action is in progress if the application is online\r\n            currentSendButtonStatusAfterChange = applicationStore.instance.isOnline;\r\n        }\r\n        if (this.isSendButtonDisabled !== currentSendButtonStatusAfterChange) {\r\n            this.isSendButtonDisabled = currentSendButtonStatusAfterChange;\r\n            // It is noticed due to render in same time, state change not happening. Add some extra time for rendering.\r\n            this.setState({ renderedOn: Date.now() + 10 });\r\n        }\r\n        // Reset setPasteEnabledAction as false after the paste action fired.\r\n        messageHelper.setPasteEnabledAction(false);\r\n    };\r\n    return MessageBase;\r\n}(pureRenderComponent));\r\nmodule.exports = MessageBase;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDYyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWVzc2FnZS9tZXNzYWdlYmFzZS50cz84MDA0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwdXJlUmVuZGVyQ29tcG9uZW50ID0gcmVxdWlyZSgnLi4vYmFzZS9wdXJlcmVuZGVyY29tcG9uZW50Jyk7XHJcbmltcG9ydCBSZWFjdERvbSA9IHJlcXVpcmUoJ3JlYWN0LWRvbScpO1xyXG5pbXBvcnQgZW51bXMgPSByZXF1aXJlKCcuLi91dGlsaXR5L2VudW1zJyk7XHJcbmltcG9ydCBsb2NhbGVTdG9yZSA9IHJlcXVpcmUoJy4uLy4uL3N0b3Jlcy9sb2NhbGUvbG9jYWxlc3RvcmUnKTtcclxuaW1wb3J0IGV4YW1pbmVyU3RvcmUgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvbWFya2VyaW5mb3JtYXRpb24vZXhhbWluZXJzdG9yZScpO1xyXG5pbXBvcnQgbWVzc2FnaW5nQWN0aW9uQ3JlYXRvciA9IHJlcXVpcmUoJy4uLy4uL2FjdGlvbnMvbWVzc2FnaW5nL21lc3NhZ2luZ2FjdGlvbmNyZWF0b3InKTtcclxuaW1wb3J0IHBvcHVwSGVscGVyID0gcmVxdWlyZSgnLi4vdXRpbGl0eS9wb3B1cC9wb3B1cGhlbHBlcicpO1xyXG5pbXBvcnQgcG9wVXBEaXNwbGF5QWN0aW9uQ3JlYXRvciA9IHJlcXVpcmUoJy4uLy4uL2FjdGlvbnMvcG9wdXBkaXNwbGF5L3BvcHVwZGlzcGxheWFjdGlvbmNyZWF0b3InKTtcclxuaW1wb3J0IHFpZ1N0b3JlID0gcmVxdWlyZSgnLi4vLi4vc3RvcmVzL3FpZ3NlbGVjdG9yL3FpZ3N0b3JlJyk7XHJcbmltcG9ydCBtZXNzYWdlU3RvcmUgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvbWVzc2FnZS9tZXNzYWdlc3RvcmUnKTtcclxuaW1wb3J0IGh0bWxVdGlsaXRpZXMgPSByZXF1aXJlKCcuLi8uLi91dGlsaXR5L2dlbmVyaWMvaHRtbHV0aWxpdGllcycpO1xyXG5pbXBvcnQgd29ya2xpc3RTdG9yZSA9IHJlcXVpcmUoJy4uLy4uL3N0b3Jlcy93b3JrbGlzdC93b3JrbGlzdHN0b3JlJyk7XHJcbmltcG9ydCByZXNwb25zZVN0b3JlID0gcmVxdWlyZSgnLi4vLi4vc3RvcmVzL3Jlc3BvbnNlL3Jlc3BvbnNlc3RvcmUnKTtcclxuaW1wb3J0IG1hcmtpbmdBY3Rpb25DcmVhdG9yID0gcmVxdWlyZSgnLi4vLi4vYWN0aW9ucy9tYXJraW5nL21hcmtpbmdhY3Rpb25jcmVhdG9yJyk7XHJcbmltcG9ydCBxdWFsaXR5ZmVlZGJhY2tIZWxwZXIgPSByZXF1aXJlKCcuLi8uLi91dGlsaXR5L3F1YWxpdHlmZWVkYmFjay9xdWFsaXR5ZmVlZGJhY2toZWxwZXInKTtcclxuaW1wb3J0IG1lc3NhZ2VIZWxwZXIgPSByZXF1aXJlKCcuLi91dGlsaXR5L21lc3NhZ2UvbWVzc2FnZWhlbHBlcicpO1xyXG5pbXBvcnQgbWFya2VyT3BlcmF0aW9uTW9kZUZhY3RvcnkgPSByZXF1aXJlKCcuLi91dGlsaXR5L21hcmtlcm9wZXJhdGlvbm1vZGUvbWFya2Vyb3BlcmF0aW9ubW9kZWZhY3RvcnknKTtcclxuaW1wb3J0IHRlYW1NYW5hZ2VtZW50QWN0aW9uQ3JlYXRvciA9IHJlcXVpcmUoJy4uLy4uL2FjdGlvbnMvdGVhbW1hbmFnZW1lbnQvdGVhbW1hbmFnZW1lbnRhY3Rpb25jcmVhdG9yJyk7XHJcbmltcG9ydCBhcHBsaWNhdGlvblN0b3JlID0gcmVxdWlyZSgnLi4vLi4vc3RvcmVzL2FwcGxpY2F0aW9ub2ZmbGluZS9hcHBsaWNhdGlvbnN0b3JlJyk7XHJcbmltcG9ydCBJbW11dGFibGUgPSByZXF1aXJlKCdpbW11dGFibGUnKTtcclxuXHJcbmRlY2xhcmUgbGV0IHRpbnltY2U6IGFueTtcclxuXHJcbmNsYXNzIE1lc3NhZ2VCYXNlIGV4dGVuZHMgcHVyZVJlbmRlckNvbXBvbmVudDxhbnksIGFueT4ge1xyXG5cclxuICAgIHByb3RlY3RlZCBpc1NlbmRCdXR0b25EaXNhYmxlZDogYm9vbGVhbjtcclxuICAgIHByb3RlY3RlZCB0b0ZpZWxkSWRzOiBBcnJheTxudW1iZXI+O1xyXG4gICAgcHJvdGVjdGVkIHRvRmllbGRWYWx1ZXM6IEFycmF5PHN0cmluZz47XHJcbiAgICBwcm90ZWN0ZWQgc2VsZWN0ZWRRaWdJdGVtSWQ6IG51bWJlcjtcclxuICAgIHByb3RlY3RlZCBzZWxlY3RlZFFpZzogc3RyaW5nO1xyXG4gICAgcHJvdGVjdGVkIHF1ZXN0aW9uUGFwZXJQYXJ0SWQ6IG51bWJlcjtcclxuICAgIHByb3RlY3RlZCBtZXNzYWdlU3ViamVjdDogc3RyaW5nO1xyXG4gICAgcHJvdGVjdGVkIG1lc3NhZ2VCb2R5OiBzdHJpbmc7XHJcbiAgICBwcm90ZWN0ZWQgaXNEcm9wRG93bk9wZW46IGJvb2xlYW47XHJcbiAgICBwcm90ZWN0ZWQgaXNRaWdEcm9wRG93bk9wZW46IGJvb2xlYW47XHJcbiAgICBwcm90ZWN0ZWQgcHJpb3JpdHlEcm9wRG93blNlbGVjdGVkSXRlbTogZW51bXMuTWVzc2FnZVByaW9yaXR5O1xyXG4gICAgcHJvdGVjdGVkIGlzU2VsZWN0ZWRJdGVtQ2xpY2tlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJvdGVjdGVkIG5hdmlnYXRlVG86IGVudW1zLlNhdmVBbmROYXZpZ2F0ZSA9IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5ub25lO1xyXG4gICAgcHJvdGVjdGVkIG1zZ0VkaXRvcklkOiBzdHJpbmcgPSAnbXNnLXRpbnltY2UtZWRpdG9yJztcclxuICAgIHByb3RlY3RlZCBfYm91bmRIYW5kbGVPbkNsaWNrOiBFdmVudExpc3RlbmVyT2JqZWN0ID0gbnVsbDtcclxuICAgIHByb3RlY3RlZCBjbGlja2VkRHJvcERvd246IGVudW1zLkRyb3BEb3duVHlwZTtcclxuICAgIHByb3RlY3RlZCBpc01lc3NhZ2VQb3B1cE1pbmltaXplZDogYm9vbGVhbjtcclxuICAgIHByb3RlY3RlZCBpc1N1Ym9yZGluYXRlU2VsZWN0ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHByb3RlY3RlZCBzZW5kTWVzc2FnZUFjdGlvbkluUHJvZ3Jlc3M6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHByb3RlY3RlZCBtZXNzYWdlVHlwZTogZW51bXMuTWVzc2FnZVR5cGUgPSBlbnVtcy5NZXNzYWdlVHlwZS5Ob25lO1xyXG5cclxuICAgIC8qKiByZWZzICovXHJcbiAgICBwdWJsaWMgcmVmczoge1xyXG4gICAgICAgIFtrZXk6IHN0cmluZ106IChFbGVtZW50KTtcclxuICAgICAgICBtc2dFZGl0b3I6IChIVE1MRGl2RWxlbWVudCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBhbnksIHN0YXRlOiBhbnkpIHtcclxuICAgICAgICBzdXBlcihwcm9wcywgc3RhdGUpO1xyXG5cclxuICAgICAgICB0aGlzLnByaW9yaXR5RHJvcERvd25TZWxlY3RlZEl0ZW0gPSBlbnVtcy5NZXNzYWdlUHJpb3JpdHkuU3RhbmRhcmQ7XHJcbiAgICAgICAgdGhpcy5pc1NlbmRCdXR0b25EaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlU3ViamVjdCA9ICcnO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZUJvZHkgPSAnJztcclxuICAgICAgICB0aGlzLl9ib3VuZEhhbmRsZU9uQ2xpY2sgPSB0aGlzLmhhbmRsZU9uQ2xpY2suYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLmlzU3Vib3JkaW5hdGVTZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGJhY2sgZnVuY3Rpb24gZm9yIGRyb3Bkb3duIHNlbGVjdFxyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgb25TZWxlY3QgPSAoc2VsZWN0ZWRJdGVtOiBlbnVtcy5NZXNzYWdlUHJpb3JpdHksIGV2ZW50OiBhbnkpOiB2b2lkID0+IHtcclxuICAgICAgICB0aGlzLnByaW9yaXR5RHJvcERvd25TZWxlY3RlZEl0ZW0gPSBzZWxlY3RlZEl0ZW07XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHJlbmRlcmVkT246IERhdGUubm93KCkgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogIENhbGxiYWNrIGZ1bmN0aW9uIGZvciBkcm9wZG93biBjbGlja1xyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgb25Ecm9wRG93bkNsaWNrID0gKGRyb3BEb3duOiBlbnVtcy5Ecm9wRG93blR5cGUpOiB2b2lkID0+IHtcclxuICAgICAgICB0aGlzLmNsaWNrZWREcm9wRG93biA9IGRyb3BEb3duO1xyXG4gICAgICAgIHRoaXMuaXNTZWxlY3RlZEl0ZW1DbGlja2VkID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5jbGlja2VkRHJvcERvd24gPT09IGVudW1zLkRyb3BEb3duVHlwZS5Qcmlvcml0eSkge1xyXG4gICAgICAgICAgICB0aGlzLmlzUWlnRHJvcERvd25PcGVuID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB0aGlzLmlzRHJvcERvd25PcGVuID0gdGhpcy5pc0Ryb3BEb3duT3BlbiA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6ICF0aGlzLmlzRHJvcERvd25PcGVuO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5jbGlja2VkRHJvcERvd24gPT09IGVudW1zLkRyb3BEb3duVHlwZS5RSUcpIHtcclxuICAgICAgICAgICAgdGhpcy5pc0Ryb3BEb3duT3BlbiA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgdGhpcy5pc1FpZ0Ryb3BEb3duT3BlbiA9IHRoaXMuaXNRaWdEcm9wRG93bk9wZW4gPT09IHVuZGVmaW5lZCA/IHRydWUgOiAhdGhpcy5pc1FpZ0Ryb3BEb3duT3BlbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHJlbmRlcmVkT246IERhdGUubm93KCkgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGFuZGxlIGNsaWNrIGV2ZW50cyBvbiB0aGUgd2luZG93IGFuZCBjb2xsYXBzZSBwcmlvcml0eSBzZWxlY3Rpb24gZHJvcGRvd25cclxuICAgICAqIEBwYXJhbSB7YW55fSBzb3VyY2UgLSBUaGUgc291cmNlIGVsZW1lbnRcclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIGhhbmRsZU9uQ2xpY2sgPSAoKTogYW55ID0+IHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNTZWxlY3RlZEl0ZW1DbGlja2VkICYmICgodGhpcy5pc0Ryb3BEb3duT3BlbiAhPT0gdW5kZWZpbmVkICYmIHRoaXMuaXNEcm9wRG93bk9wZW4pXHJcbiAgICAgICAgICAgIHx8ICh0aGlzLmlzUWlnRHJvcERvd25PcGVuICE9PSB1bmRlZmluZWQgJiYgdGhpcy5pc1FpZ0Ryb3BEb3duT3BlbikpKSB7XHJcbiAgICAgICAgICAgIC8vIGNvbGxhcHNlIHRoZSBwcmlvcml0eSBkcm9wZG93blxyXG4gICAgICAgICAgICB0aGlzLmlzRHJvcERvd25PcGVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuaXNRaWdEcm9wRG93bk9wZW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHJlbmRlcmVkT246IERhdGUubm93KCkgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5pc1NlbGVjdGVkSXRlbUNsaWNrZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogIFRoaXMgd2lsbCByZXR1cm4gdGhlIGxvY2FsaXNlZCBzdHJpbmcgZm9yIG1lc3NhZ2UgcHJpb3JpdHkgZHJvcGRvd25cclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIGdldFByaW9yaXR5RHJvcERvd25JdGVtID0gKGRyb3BEb3duSXRlbTogZW51bXMuTWVzc2FnZVByaW9yaXR5KTogc3RyaW5nID0+IHtcclxuICAgICAgICBsZXQgbG9jYWxpc2VkRHJvcERvd25JdGVtOiBzdHJpbmc7XHJcblxyXG4gICAgICAgIHN3aXRjaCAoZHJvcERvd25JdGVtKSB7XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZVByaW9yaXR5LkltcG9ydGFudDpcclxuICAgICAgICAgICAgICAgIGxvY2FsaXNlZERyb3BEb3duSXRlbSA9IGxvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UucHJpb3JpdHkuaW1wb3J0YW50Jyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5NZXNzYWdlUHJpb3JpdHkuTWFuZGF0b3J5OlxyXG4gICAgICAgICAgICAgICAgbG9jYWxpc2VkRHJvcERvd25JdGVtID0gbG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dCgnbWVzc2FnaW5nLmNvbXBvc2UtbWVzc2FnZS5wcmlvcml0eS5tYW5kYXRvcnknKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgbG9jYWxpc2VkRHJvcERvd25JdGVtID0gbG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dCgnbWVzc2FnaW5nLmNvbXBvc2UtbWVzc2FnZS5wcmlvcml0eS5zdGFuZGFyZCcpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBsb2NhbGlzZWREcm9wRG93bkl0ZW07XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWV0aG9kIGZpcmVkIHdoZW4gdGhlIG1lc3NhZ2UgaXMgY2xvc2VkLlxyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgb25NZXNzYWdlQ2xvc2UgPSAoKSA9PiB7XHJcbiAgICAgICAgLy8gU2hvdyBkaXNjYXJkIG1lc3NhZ2UgaWYgY29udGVudCBlZGl0ZWQ7IG9yIGp1c3QgY2xvc2UgdGhlIHBhbmVsLlxyXG4gICAgICAgIGlmICh0aGlzLmlzTWVzc2FnZVBhbmVsRWRpdGVkKSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2luZ0FjdGlvbkNyZWF0b3IubWVzc2FnZUFjdGlvbihlbnVtcy5NZXNzYWdlVmlld0FjdGlvbi5NYXhpbWl6ZSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5hdmlnYXRlVG8gPT09IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5uZXdNZXNzYWdlQnV0dG9uQ2xpY2tcclxuICAgICAgICAgICAgICAgIHx8IHRoaXMubmF2aWdhdGVUbyA9PT0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLnRvUmVwbHlNZXNzYWdlXHJcbiAgICAgICAgICAgICAgICB8fCB0aGlzLm5hdmlnYXRlVG8gPT09IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS50b0ZvcndhcmRNZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgICBwb3BVcERpc3BsYXlBY3Rpb25DcmVhdG9yLnBvcFVwRGlzcGxheShlbnVtcy5Qb3BVcFR5cGUuRGlzY2FyZE9uTmV3TWVzc2FnZUJ1dHRvbkNsaWNrLFxyXG4gICAgICAgICAgICAgICAgICAgIGVudW1zLlBvcFVwQWN0aW9uVHlwZS5TaG93LFxyXG4gICAgICAgICAgICAgICAgICAgIGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5ub25lLFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBDb250ZW50OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UuZGlzY2FyZC1tZXNzYWdlLWRpYWxvZy5ib2R5LXN0YXJ0LW5ldy1tZXNzYWdlLXdoaWxlLWNvbXBvc2luZycpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5uYXZpZ2F0ZVRvID09PSBlbnVtcy5TYXZlQW5kTmF2aWdhdGUudG9OZXdSZXNwb25zZU1lc3NhZ2VDb21wb3NlKSB7XHJcbiAgICAgICAgICAgICAgICBwb3BVcERpc3BsYXlBY3Rpb25DcmVhdG9yLnBvcFVwRGlzcGxheShlbnVtcy5Qb3BVcFR5cGUuRGlzY2FyZE9uTmV3TWVzc2FnZUJ1dHRvbkNsaWNrLFxyXG4gICAgICAgICAgICAgICAgICAgIGVudW1zLlBvcFVwQWN0aW9uVHlwZS5TaG93LFxyXG4gICAgICAgICAgICAgICAgICAgIGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5ub25lLFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBDb250ZW50OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtYXJraW5nLnJlc3BvbnNlLmRpc2NhcmQtbWVzc2FnZS1vci1leGNlcHRpb24tZGlhbG9nLmJvZHknKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IG1lc3NhZ2VUeXBlOiBlbnVtcy5Qb3BVcFR5cGUgPSB0aGlzLm5hdmlnYXRlVG8gIT09IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5ub25lXHJcbiAgICAgICAgICAgICAgICAgICAgPyBlbnVtcy5Qb3BVcFR5cGUuRGlzY2FyZE1lc3NhZ2VOYXZpZ2F0ZUF3YXkgOiBlbnVtcy5Qb3BVcFR5cGUuRGlzY2FyZE1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICBwb3BVcERpc3BsYXlBY3Rpb25DcmVhdG9yLnBvcFVwRGlzcGxheShcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlVHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBlbnVtcy5Qb3BVcEFjdGlvblR5cGUuU2hvdyxcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UubmF2aWdhdGVGcm9tLFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBDb250ZW50OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAodGhpcy5uYXZpZ2F0ZVRvID09PSBlbnVtcy5TYXZlQW5kTmF2aWdhdGUubWVzc2FnZVdpdGhJblJlc3BvbnNlID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21hcmtpbmcucmVzcG9uc2UuZGlzY2FyZC1tZXNzYWdlLW9yLWV4Y2VwdGlvbi1kaWFsb2cuYm9keScpIDogdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm5hdmlnYXRlVG8gIT09IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5ub25lICYmIHRoaXMubmF2aWdhdGVUbyAhPT0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLm1lc3NhZ2VXaXRoSW5SZXNwb25zZVxyXG4gICAgICAgICAgICAmJiB0aGlzLm5hdmlnYXRlVG8gIT09IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5uZXdNZXNzYWdlQnV0dG9uQ2xpY2spIHtcclxuICAgICAgICAgICAgLy8gaGlkZSB0aGUgbWVzc2FnZSBwYW5lbCBhbmQgbmF2aWdhdGUgYXdheVxyXG4gICAgICAgICAgICB0aGlzLm9uRGlzY2FyZE1lc3NhZ2VDb25maXJtZWQoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubmF2aWdhdGVUbyA9PT0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLm5ld01lc3NhZ2VCdXR0b25DbGljaykge1xyXG4gICAgICAgICAgICB0aGlzLm5hdmlnYXRlVG8gPSBlbnVtcy5TYXZlQW5kTmF2aWdhdGUubm9uZTtcclxuICAgICAgICAgICAgdGhpcy5pc01lc3NhZ2VQb3B1cE1pbmltaXplZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgcmVuZGVyZWRPbjogRGF0ZS5ub3coKSB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBDbG9zZSB0aGUgTWVzc2FnZSBQYW5lbC5cclxuICAgICAgICAgICAgdGhpcy5yZXNldEFuZENsb3NlTWVzc2FnZVBhbmVsKCk7XHJcbiAgICAgICAgICAgIHRoaXMubmF2aWdhdGVUbyA9IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5ub25lO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBOYXZpZ2F0ZSBhd2F5IGZyb20gY3VycmVudCByZXNwb25zZS5cclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIG9uTmF2aWdhdGVBd2F5RnJvbVJlc3BvbnNlID0gKG5hdmlnYXRlVG86IGVudW1zLlNhdmVBbmROYXZpZ2F0ZSkgPT4ge1xyXG4gICAgICAgIHRoaXMubmF2aWdhdGVUbyA9IG5hdmlnYXRlVG87XHJcbiAgICAgICAgdGhpcy5vbk1lc3NhZ2VDbG9zZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0IG1lc3NhZ2UgcGFuZWwgYW5kIGNsb3NlXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCByZXNldEFuZENsb3NlTWVzc2FnZVBhbmVsID0gKCk6IHZvaWQgPT4ge1xyXG4gICAgICAgIHRoaXMucHJpb3JpdHlEcm9wRG93blNlbGVjdGVkSXRlbSA9IGVudW1zLk1lc3NhZ2VQcmlvcml0eS5TdGFuZGFyZDtcclxuICAgICAgICB0aGlzLnRvRmllbGRWYWx1ZXMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudG9GaWVsZElkcyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlU3ViamVjdCA9ICcnO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZUJvZHkgPSAnJztcclxuICAgICAgICB0aGlzLmlzRHJvcERvd25PcGVuID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMuaXNRaWdEcm9wRG93bk9wZW4gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5wcm9wcy5jbG9zZU1lc3NhZ2VQYW5lbCh0aGlzLm5hdmlnYXRlVG8pO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRRaWdJdGVtSWQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5xdWVzdGlvblBhcGVyUGFydElkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIG1lc3NhZ2VIZWxwZXIuaGFuZGxlU3ViamVjdENoYW5nZSh0aGlzLm1lc3NhZ2VTdWJqZWN0KTtcclxuICAgICAgICB0aGlzLnNlbmRNZXNzYWdlQWN0aW9uSW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgIC8vIHVwZGF0aW5nIG1lc3NhZ2UgY29tcG9uZW50IHdpdGggZGVmYXVsdCB2YWx1ZXNcclxuICAgICAgICAvLyB0aGlzIGVuYWJsZSBvciBEaXNhYmxlIHNlbmQgYnV0dG9uIHdpbGwgY2FsbCBzZXRTdGF0ZVxyXG4gICAgICAgIHRoaXMuZW5hYmxlRGlzYWJsZVNlbmRCdXR0b24oKTtcclxuXHJcbiAgICAgICAgLy8gTmVlZCB0byBVcGRhdGUgdGhlIFVJIChTdWJqZWN0IGJveCBpbiB0aGUgbWVzc2FnZSwgYWZ0ZXIgY2xvc2luZyB0aGUgbWVzc2FnZSA6IEJ1ZyAyODIyNFxyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyByZW5kZXJlZE9uOiBEYXRlLm5vdygpIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIE1ldGhvZCBmaXJlZCB3aGVuIGRpc2NhcmQgbWVzc2FnZSBpcyBjb25maXJtZWQuXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBvbkRpc2NhcmRNZXNzYWdlQ29uZmlybWVkID0gKGFjdGlvbkZyb21Db21iaW5lZFBvcHVwOiBib29sZWFuID0gZmFsc2UsXHJcbiAgICAgICAgbmF2aWdhdGVUbzogZW51bXMuU2F2ZUFuZE5hdmlnYXRlID0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLm5vbmUpID0+IHtcclxuICAgICAgICAvLyBJZiBtZXNzYWdlIHBhbmVsIGlzIG5vdCBlZGl0ZWQsIG5vIG5lZWQgdG8gY2hhbmdlIHRoZSBVSSB3aGlsZSBsb2dvdXRcclxuICAgICAgICBpZiAodGhpcy5pc01lc3NhZ2VQYW5lbEVkaXRlZCkge1xyXG4gICAgICAgICAgICAvLyBDbG9zZSB0aGUgTWVzc2FnZSBQYW5lbC5cclxuICAgICAgICAgICAgdGhpcy5yZXNldEFuZENsb3NlTWVzc2FnZVBhbmVsKCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5pc01lc3NhZ2VQYW5lbEVkaXRlZCAmJiB0aGlzLm5hdmlnYXRlVG8gPT09IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5uZXdNZXNzYWdlQnV0dG9uQ2xpY2spIHtcclxuICAgICAgICAgICAgbWVzc2FnaW5nQWN0aW9uQ3JlYXRvci5tZXNzYWdlQWN0aW9uKGVudW1zLk1lc3NhZ2VWaWV3QWN0aW9uLk9wZW4pO1xyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0QW5kQ2xvc2VNZXNzYWdlUGFuZWwoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIG9uIG1lc3NhZ2UgY2xvc2UgbmF2aWdhdGUgYXdheSBmcm9tIHJlc3BvbnNlIHNjZW5hcmlvXHJcbiAgICAgICAgaWYgKHRoaXMubmF2aWdhdGVUbyAhPT0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLm5vbmUgJiYgdGhpcy5uYXZpZ2F0ZVRvICE9PSBlbnVtcy5TYXZlQW5kTmF2aWdhdGUubWVzc2FnZVdpdGhJblJlc3BvbnNlXHJcbiAgICAgICAgICAgICYmIHRoaXMubmF2aWdhdGVUbyAhPT0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLnRvTmV3UmVzcG9uc2VNZXNzYWdlQ29tcG9zZSAmJlxyXG4gICAgICAgICAgICAhKHRoaXMubmF2aWdhdGVUbyA9PT0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLnRvUmVzcG9uc2UgJiYgcXVhbGl0eWZlZWRiYWNrSGVscGVyLmlzUmVzcG9uc2VOYXZpZ2F0aW9uQmxvY2tlZCgpKSkge1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMubmF2aWdhdGVUbyA9PT0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLnRvU3VwZXJ2aXNvclJlbWFyaykge1xyXG4gICAgICAgICAgICAgICAgLy8gUmVzcG9uc2UgR29pbmcgZnJvbSByZWFkb25seSBtb2RlIHRvIG1hcmtpbmcuIFJlc2V0IHRoZSBtZXNzYWdlIHJlbGF0ZWQgdmFsdWVzIGZyb20gcmVzcG9uc2Ugc2NyZWVuLlxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldEFuZENsb3NlTWVzc2FnZVBhbmVsKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGlmIG5hdmlnYXRlIGF3YXkgZnJvbSBSZXNwb3NuZSB0aGVuIGNsb3NlIHRoZSByZXNwb25zZSBhbmQgbW92ZSB0byB3b3JrbGlzdC5cclxuICAgICAgICAgICAgcG9wdXBIZWxwZXIubmF2aWdhdGVBd2F5KHRoaXMubmF2aWdhdGVUbyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb25Gcm9tQ29tYmluZWRQb3B1cCkge1xyXG4gICAgICAgICAgICBwb3B1cEhlbHBlci5uYXZpZ2F0ZUF3YXkobmF2aWdhdGVUbyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLm5hdmlnYXRlVG8gPSBlbnVtcy5TYXZlQW5kTmF2aWdhdGUubm9uZTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgYm9vbGVhbiBpbmRpY2F0aW5nIHdoZXRoZXIgdGhlIG1lc3NhZ2UgcGFuZWwgaXMgZWRpdGVkLlxyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgZ2V0IGlzTWVzc2FnZVBhbmVsRWRpdGVkKCkge1xyXG4gICAgICAgIHJldHVybiBtZXNzYWdlSGVscGVyLmlzTWVzc2FnZVBhbmVsRWRpdGVkKHRoaXMucHJvcHMubWVzc2FnZVR5cGUsIHRoaXMudG9GaWVsZFZhbHVlcywgdGhpcy50b0ZpZWxkSWRzKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE1ldGhvZCBmaXJlZCB3aGVuIGRpc2NhcmQgbWVzc2FnZSBpcyBjYW5jZWxsZWQuXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBvbkRpc2NhcmRNZXNzYWdlQ2FuY2VsbGVkID0gKCkgPT4ge1xyXG4gICAgICAgIC8vIHJlc2V0IG5hdmlnYXRlIGF3YXkgZnJvbSByZXNwb25zZVxyXG4gICAgICAgIHRoaXMubmF2aWdhdGVUbyA9IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5ub25lO1xyXG4gICAgICAgIG1lc3NhZ2VIZWxwZXIuaGFuZGxlU3ViamVjdENoYW5nZSh0aGlzLm1lc3NhZ2VTdWJqZWN0KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBIYW5kbGVzIGNoYW5nZXMgaW4gdGhlIG1lc3NhZ2UgcGFuZWwgc3ViamVjdCBzZWN0aW9uLlxyXG4gICAgICogQHBhcmFtIGVcclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIGhhbmRsZVN1YmplY3RDaGFuZ2UgPSAoc3ViamVjdDogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlU3ViamVjdCA9IHN1YmplY3Q7XHJcbiAgICAgICAgdGhpcy5lbmFibGVEaXNhYmxlU2VuZEJ1dHRvbigpO1xyXG4gICAgICAgIG1lc3NhZ2VIZWxwZXIuaGFuZGxlU3ViamVjdENoYW5nZShzdWJqZWN0KTtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgcmVuZGVyZWRPbjogRGF0ZS5ub3coKSB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXRzIHRoZSBlbmFibGUvZGlzYWJsZSBzdGF0dXMgb2Ygc2VuZCBidXR0b24uXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBlbmFibGVEaXNhYmxlU2VuZEJ1dHRvbigpIHtcclxuICAgICAgICBsZXQgY3VycmVudFNlbmRCdXR0b25TdGF0dXNBZnRlckNoYW5nZTogYm9vbGVhbiA9IHRydWU7XHJcbiAgICAgICAgbGV0IGFjdGl2ZUVkaXRvcmdldENvbnRlbnRMZW5ndGggOiBudW1iZXIgPSAwO1xyXG4gICAgICAgIC8vIGlmIHNlbmRpbmcgbWVzc2FnZSBpcyBpbiBwcm9ncmVzcyBubyBuZWVkIHRvIGV4ZWN1dGUgbG9naWMgdG8gZW5hYmxpbmcvIGRpc2FibGluZyBidXR0b25cclxuICAgICAgICBpZiAoIXRoaXMuc2VuZE1lc3NhZ2VBY3Rpb25JblByb2dyZXNzKSB7XHJcbiAgICAgICAgICAgIGxldCBhY3RpdmVFZGl0b3IgPSB0aW55bWNlLmdldCh0aGlzLm1zZ0VkaXRvcklkKTtcclxuICAgICAgICAgICAgLy9EZWZlY3QgSWQ6NDgyNzcgRmlyc3QgdGltZSBhY3RpdmUgRWRpdG9yIGRvZXMgbm90IGNvbnRhaW5zICdCb2R5JyBUaGVuIHRocm93cyBleGNlcHRpb24gJ0JvZHkgVW5kZWZpbmVkJ1xyXG4gICAgICAgICAgICBpZiAoYWN0aXZlRWRpdG9yICYmIGFjdGl2ZUVkaXRvci5jb250ZW50RG9jdW1lbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgYWN0aXZlRWRpdG9yZ2V0Q29udGVudExlbmd0aCA9IGFjdGl2ZUVkaXRvci5nZXRDb250ZW50KHsgZm9ybWF0OiAndGV4dCcgfSkudHJpbSgpLmxlbmd0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5tZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hDb21wb3NlIHx8XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLm1lc3NhZ2VUeXBlID09PSBlbnVtcy5NZXNzYWdlVHlwZS5SZXNwb25zZUNvbXBvc2VcclxuICAgICAgICAgICAgICAgIHx8IHRoaXMucHJvcHMubWVzc2FnZVR5cGUgPT09IGVudW1zLk1lc3NhZ2VUeXBlLldvcmtsaXN0Q29tcG9zZSB8fFxyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5tZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuUmVzcG9uc2VSZXBseVxyXG4gICAgICAgICAgICAgICAgfHwgdGhpcy5wcm9wcy5tZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuUmVzcG9uc2VGb3J3YXJkIHx8XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLm1lc3NhZ2VUeXBlID09PSBlbnVtcy5NZXNzYWdlVHlwZS5UZWFtQ29tcG9zZSkge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFNlbmRCdXR0b25TdGF0dXNBZnRlckNoYW5nZSA9ICEodGhpcy5tZXNzYWdlU3ViamVjdC50cmltKCkubGVuZ3RoID4gMCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICh0aGlzLnRvRmllbGRJZHMgJiYgdGhpcy50b0ZpZWxkSWRzLmxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgICAgICAgICAgJiYgKHRoaXMudG9GaWVsZFZhbHVlcyAmJiB0aGlzLnRvRmllbGRWYWx1ZXMubGVuZ3RoID4gMClcclxuICAgICAgICAgICAgICAgICAgICAmJiAoYWN0aXZlRWRpdG9yZ2V0Q29udGVudExlbmd0aCAgPiAwIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VIZWxwZXIuX2lzUGFzdGVFbmFibGVkKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5tZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hGb3J3YXJkIHx8XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLm1lc3NhZ2VUeXBlID09PSBlbnVtcy5NZXNzYWdlVHlwZS5JbmJveFJlcGx5KSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50U2VuZEJ1dHRvblN0YXR1c0FmdGVyQ2hhbmdlID0gISh0aGlzLm1lc3NhZ2VTdWJqZWN0LnRyaW0oKS5sZW5ndGggPiAwXHJcbiAgICAgICAgICAgICAgICAgICAgJiYgKHRoaXMudG9GaWVsZElkcyAmJiB0aGlzLnRvRmllbGRJZHMubGVuZ3RoID4gMClcclxuICAgICAgICAgICAgICAgICAgICAmJiAodGhpcy50b0ZpZWxkVmFsdWVzICYmIHRoaXMudG9GaWVsZFZhbHVlcy5sZW5ndGggPiAwKVxyXG4gICAgICAgICAgICAgICAgICAgICYmIHRoaXMuc2VsZWN0ZWRRaWdJdGVtSWQgPiAxXHJcbiAgICAgICAgICAgICAgICAgICAgJiYgKGFjdGl2ZUVkaXRvcmdldENvbnRlbnRMZW5ndGggID4gMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB8fCBtZXNzYWdlSGVscGVyLl9pc1Bhc3RlRW5hYmxlZCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gZGlzYWJsZSBzZW5kIGJ1dHRvbiB3aGVuIHNlbmQgbWVzc2FnZSBhY3Rpb24gaXMgaW4gcHJvZ3Jlc3MgaWYgdGhlIGFwcGxpY2F0aW9uIGlzIG9ubGluZVxyXG4gICAgICAgICAgICBjdXJyZW50U2VuZEJ1dHRvblN0YXR1c0FmdGVyQ2hhbmdlID0gYXBwbGljYXRpb25TdG9yZS5pbnN0YW5jZS5pc09ubGluZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmlzU2VuZEJ1dHRvbkRpc2FibGVkICE9PSBjdXJyZW50U2VuZEJ1dHRvblN0YXR1c0FmdGVyQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNTZW5kQnV0dG9uRGlzYWJsZWQgPSBjdXJyZW50U2VuZEJ1dHRvblN0YXR1c0FmdGVyQ2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgLy8gSXQgaXMgbm90aWNlZCBkdWUgdG8gcmVuZGVyIGluIHNhbWUgdGltZSwgc3RhdGUgY2hhbmdlIG5vdCBoYXBwZW5pbmcuIEFkZCBzb21lIGV4dHJhIHRpbWUgZm9yIHJlbmRlcmluZy5cclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHJlbmRlcmVkT246IERhdGUubm93KCkgICsgMTAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBSZXNldCBzZXRQYXN0ZUVuYWJsZWRBY3Rpb24gYXMgZmFsc2UgYWZ0ZXIgdGhlIHBhc3RlIGFjdGlvbiBmaXJlZC5cclxuICAgICAgICBtZXNzYWdlSGVscGVyLnNldFBhc3RlRW5hYmxlZEFjdGlvbihmYWxzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBFbmFibGUgYW5kIGRpc2FibGUgc2VuZCBidXR0b24gb24gdGlueU1DRSBlZGl0b3IgY2hhbmdlLlxyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgdG9nZ2xlU2F2ZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuZW5hYmxlRGlzYWJsZVNlbmRCdXR0b24oKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNZXRob2QgZmlyZWQgd2hlbiB0aGUgbWVzc2FnZSBwYW5lbCBpcyBtaW5pbWl6ZWQuXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBvbk1pbmltaXplID0gKCkgPT4ge1xyXG4gICAgICAgIG1lc3NhZ2luZ0FjdGlvbkNyZWF0b3IubWVzc2FnZUFjdGlvbihlbnVtcy5NZXNzYWdlVmlld0FjdGlvbi5NaW5pbWl6ZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWV0aG9kIGZpcmVkIHdoZW4gdGhlIG1lc3NhZ2UgcGFuZWwgaXMgbWF4aW1pemVkLlxyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgb25NYXhpbWl6ZSA9ICgpID0+IHtcclxuICAgICAgICBtZXNzYWdpbmdBY3Rpb25DcmVhdG9yLm1lc3NhZ2VBY3Rpb24oZW51bXMuTWVzc2FnZVZpZXdBY3Rpb24uTWF4aW1pemUpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgY2FsbCBvbiBtZXNzYWdlIHNlbmQgYnV0dG9uIGNsaWNrXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBvbk1lc3NhZ2VTZW5kID0gKG1lc3NhZ2VUeXBlOiBlbnVtcy5NZXNzYWdlVHlwZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuZW5hYmxlRGlzYWJsZVNlbmRCdXR0b24oKTtcclxuICAgICAgICBsZXQgY2FuZGlkYXRlU2NyaXB0SWQ6IG51bWJlciA9IHVuZGVmaW5lZDtcclxuICAgICAgICBsZXQgbWFya0dyb3VwSWQ6IG51bWJlciA9IHVuZGVmaW5lZDtcclxuICAgICAgICBsZXQgZXNNYXJrR3JvdXBJZDogbnVtYmVyID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZUJvZHkgPSB0aW55bWNlLmdldCh0aGlzLm1zZ0VkaXRvcklkKS5nZXRDb250ZW50KCk7XHJcbiAgICAgICAgc3dpdGNoIChtZXNzYWdlVHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLlJlc3BvbnNlQ29tcG9zZTpcclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5NZXNzYWdlVHlwZS5SZXNwb25zZVJlcGx5OlxyXG4gICAgICAgICAgICBjYXNlIGVudW1zLk1lc3NhZ2VUeXBlLlJlc3BvbnNlRm9yd2FyZDpcclxuICAgICAgICAgICAgICAgIC8vIHNlbGVjdGVkIFFpZyBpZCBmb3IgY29tcG9zZSBtZXNzYWdlIGluIHJlc3BvbnNlIHNjcmVlblxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFFpZ0l0ZW1JZCA9IHFpZ1N0b3JlLmluc3RhbmNlLnNlbGVjdGVkUUlHRm9yTWFya2VyT3BlcmF0aW9uLm1hcmtTY2hlbWVHcm91cElkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5xdWVzdGlvblBhcGVyUGFydElkID0gcWlnU3RvcmUuaW5zdGFuY2Uuc2VsZWN0ZWRRSUdGb3JNYXJrZXJPcGVyYXRpb24ucXVlc3Rpb25QYXBlclBhcnRJZDtcclxuICAgICAgICAgICAgICAgIGxldCBvcGVuZWRSZXNwb25zZURldGFpbHMgPSB0aGlzLnByb3BzLnJlc3BvbnNlSWQgP1xyXG4gICAgICAgICAgICAgICAgICAgIG1hcmtlck9wZXJhdGlvbk1vZGVGYWN0b3J5Lm9wZXJhdGlvbk1vZGUub3BlbmVkUmVzcG9uc2VEZXRhaWxzKHRoaXMucHJvcHMucmVzcG9uc2VJZC50b1N0cmluZygpKSA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICBsZXQgaXNFc1Jlc3BvbnNlOiBib29sZWFuID0gKHdvcmtsaXN0U3RvcmUuaW5zdGFuY2UuY3VycmVudFdvcmtsaXN0VHlwZSA9PT0gZW51bXMuV29ya2xpc3RUeXBlLnN0YW5kYXJkaXNhdGlvblxyXG4gICAgICAgICAgICAgICAgICAgIHx8IHdvcmtsaXN0U3RvcmUuaW5zdGFuY2UuY3VycmVudFdvcmtsaXN0VHlwZSA9PT0gZW51bXMuV29ya2xpc3RUeXBlLnByYWN0aWNlIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgd29ya2xpc3RTdG9yZS5pbnN0YW5jZS5jdXJyZW50V29ya2xpc3RUeXBlID09PSBlbnVtcy5Xb3JrbGlzdFR5cGUuc2Vjb25kc3RhbmRhcmRpc2F0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgfHwgbWFya2VyT3BlcmF0aW9uTW9kZUZhY3Rvcnkub3BlcmF0aW9uTW9kZS5pc1N0YW5kYXJkaXNhdGlvblNldHVwTW9kZSkgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpZiAob3BlbmVkUmVzcG9uc2VEZXRhaWxzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FuZGlkYXRlU2NyaXB0SWQgPSBvcGVuZWRSZXNwb25zZURldGFpbHMuY2FuZGlkYXRlU2NyaXB0SWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtlck9wZXJhdGlvbk1vZGVGYWN0b3J5Lm9wZXJhdGlvbk1vZGUuaXNTdGFuZGFyZGlzYXRpb25TZXR1cE1vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXNNYXJrR3JvdXBJZCA9IG9wZW5lZFJlc3BvbnNlRGV0YWlscy5lc01hcmtHcm91cElkO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtHcm91cElkID0gaXNFc1Jlc3BvbnNlID8gdW5kZWZpbmVkIDogb3BlbmVkUmVzcG9uc2VEZXRhaWxzLm1hcmtHcm91cElkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlc01hcmtHcm91cElkID0gaXNFc1Jlc3BvbnNlID8gb3BlbmVkUmVzcG9uc2VEZXRhaWxzLm1hcmtHcm91cElkIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAvLyBOb3Qgc2V0dGluZyBjYW5kaWRhdGVTY3JpcHRJZCwgbWFya0dyb3VwSWQsIGVzTWFya0dyb3VwSWQgaWYgY29tcG9zaW5nIG1lc3NhZ2UgZnJvbSByZXNwb25zZSBhbmQgd29ya2xpc3RcclxuICAgICAgICAgICAgLy8gc2luY2Ugbm90IGFzc29jaWF0ZWQgd2l0aCBhbnkgcGFydGljdWxhciByZXNwb25zZS5cclxuICAgICAgICAgICAgY2FzZSBlbnVtcy5NZXNzYWdlVHlwZS5JbmJveENvbXBvc2U6XHJcbiAgICAgICAgICAgIGNhc2UgZW51bXMuTWVzc2FnZVR5cGUuV29ya2xpc3RDb21wb3NlOlxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudE1lc3NhZ2VEZXRhaWxzOiBNZXNzYWdlRGV0YWlscyA9IHRoaXMucHJvcHMuc2VsZWN0ZWRNc2dEZXRhaWxzO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWVzc2FnZURldGFpbHMgIT09IHVuZGVmaW5lZCAmJiBjdXJyZW50TWVzc2FnZURldGFpbHMgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYW5kaWRhdGVTY3JpcHRJZCA9IGN1cnJlbnRNZXNzYWdlRGV0YWlscy5jYW5kaWRhdGVTY3JpcHRJZDtcclxuICAgICAgICAgICAgICAgICAgICBtYXJrR3JvdXBJZCA9IGN1cnJlbnRNZXNzYWdlRGV0YWlscy5tYXJrR3JvdXBJZDtcclxuICAgICAgICAgICAgICAgICAgICBlc01hcmtHcm91cElkID0gY3VycmVudE1lc3NhZ2VEZXRhaWxzLmVzTWFya0dyb3VwSWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGZldGNoaW5nIGN1cnJlbnRseSBzZWxlY3RlZCBxaWcncyBleGFtaW5lciByb2xlSWRcclxuICAgICAgICBsZXQgZXhhbWluZXJSb2xlSWQ6IG51bWJlciA9IDA7XHJcbiAgICAgICAgbGV0IG1zZyA9IG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS5tZXNzYWdlc01hcmtTY2hlbWVzO1xyXG4gICAgICAgIGlmIChtc2cpIHtcclxuICAgICAgICAgICAgbXNnLmZvckVhY2goKG1lc3NhZ2U6IE1lc3NhZ2luZ01hcmtTY2hlbWUpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlLm1hcmtTY2hlbWVHcm91cElkID09PSB0aGlzLnNlbGVjdGVkUWlnSXRlbUlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXhhbWluZXJSb2xlSWQgPSBtZXNzYWdlLmV4YW1pbmVyUm9sZUlkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHRvVGVhbTogYm9vbGVhbiA9IG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscyA/IG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscy50ZWFtLnRvVGVhbSA6IGZhbHNlO1xyXG4gICAgICAgIG1lc3NhZ2luZ0FjdGlvbkNyZWF0b3Iuc2VuZEV4YW1pbmVyTWVzc2FnZSh0aGlzLnRvRmllbGRJZHMsXHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJvZHksXHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZVN1YmplY3QsXHJcbiAgICAgICAgICAgIHRoaXMucXVlc3Rpb25QYXBlclBhcnRJZCxcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5yZXNwb25zZUlkLFxyXG4gICAgICAgICAgICB0aGlzLnByaW9yaXR5RHJvcERvd25TZWxlY3RlZEl0ZW0sXHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRRaWdJdGVtSWQsXHJcbiAgICAgICAgICAgIGNhbmRpZGF0ZVNjcmlwdElkLFxyXG4gICAgICAgICAgICBtYXJrR3JvdXBJZCxcclxuICAgICAgICAgICAgZXNNYXJrR3JvdXBJZCxcclxuICAgICAgICAgICAgdG9UZWFtLFxyXG4gICAgICAgICAgICBleGFtaW5lclJvbGVJZCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogTmF2aWdhdGluZyBhd2F5IGZyb20gbWVzc2FnZSBwYW5lbCB3aGVuIHRoZSBwb3AgdXAgaXMgb3BlbmVkXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBvbk5hdmlnYXRlRnJvbU1lc3NhZ2VQYW5lbCA9IChtZXNzYWdlTmF2aWdhdGlvbkFyZ3VtZW50czogTWVzc2FnZU5hdmlnYXRpb25Bcmd1bWVudHMpID0+IHtcclxuICAgICAgICBpZiAobWVzc2FnZU5hdmlnYXRpb25Bcmd1bWVudHMuaGFzTWVzc2FnZUNvbnRhaW5zRGlydHlWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIC8vIFNob3VsZCBiZSBwb3NzaWJsZSB0byBvcGVuIHRoZSByZXNwb25zZSwgSWYgdGhlIG1lc3NhZ2UgY29tcG9zZWQgZnJvbSBUZWFtIG1hbmFnZW1lbnRcclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNNZXNzYWdlUGFuZWxFZGl0ZWQpIHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2luZ0FjdGlvbkNyZWF0b3IubWVzc2FnZUFjdGlvbihlbnVtcy5NZXNzYWdlVmlld0FjdGlvbi5NYXhpbWl6ZSk7XHJcbiAgICAgICAgICAgICAgICAvLyBUbyBtYXhpbWlzZSB0aGUgbWVzc2FnZSBwYW5lbCB3aGVuIHRoZSBkaXNjYXJkIHBvcHVwIGlzIHNob3duXHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzTWVzc2FnZVBvcHVwTWluaW1pemVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgcmVuZGVyZWRPbjogRGF0ZS5ub3coKSB9KTtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VOYXZpZ2F0aW9uQXJndW1lbnRzLmhhc01lc3NhZ2VDb250YWluc0RpcnR5VmFsdWUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnaW5nQWN0aW9uQ3JlYXRvci5jYW5NZXNzYWdlTmF2aWdhdGUobWVzc2FnZU5hdmlnYXRpb25Bcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFtZXNzYWdlTmF2aWdhdGlvbkFyZ3VtZW50cy5jYW5OYXZpZ2F0ZSkge1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnaW5nQWN0aW9uQ3JlYXRvci5tZXNzYWdlQWN0aW9uKGVudW1zLk1lc3NhZ2VWaWV3QWN0aW9uLkNsb3NlKTtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VOYXZpZ2F0aW9uQXJndW1lbnRzLmhhc01lc3NhZ2VDb250YWluc0RpcnR5VmFsdWUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlTmF2aWdhdGlvbkFyZ3VtZW50cy5uYXZpZ2F0ZVRvID09PSBlbnVtcy5NZXNzYWdlTmF2aWdhdGlvbi5uZXdFeGNlcHRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlVG8gPSBlbnVtcy5TYXZlQW5kTmF2aWdhdGUubmV3RXhjZXB0aW9uQnV0dG9uQ2xpY2s7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1lc3NhZ2VOYXZpZ2F0aW9uQXJndW1lbnRzLm5hdmlnYXRlVG8gPT09IGVudW1zLk1lc3NhZ2VOYXZpZ2F0aW9uLmV4Y2VwdGlvbldpdGhJblJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZVRvID0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLmV4Y2VwdGlvbldpdGhJblJlc3BvbnNlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtZXNzYWdlTmF2aWdhdGlvbkFyZ3VtZW50cy5uYXZpZ2F0ZVRvID09PSBlbnVtcy5NZXNzYWdlTmF2aWdhdGlvbi5uZXdFeGNlcHRpb25Gcm9tTWVkaWFFcnJvckRpYWxvZykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGVUbyA9IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5uZXdFeGNlcHRpb25Gcm9tTWVkaWFFcnJvckRpYWxvZztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRBbmRDbG9zZU1lc3NhZ2VQYW5lbCgpO1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZU5hdmlnYXRpb25Bcmd1bWVudHMuY2FuTmF2aWdhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnaW5nQWN0aW9uQ3JlYXRvci5jYW5NZXNzYWdlTmF2aWdhdGUobWVzc2FnZU5hdmlnYXRpb25Bcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChtZXNzYWdlTmF2aWdhdGlvbkFyZ3VtZW50cy5oYXNNZXNzYWdlQ29udGFpbnNEaXJ0eVZhbHVlICYmIG1lc3NhZ2VOYXZpZ2F0aW9uQXJndW1lbnRzLmNhbk5hdmlnYXRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNNZXNzYWdlUG9wdXBNaW5pbWl6ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKG1lc3NhZ2VOYXZpZ2F0aW9uQXJndW1lbnRzLm5hdmlnYXRlVG8gPT09IGVudW1zLk1lc3NhZ2VOYXZpZ2F0aW9uLm5ld0V4Y2VwdGlvbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZVRvID0gZW51bXMuU2F2ZUFuZE5hdmlnYXRlLm5ld0V4Y2VwdGlvbkJ1dHRvbkNsaWNrO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1lc3NhZ2VOYXZpZ2F0aW9uQXJndW1lbnRzLm5hdmlnYXRlVG8gPT09IGVudW1zLk1lc3NhZ2VOYXZpZ2F0aW9uLmV4Y2VwdGlvbldpdGhJblJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlVG8gPSBlbnVtcy5TYXZlQW5kTmF2aWdhdGUuZXhjZXB0aW9uV2l0aEluUmVzcG9uc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWVzc2FnZU5hdmlnYXRpb25Bcmd1bWVudHMubmF2aWdhdGVUbyA9PT0gZW51bXMuTWVzc2FnZU5hdmlnYXRpb24ubmV3RXhjZXB0aW9uRnJvbU1lZGlhRXJyb3JEaWFsb2cpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGVUbyA9IGVudW1zLlNhdmVBbmROYXZpZ2F0ZS5uZXdFeGNlcHRpb25Gcm9tTWVkaWFFcnJvckRpYWxvZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnJlc2V0QW5kQ2xvc2VNZXNzYWdlUGFuZWwoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogY2hlY2tzIHdoZXRoZXIgdGhlIHN1cGVydmlzb3IgZXhhbWluZXIgaXMgdmFsaWQgdG8gc2VuZCBhIG1lc3NhZ2Ugb3Igbm90XHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBtZXNzYWdlU2VuZFZhbGlkYXRpb25DaGVjayA9IChtZXNzYWdlVHlwZTogZW51bXMuTWVzc2FnZVR5cGUpID0+IHtcclxuICAgICAgICB0aGlzLnNlbmRNZXNzYWdlQWN0aW9uSW5Qcm9ncmVzcyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlVHlwZSA9IG1lc3NhZ2VUeXBlO1xyXG4gICAgICAgIC8vIFdoaWxlIGluIFNFUCB2aWV3IHdlIG5lZWQgdG8gY2hlY2sgd2hldGhlciB0aGUgc3VwZXJ2aXNvciBleGFtaW5lciBpcyB2YWxpZCB0byBzZW5kIGEgbWVzc2FnZSB0byBzdWJvcmRpbmF0ZSBleGFtaW5lclxyXG4gICAgICAgIGlmIChtYXJrZXJPcGVyYXRpb25Nb2RlRmFjdG9yeS5vcGVyYXRpb25Nb2RlLmlzSGVscEV4YW1pbmVyc1ZpZXcpIHtcclxuICAgICAgICAgICAgdGhpcy5lbmFibGVEaXNhYmxlU2VuZEJ1dHRvbigpO1xyXG4gICAgICAgICAgICBsZXQgZGF0YUNvbGxlY3Rpb246IEFycmF5PEV4YW1pbmVyRm9yU0VQQWN0aW9uPiA9IG5ldyBBcnJheTxFeGFtaW5lckZvclNFUEFjdGlvbj4oKTtcclxuICAgICAgICAgICAgbGV0IGV4YW1pbmVyU0VQQWN0aW9uOiBFeGFtaW5lckZvclNFUEFjdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgIGV4YW1pbmVyUm9sZUlkOiBxaWdTdG9yZS5pbnN0YW5jZS5zZWxlY3RlZFFJR0Zvck1hcmtlck9wZXJhdGlvbi5leGFtaW5lclJvbGVJZCxcclxuICAgICAgICAgICAgICAgIG1hcmtTY2hlbWVHcm91cElkOiBxaWdTdG9yZS5pbnN0YW5jZS5nZXRTZWxlY3RlZFFJR0ZvclRoZUxvZ2dlZEluVXNlci5tYXJrU2NoZW1lR3JvdXBJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5RXhhbWluZXJSb2xlSWQ6IHFpZ1N0b3JlLmluc3RhbmNlLmdldFNlbGVjdGVkUUlHRm9yVGhlTG9nZ2VkSW5Vc2VyLmV4YW1pbmVyUm9sZUlkXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGRhdGFDb2xsZWN0aW9uLnB1c2goZXhhbWluZXJTRVBBY3Rpb24pO1xyXG4gICAgICAgICAgICBsZXQgZXhhbWluZXJTRVBBY3Rpb25zID0gSW1tdXRhYmxlLkxpc3Q8RXhhbWluZXJGb3JTRVBBY3Rpb24+KGRhdGFDb2xsZWN0aW9uKTtcclxuICAgICAgICAgICAgbGV0IGRvU0VQQXBwcm92YWxNYW5hZ2VtZW50QWN0aW9uQXJndW1lbnQ6IERvU0VQQXBwcm92YWxNYW5hZ2VtZW50QWN0aW9uQXJndW1lbnQgPSB7XHJcbiAgICAgICAgICAgICAgICBhY3Rpb25JZGVudGlmaWVyOiBlbnVtcy5TRVBBY3Rpb24uU2VuZE1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICBleGFtaW5lcnM6IGV4YW1pbmVyU0VQQWN0aW9uc1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0ZWFtTWFuYWdlbWVudEFjdGlvbkNyZWF0b3IuRXhlY3V0ZUFwcHJvdmFsTWFuYWdlbWVudEFjdGlvbihkb1NFUEFwcHJvdmFsTWFuYWdlbWVudEFjdGlvbkFyZ3VtZW50KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm9uTWVzc2FnZVNlbmQodGhpcy5tZXNzYWdlVHlwZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFRvIGNoZWNrIHdoZXRoZXIgdGhlIGV4YW1pbmVyIGlzIHZhbGlkIHRvIHNlbmQgYSBtZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBleGFtaW5lclZhbGlkYXRpb24gPSAoYWN0aW9uSWRlbnRpZmllcjogbnVtYmVyKSA9PiB7XHJcblxyXG4gICAgICAgIC8vIE5vIG5lZWQgdG8gaGFuZGxlLCBJZiB1c2VyIGNsaWNrcyBoZWxwIGV4YW1pbmVycyBhbmQgaW1taWRpZXRseSBuYXZpZ2F0ZWQgdG8gaW5ib3hcclxuICAgICAgICBpZiAodGhpcy5wcm9wcy5tZXNzYWdlVHlwZSA9PT0gZW51bXMuTWVzc2FnZVR5cGUuSW5ib3hDb21wb3NlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIElmIHRoZXJlIGlzIG5vIGZhaWx1cmUgY29kZSB0aGVuIHRoZSBzdXBlcnZpc29yIGV4YW1pbmVyIGlzIHZhbGlkIHRvIHNlbmQgYSBtZXNzYWdlXHJcbiAgICAgICAgaWYgKGFjdGlvbklkZW50aWZpZXIgPT09IGVudW1zLlNFUEFjdGlvbi5TZW5kTWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbk1lc3NhZ2VTZW5kKHRoaXMubWVzc2FnZVR5cGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBlbmFibGUgc2VuZCBidXR0b24gc3RhdGUgb24gb2ZmbGluZVxyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgb25PbmxpbmVTdGF0dXNDaGFuZ2VkID0gKCkgPT4ge1xyXG4gICAgICAgIGlmICghYXBwbGljYXRpb25TdG9yZS5pbnN0YW5jZS5pc09ubGluZSkge1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVNhdmVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9O1xyXG59XHJcbmV4cG9ydCA9IE1lc3NhZ2VCYXNlO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL34vc291cmNlLW1hcC1sb2FkZXIhLi9zcmMvY29tcG9uZW50cy9tZXNzYWdlL21lc3NhZ2ViYXNlLnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQUE7QUE2QkE7O0FBRUE7QUFDQTtBQUFBO0FBbkJBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBc0JBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBSUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBU0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbURBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVlBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFsY0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBMExBO0FBSEE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUFBO0FBc0JBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQTRMQTtBQUFBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ }),

/***/ 463:
/* no static exports found */
/* all exports used */
/*!**************************************************!*\
  !*** ./src/components/message/messageeditor.tsx ***!
  \**************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar React = __webpack_require__(/*! react */ 0);\r\nvar pureRenderComponent = __webpack_require__(/*! ../base/purerendercomponent */ 227);\r\nvar TINYMCE = __webpack_require__(/*! react-tinymce */ 45);\r\nvar messageStore = __webpack_require__(/*! ../../stores/message/messagestore */ 240);\r\nvar htmlUtilities = __webpack_require__(/*! ../../utility/generic/htmlutilities */ 243);\r\nvar urls = __webpack_require__(/*! ../../dataservices/base/urls */ 266);\r\nvar messageEditorConstants = __webpack_require__(/*! ../utility/messageeditorconstants */ 325);\r\nvar localeHelper = __webpack_require__(/*! ../../utility/locale/localehelper */ 281);\r\nvar messageHelper = __webpack_require__(/*! ../utility/message/messagehelper */ 283);\r\nvar MessageEditor = /** @class */ (function (_super) {\r\n    __extends(MessageEditor, _super);\r\n    /**\r\n     * Constructor messageeditor\r\n     * @param props\r\n     * @param state\r\n     */\r\n    function MessageEditor(props, state) {\r\n        var _this = _super.call(this, props, state) || this;\r\n        _this.isEditorInitialised = false;\r\n        _this.lastTap = 0;\r\n        _this.contentStyle = htmlUtilities.isIPadDevice ?\r\n            '.mce-content-body{word-break: break-word;font-family:' + messageEditorConstants.TINYMCE_DEFAULT_FONT +\r\n                '; font-size:' + messageEditorConstants.TINYMCE_DEFAULT_FONTSIZE + '; list-style-position: inside;}' + 'p{ margin:0; padding:0;}'\r\n            : htmlUtilities.isIE ? '.mce-content-body{font-family:' + messageEditorConstants.TINYMCE_DEFAULT_FONT +\r\n                '; font-size:' + messageEditorConstants.TINYMCE_DEFAULT_FONTSIZE + ';} p{ margin:0; padding:0;}' :\r\n                '.mce-content-body{font-family:' + messageEditorConstants.TINYMCE_DEFAULT_FONT +\r\n                    '; font-size:' + messageEditorConstants.TINYMCE_DEFAULT_FONTSIZE + '; list-style-position: inside; } p{ margin:0; padding:0;}';\r\n        /**\r\n         * This will block the double-tap zoom in ipad\r\n         */\r\n        _this.blockDoubleTapZoom = function (e) {\r\n            var currentTime = new Date().getTime();\r\n            var tapLength = currentTime - _this.lastTap;\r\n            if (tapLength < 500 && tapLength > 0) {\r\n                e.preventDefault();\r\n            }\r\n            _this.lastTap = currentTime;\r\n        };\r\n        /**\r\n         * This will block the pinch-to-zoom in ipad\r\n         */\r\n        _this.blockPinchToZoom = function (e) {\r\n            if (e.touches.length > 1) {\r\n                e.preventDefault();\r\n            }\r\n        };\r\n        _this.onKeyup = function (o, e) {\r\n            _this.props.toggleSaveButtonState();\r\n        };\r\n        _this.onEditorInit = function (o, e) {\r\n            _this.activeEditor.on('SetContent', _this.onSetContent);\r\n            // Set the height of the iFrame section in the tiny mce as 100% for supporting the height calculation in css.\r\n            document.getElementById('msg-tinymce-editor_ifr').style.height = '100%';\r\n            if (htmlUtilities.isIPadDevice) {\r\n                document.getElementById('msg-tinymce-editor_ifr').setAttribute('scrolling', 'no');\r\n            }\r\n            _this.isEditorInitialised = true;\r\n            if (htmlUtilities.isIPadDevice && htmlUtilities.getUserDevice().browser === 'Safari') {\r\n                e.getWin().document.documentElement.addEventListener('touchend', _this.blockDoubleTapZoom);\r\n                e.getWin().document.documentElement.addEventListener('touchstart', _this.blockPinchToZoom);\r\n            }\r\n        };\r\n        _this.onRemove = function (o, e) {\r\n            if (htmlUtilities.isIPadDevice && htmlUtilities.getUserDevice().browser === 'Safari') {\r\n                e.getWin().document.documentElement.removeEventListener('touchend', _this.blockDoubleTapZoom);\r\n                e.getWin().document.documentElement.removeEventListener('touchstart', _this.blockPinchToZoom);\r\n            }\r\n        };\r\n        /**\r\n         * Simulate window click while clicking on tinyMCE editor to close opened priority drop down and user option panel.\r\n         */\r\n        _this.onClick = function (o, e) {\r\n            // we have to close opened priority drop down and user options (logout options) while clicking on outside that. TinyMCE editor was\r\n            // preventing the click event to propagate outside so closing of those things are not happening while clicking on TinyMCE editor.\r\n            var event = document.createEvent('MouseEvents');\r\n            event.initMouseEvent('click', true, true, window, 0, 0, 0, 80, 20, false, false, false, false, 0, null);\r\n            window.dispatchEvent(event);\r\n        };\r\n        _this.onPaste = function (o, e) {\r\n            // find the clipboard data from any possible (window.clipboarddata is for ie)\r\n            var clipBoardData = (o.clipboardData || window.clipboardData ||\r\n                (o.originalEvent && o.originalEvent.clipboardData));\r\n            // set getdata argument - 'text' is only for ie11 and other device/browsers need 'text/plain'\r\n            var getDataArgument = htmlUtilities.isIE11 ? 'text' : 'text/plain';\r\n            // If you paste text into the editor with mouse by right- click\r\n            // TinyMCE's onPaste event is fired, but text is not available via .getContent().\r\n            // So that checking the clipboard data item when the user pasting the text via mouse by right- click.\r\n            if (clipBoardData && clipBoardData.getData(getDataArgument).trim() !== '') {\r\n                messageHelper.setPasteEnabledAction(true);\r\n            }\r\n            _this.props.toggleSaveButtonState();\r\n        };\r\n        /**\r\n         * This method will enable the send button when hyperlink is added.\r\n         */\r\n        _this.onSetContent = function (e) {\r\n            _this.props.toggleSaveButtonState();\r\n        };\r\n        /**\r\n         * This method will clear tinyMCE content\r\n         */\r\n        _this.onMessagePanelClose = function () {\r\n            _this.activeEditor.setContent('');\r\n        };\r\n        /**\r\n         * This method will set focus to tinyMCE editor\r\n         */\r\n        _this.setFocus = function () {\r\n            if (_this.state.scriptLoaded) {\r\n                if (_this.activeEditor && _this.isEditorInitialised && _this.props.hasFocus) {\r\n                    // this will set dom focus to tinymce editor\r\n                    _this.activeEditor.focus();\r\n                }\r\n            }\r\n        };\r\n        //initialize state\r\n        _this.state = {\r\n            scriptLoaded: false,\r\n            renderedOn: 0\r\n        };\r\n        _this.onRemove = _this.onRemove.bind(_this);\r\n        _this.onEditorInit = _this.onEditorInit.bind(_this);\r\n        _this.onSetContent = _this.onSetContent.bind(_this);\r\n        return _this;\r\n    }\r\n    /**\r\n     * Component did mount\r\n     */\r\n    MessageEditor.prototype.componentDidMount = function () {\r\n        messageStore.instance.addListener(messageStore.MessageStore.MESSAGE_CLOSE_EVENT, this.onMessagePanelClose);\r\n        this.setFocus();\r\n    };\r\n    /**\r\n     * Component will mount\r\n     */\r\n    MessageEditor.prototype.componentWillMount = function () {\r\n        var url = htmlUtilities.getFullUrl(urls.TINYMCE_URL);\r\n        // If tinyMCE script is not loaded then load that\r\n        if (!htmlUtilities.isScriptLoaded(url)) {\r\n            var script = document.createElement('script');\r\n            script.src = url;\r\n            script.async = true;\r\n            script.onload = (this.dependenciesLoaded.bind(this));\r\n            document.body.appendChild(script);\r\n        }\r\n        else {\r\n            this.dependenciesLoaded();\r\n        }\r\n    };\r\n    /**\r\n     * component will unmount\r\n     */\r\n    MessageEditor.prototype.componentWillUnmount = function () {\r\n        messageStore.instance.removeListener(messageStore.MessageStore.MESSAGE_CLOSE_EVENT, this.onMessagePanelClose);\r\n        if (tinymce.get(this.props.id)) {\r\n            tinymce.remove('#' + this.props.id);\r\n        }\r\n    };\r\n    /**\r\n     * Component did update\r\n     */\r\n    MessageEditor.prototype.componentDidUpdate = function () {\r\n        this.setFocus();\r\n    };\r\n    /**\r\n     * Render component\r\n     */\r\n    MessageEditor.prototype.render = function () {\r\n        if (this.state.scriptLoaded) {\r\n            var selectedLang = localeHelper.getAwardingBodyLocale(this.props.selectedLanguage);\r\n            var editorConfig = {\r\n                menubar: false,\r\n                statusbar: false,\r\n                renderedOn: Date.now(),\r\n                plugins: messageEditorConstants.TINYMCE_PLUGINS,\r\n                toolbar: messageEditorConstants.TINYMCE_TOOLBAR,\r\n                fontsize_formats: messageEditorConstants.TINYMCE_FONTSIZES,\r\n                font_formats: messageEditorConstants.TINYMCE_FONTS,\r\n                language: selectedLang,\r\n                browser_spellcheck: true,\r\n                content_style: this.contentStyle,\r\n                default_link_target: '_blank',\r\n                target_list: false,\r\n                invalid_elements: 'embed'\r\n            };\r\n            return (React.createElement(TINYMCE, { content: this.props.htmlContent, id: this.props.id, theme: messageEditorConstants.TINYMCE_THEME, config: editorConfig, onKeyup: this.onKeyup, onPaste: this.onPaste, onInit: this.onEditorInit, onClick: this.onClick, onRemove: this.onRemove }));\r\n        }\r\n        else {\r\n            //show loading icon if script is not loaded\r\n            return (React.createElement(\"div\", null));\r\n        }\r\n    };\r\n    /**\r\n     * Method to load dependencies\r\n     */\r\n    MessageEditor.prototype.dependenciesLoaded = function () {\r\n        if (this.props.isTinyMCELoaded) {\r\n            this.props.isTinyMCELoaded(true);\r\n        }\r\n        this.setState({ scriptLoaded: true });\r\n    };\r\n    Object.defineProperty(MessageEditor.prototype, \"activeEditor\", {\r\n        /**\r\n         * This method will return the active editor\r\n         */\r\n        get: function () {\r\n            return tinymce.get(this.props.id);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return MessageEditor;\r\n}(pureRenderComponent));\r\nmodule.exports = MessageEditor;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDYzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWVzc2FnZS9tZXNzYWdlZWRpdG9yLnRzeD9iOWI5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XHJcbmltcG9ydCBSZWFjdERPTSA9IHJlcXVpcmUoJ3JlYWN0LWRvbScpO1xyXG5pbXBvcnQgcHVyZVJlbmRlckNvbXBvbmVudCA9IHJlcXVpcmUoJy4uL2Jhc2UvcHVyZXJlbmRlcmNvbXBvbmVudCcpO1xyXG5jb25zdCBUSU5ZTUNFID0gcmVxdWlyZSgncmVhY3QtdGlueW1jZScpO1xyXG5pbXBvcnQgbWVzc2FnZVN0b3JlID0gcmVxdWlyZSgnLi4vLi4vc3RvcmVzL21lc3NhZ2UvbWVzc2FnZXN0b3JlJyk7XHJcbmltcG9ydCBsb2NhbGVTdG9yZSA9IHJlcXVpcmUoJy4uLy4uL3N0b3Jlcy9sb2NhbGUvbG9jYWxlc3RvcmUnKTtcclxuaW1wb3J0IGh0bWxVdGlsaXRpZXMgPSByZXF1aXJlKCcuLi8uLi91dGlsaXR5L2dlbmVyaWMvaHRtbHV0aWxpdGllcycpO1xyXG5pbXBvcnQgdXJscyA9IHJlcXVpcmUoJy4uLy4uL2RhdGFzZXJ2aWNlcy9iYXNlL3VybHMnKTtcclxuaW1wb3J0IG1lc3NhZ2VFZGl0b3JDb25zdGFudHMgPSByZXF1aXJlKCcuLi91dGlsaXR5L21lc3NhZ2VlZGl0b3Jjb25zdGFudHMnKTtcclxuZGVjbGFyZSBsZXQgdGlueW1jZTogYW55O1xyXG5pbXBvcnQgbG9jYWxlSGVscGVyID0gcmVxdWlyZSgnLi4vLi4vdXRpbGl0eS9sb2NhbGUvbG9jYWxlaGVscGVyJyk7XHJcbmltcG9ydCBtZXNzYWdlSGVscGVyID0gcmVxdWlyZSgnLi4vdXRpbGl0eS9tZXNzYWdlL21lc3NhZ2VoZWxwZXInKTtcclxuXHJcbmludGVyZmFjZSBQcm9wcyBleHRlbmRzIFByb3BzQmFzZSwgTG9jYWxlU2VsZWN0aW9uQmFzZSB7XHJcbiAgICBodG1sQ29udGVudDogc3RyaW5nO1xyXG4gICAgaGFzRm9jdXM6IGJvb2xlYW47XHJcbiAgICB0b2dnbGVTYXZlQnV0dG9uU3RhdGU6IEZ1bmN0aW9uO1xyXG4gICAgaXNUaW55TUNFTG9hZGVkPzogRnVuY3Rpb247XHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgICBzY3JpcHRMb2FkZWQ/OiBib29sZWFuO1xyXG4gICAgcmVuZGVyZWRPbj86IG51bWJlcjtcclxufVxyXG5cclxuXHJcbmNsYXNzIE1lc3NhZ2VFZGl0b3IgZXh0ZW5kcyBwdXJlUmVuZGVyQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xyXG5cclxuICAgIHByaXZhdGUgaXNFZGl0b3JJbml0aWFsaXNlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSBsYXN0VGFwOiBudW1iZXIgPSAwO1xyXG4gICAgcHJpdmF0ZSBjb250ZW50U3R5bGU6IHN0cmluZyA9IGh0bWxVdGlsaXRpZXMuaXNJUGFkRGV2aWNlID9cclxuICAgICAgICAnLm1jZS1jb250ZW50LWJvZHl7d29yZC1icmVhazogYnJlYWstd29yZDtmb250LWZhbWlseTonICsgbWVzc2FnZUVkaXRvckNvbnN0YW50cy5USU5ZTUNFX0RFRkFVTFRfRk9OVCArXHJcbiAgICAgICAgJzsgZm9udC1zaXplOicgKyBtZXNzYWdlRWRpdG9yQ29uc3RhbnRzLlRJTllNQ0VfREVGQVVMVF9GT05UU0laRSArICc7IGxpc3Qtc3R5bGUtcG9zaXRpb246IGluc2lkZTt9JyArICdweyBtYXJnaW46MDsgcGFkZGluZzowO30nXHJcbiAgICAgICAgOiBodG1sVXRpbGl0aWVzLmlzSUUgPyAnLm1jZS1jb250ZW50LWJvZHl7Zm9udC1mYW1pbHk6JyArIG1lc3NhZ2VFZGl0b3JDb25zdGFudHMuVElOWU1DRV9ERUZBVUxUX0ZPTlQgK1xyXG4gICAgICAgICAgICAnOyBmb250LXNpemU6JyArIG1lc3NhZ2VFZGl0b3JDb25zdGFudHMuVElOWU1DRV9ERUZBVUxUX0ZPTlRTSVpFICsgJzt9IHB7IG1hcmdpbjowOyBwYWRkaW5nOjA7fScgOlxyXG4gICAgICAgICAgICAnLm1jZS1jb250ZW50LWJvZHl7Zm9udC1mYW1pbHk6JyArIG1lc3NhZ2VFZGl0b3JDb25zdGFudHMuVElOWU1DRV9ERUZBVUxUX0ZPTlQgK1xyXG4gICAgICAgICAgICAnOyBmb250LXNpemU6JyArIG1lc3NhZ2VFZGl0b3JDb25zdGFudHMuVElOWU1DRV9ERUZBVUxUX0ZPTlRTSVpFICsgJzsgbGlzdC1zdHlsZS1wb3NpdGlvbjogaW5zaWRlOyB9IHB7IG1hcmdpbjowOyBwYWRkaW5nOjA7fSc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RvciBtZXNzYWdlZWRpdG9yXHJcbiAgICAgKiBAcGFyYW0gcHJvcHNcclxuICAgICAqIEBwYXJhbSBzdGF0ZVxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMsIHN0YXRlOiBTdGF0ZSkge1xyXG4gICAgICAgIHN1cGVyKHByb3BzLCBzdGF0ZSk7XHJcblxyXG4gICAgICAgIC8vaW5pdGlhbGl6ZSBzdGF0ZVxyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIHNjcmlwdExvYWRlZDogZmFsc2UsXHJcbiAgICAgICAgICAgIHJlbmRlcmVkT246IDBcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLm9uUmVtb3ZlID0gdGhpcy5vblJlbW92ZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMub25FZGl0b3JJbml0ID0gdGhpcy5vbkVkaXRvckluaXQuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLm9uU2V0Q29udGVudCA9IHRoaXMub25TZXRDb250ZW50LmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb21wb25lbnQgZGlkIG1vdW50XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjb21wb25lbnREaWRNb3VudCgpIHtcclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UuYWRkTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5NRVNTQUdFX0NMT1NFX0VWRU5ULCB0aGlzLm9uTWVzc2FnZVBhbmVsQ2xvc2UpO1xyXG4gICAgICAgIHRoaXMuc2V0Rm9jdXMoKTtcclxuICAgIH1cclxuXHJcblx0LyoqXHJcblx0ICogQ29tcG9uZW50IHdpbGwgbW91bnRcclxuXHQgKi9cclxuICAgIHB1YmxpYyBjb21wb25lbnRXaWxsTW91bnQoKSB7XHJcbiAgICAgICAgbGV0IHVybDogc3RyaW5nID0gaHRtbFV0aWxpdGllcy5nZXRGdWxsVXJsKHVybHMuVElOWU1DRV9VUkwpO1xyXG4gICAgICAgIC8vIElmIHRpbnlNQ0Ugc2NyaXB0IGlzIG5vdCBsb2FkZWQgdGhlbiBsb2FkIHRoYXRcclxuICAgICAgICBpZiAoIWh0bWxVdGlsaXRpZXMuaXNTY3JpcHRMb2FkZWQodXJsKSkge1xyXG4gICAgICAgICAgICBjb25zdCBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcclxuICAgICAgICAgICAgc2NyaXB0LnNyYyA9IHVybDtcclxuICAgICAgICAgICAgc2NyaXB0LmFzeW5jID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2NyaXB0Lm9ubG9hZCA9ICh0aGlzLmRlcGVuZGVuY2llc0xvYWRlZC5iaW5kKHRoaXMpKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzTG9hZGVkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogY29tcG9uZW50IHdpbGwgdW5tb3VudFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XHJcbiAgICAgICAgbWVzc2FnZVN0b3JlLmluc3RhbmNlLnJlbW92ZUxpc3RlbmVyKG1lc3NhZ2VTdG9yZS5NZXNzYWdlU3RvcmUuTUVTU0FHRV9DTE9TRV9FVkVOVCwgdGhpcy5vbk1lc3NhZ2VQYW5lbENsb3NlKTtcclxuXHJcbiAgICAgICAgaWYgKHRpbnltY2UuZ2V0KHRoaXMucHJvcHMuaWQpKSB7XHJcbiAgICAgICAgICAgIHRpbnltY2UucmVtb3ZlKCcjJyArIHRoaXMucHJvcHMuaWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbXBvbmVudCBkaWQgdXBkYXRlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjb21wb25lbnREaWRVcGRhdGUoKSB7XHJcbiAgICAgICAgdGhpcy5zZXRGb2N1cygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyB3aWxsIGJsb2NrIHRoZSBkb3VibGUtdGFwIHpvb20gaW4gaXBhZFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGJsb2NrRG91YmxlVGFwWm9vbSA9IChlOiBhbnkpOiB2b2lkID0+IHtcclxuICAgICAgICBsZXQgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgICBsZXQgdGFwTGVuZ3RoID0gY3VycmVudFRpbWUgLSB0aGlzLmxhc3RUYXA7XHJcbiAgICAgICAgaWYgKHRhcExlbmd0aCA8IDUwMCAmJiB0YXBMZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5sYXN0VGFwID0gY3VycmVudFRpbWU7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyB3aWxsIGJsb2NrIHRoZSBwaW5jaC10by16b29tIGluIGlwYWRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBibG9ja1BpbmNoVG9ab29tID0gKGU6IGFueSk6IHZvaWQgPT4ge1xyXG4gICAgICAgIGlmIChlLnRvdWNoZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlbmRlciBjb21wb25lbnRcclxuICAgICAqL1xyXG4gICAgcHVibGljIHJlbmRlcigpIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2NyaXB0TG9hZGVkKSB7XHJcbiAgICAgICAgICAgIGxldCBzZWxlY3RlZExhbmc6IHN0cmluZyA9IGxvY2FsZUhlbHBlci5nZXRBd2FyZGluZ0JvZHlMb2NhbGUodGhpcy5wcm9wcy5zZWxlY3RlZExhbmd1YWdlKTtcclxuICAgICAgICAgICAgbGV0IGVkaXRvckNvbmZpZyA9IHtcclxuICAgICAgICAgICAgICAgIG1lbnViYXI6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgc3RhdHVzYmFyOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHJlbmRlcmVkT246IERhdGUubm93KCksXHJcbiAgICAgICAgICAgICAgICBwbHVnaW5zOiBtZXNzYWdlRWRpdG9yQ29uc3RhbnRzLlRJTllNQ0VfUExVR0lOUyxcclxuICAgICAgICAgICAgICAgIHRvb2xiYXI6IG1lc3NhZ2VFZGl0b3JDb25zdGFudHMuVElOWU1DRV9UT09MQkFSLFxyXG4gICAgICAgICAgICAgICAgZm9udHNpemVfZm9ybWF0czogbWVzc2FnZUVkaXRvckNvbnN0YW50cy5USU5ZTUNFX0ZPTlRTSVpFUyxcclxuICAgICAgICAgICAgICAgIGZvbnRfZm9ybWF0czogbWVzc2FnZUVkaXRvckNvbnN0YW50cy5USU5ZTUNFX0ZPTlRTLFxyXG4gICAgICAgICAgICAgICAgbGFuZ3VhZ2U6IHNlbGVjdGVkTGFuZyxcclxuICAgICAgICAgICAgICAgIGJyb3dzZXJfc3BlbGxjaGVjazogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGNvbnRlbnRfc3R5bGU6IHRoaXMuY29udGVudFN0eWxlLFxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdF9saW5rX3RhcmdldDogJ19ibGFuaycsXHJcbiAgICAgICAgICAgICAgICB0YXJnZXRfbGlzdDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBpbnZhbGlkX2VsZW1lbnRzIDogJ2VtYmVkJ1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgPFRJTllNQ0VcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50PXt0aGlzLnByb3BzLmh0bWxDb250ZW50fVxyXG4gICAgICAgICAgICAgICAgICAgIGlkPXt0aGlzLnByb3BzLmlkfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoZW1lPXttZXNzYWdlRWRpdG9yQ29uc3RhbnRzLlRJTllNQ0VfVEhFTUV9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnPXtlZGl0b3JDb25maWd9XHJcbiAgICAgICAgICAgICAgICAgICAgb25LZXl1cD17dGhpcy5vbktleXVwfVxyXG4gICAgICAgICAgICAgICAgICAgIG9uUGFzdGU9e3RoaXMub25QYXN0ZX1cclxuICAgICAgICAgICAgICAgICAgICBvbkluaXQ9e3RoaXMub25FZGl0b3JJbml0fVxyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25DbGlja31cclxuICAgICAgICAgICAgICAgICAgICBvblJlbW92ZT17dGhpcy5vblJlbW92ZX1cclxuICAgICAgICAgICAgICAgIC8+KTtcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy9zaG93IGxvYWRpbmcgaWNvbiBpZiBzY3JpcHQgaXMgbm90IGxvYWRlZFxyXG4gICAgICAgICAgICByZXR1cm4gKDxkaXY+PC9kaXY+KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNZXRob2QgdG8gbG9hZCBkZXBlbmRlbmNpZXNcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBkZXBlbmRlbmNpZXNMb2FkZWQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuaXNUaW55TUNFTG9hZGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJvcHMuaXNUaW55TUNFTG9hZGVkKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2NyaXB0TG9hZGVkOiB0cnVlIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgb25LZXl1cCA9IChvOiBhbnksIGU6IGFueSkgPT4ge1xyXG4gICAgICAgIHRoaXMucHJvcHMudG9nZ2xlU2F2ZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHByaXZhdGUgb25FZGl0b3JJbml0ID0gKG86IGFueSwgZTogYW55KSA9PiB7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVFZGl0b3Iub24oJ1NldENvbnRlbnQnLCB0aGlzLm9uU2V0Q29udGVudCk7XHJcblxyXG4gICAgICAgIC8vIFNldCB0aGUgaGVpZ2h0IG9mIHRoZSBpRnJhbWUgc2VjdGlvbiBpbiB0aGUgdGlueSBtY2UgYXMgMTAwJSBmb3Igc3VwcG9ydGluZyB0aGUgaGVpZ2h0IGNhbGN1bGF0aW9uIGluIGNzcy5cclxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXNnLXRpbnltY2UtZWRpdG9yX2lmcicpLnN0eWxlLmhlaWdodCA9ICcxMDAlJztcclxuICAgICAgICBpZiAoaHRtbFV0aWxpdGllcy5pc0lQYWREZXZpY2UpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zZy10aW55bWNlLWVkaXRvcl9pZnInKS5zZXRBdHRyaWJ1dGUoJ3Njcm9sbGluZycsICdubycpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pc0VkaXRvckluaXRpYWxpc2VkID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgaWYgKGh0bWxVdGlsaXRpZXMuaXNJUGFkRGV2aWNlICYmIGh0bWxVdGlsaXRpZXMuZ2V0VXNlckRldmljZSgpLmJyb3dzZXIgPT09ICdTYWZhcmknKSB7XHJcbiAgICAgICAgICAgIGUuZ2V0V2luKCkuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5ibG9ja0RvdWJsZVRhcFpvb20pO1xyXG4gICAgICAgICAgICBlLmdldFdpbigpLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgdGhpcy5ibG9ja1BpbmNoVG9ab29tKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHByaXZhdGUgb25SZW1vdmUgPSAobzogYW55LCBlOiBhbnkpID0+IHtcclxuICAgICAgICBpZiAoaHRtbFV0aWxpdGllcy5pc0lQYWREZXZpY2UgJiYgaHRtbFV0aWxpdGllcy5nZXRVc2VyRGV2aWNlKCkuYnJvd3NlciA9PT0gJ1NhZmFyaScpIHtcclxuICAgICAgICAgICAgZS5nZXRXaW4oKS5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLmJsb2NrRG91YmxlVGFwWm9vbSk7XHJcbiAgICAgICAgICAgIGUuZ2V0V2luKCkuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLmJsb2NrUGluY2hUb1pvb20pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTaW11bGF0ZSB3aW5kb3cgY2xpY2sgd2hpbGUgY2xpY2tpbmcgb24gdGlueU1DRSBlZGl0b3IgdG8gY2xvc2Ugb3BlbmVkIHByaW9yaXR5IGRyb3AgZG93biBhbmQgdXNlciBvcHRpb24gcGFuZWwuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgb25DbGljayA9IChvOiBhbnksIGU6IGFueSkgPT4ge1xyXG4gICAgICAgIC8vIHdlIGhhdmUgdG8gY2xvc2Ugb3BlbmVkIHByaW9yaXR5IGRyb3AgZG93biBhbmQgdXNlciBvcHRpb25zIChsb2dvdXQgb3B0aW9ucykgd2hpbGUgY2xpY2tpbmcgb24gb3V0c2lkZSB0aGF0LiBUaW55TUNFIGVkaXRvciB3YXNcclxuICAgICAgICAvLyBwcmV2ZW50aW5nIHRoZSBjbGljayBldmVudCB0byBwcm9wYWdhdGUgb3V0c2lkZSBzbyBjbG9zaW5nIG9mIHRob3NlIHRoaW5ncyBhcmUgbm90IGhhcHBlbmluZyB3aGlsZSBjbGlja2luZyBvbiBUaW55TUNFIGVkaXRvci5cclxuICAgICAgICBsZXQgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnTW91c2VFdmVudHMnKTtcclxuICAgICAgICBldmVudC5pbml0TW91c2VFdmVudCgnY2xpY2snLCB0cnVlLCB0cnVlLCB3aW5kb3csIDAsIDAsIDAsIDgwLCAyMCwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIDAsIG51bGwpO1xyXG4gICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxuICAgIH07XHJcblxyXG4gICAgcHJpdmF0ZSBvblBhc3RlID0gKG86IGFueSwgZTogYW55KSA9PiB7XHJcbiAgICAgICAgLy8gZmluZCB0aGUgY2xpcGJvYXJkIGRhdGEgZnJvbSBhbnkgcG9zc2libGUgKHdpbmRvdy5jbGlwYm9hcmRkYXRhIGlzIGZvciBpZSlcclxuICAgICAgICBsZXQgY2xpcEJvYXJkRGF0YTogYW55ID0gKG8uY2xpcGJvYXJkRGF0YSB8fCB3aW5kb3cuY2xpcGJvYXJkRGF0YSB8fFxyXG4gICAgICAgICAgICAoby5vcmlnaW5hbEV2ZW50ICYmIG8ub3JpZ2luYWxFdmVudC5jbGlwYm9hcmREYXRhKSk7XHJcblxyXG4gICAgICAgIC8vIHNldCBnZXRkYXRhIGFyZ3VtZW50IC0gJ3RleHQnIGlzIG9ubHkgZm9yIGllMTEgYW5kIG90aGVyIGRldmljZS9icm93c2VycyBuZWVkICd0ZXh0L3BsYWluJ1xyXG4gICAgICAgIGxldCBnZXREYXRhQXJndW1lbnQ6IHN0cmluZyA9IGh0bWxVdGlsaXRpZXMuaXNJRTExID8gJ3RleHQnIDogJ3RleHQvcGxhaW4nO1xyXG5cclxuICAgICAgICAvLyBJZiB5b3UgcGFzdGUgdGV4dCBpbnRvIHRoZSBlZGl0b3Igd2l0aCBtb3VzZSBieSByaWdodC0gY2xpY2tcclxuICAgICAgICAvLyBUaW55TUNFJ3Mgb25QYXN0ZSBldmVudCBpcyBmaXJlZCwgYnV0IHRleHQgaXMgbm90IGF2YWlsYWJsZSB2aWEgLmdldENvbnRlbnQoKS5cclxuICAgICAgICAvLyBTbyB0aGF0IGNoZWNraW5nIHRoZSBjbGlwYm9hcmQgZGF0YSBpdGVtIHdoZW4gdGhlIHVzZXIgcGFzdGluZyB0aGUgdGV4dCB2aWEgbW91c2UgYnkgcmlnaHQtIGNsaWNrLlxyXG4gICAgICAgIGlmIChjbGlwQm9hcmREYXRhICYmIGNsaXBCb2FyZERhdGEuZ2V0RGF0YShnZXREYXRhQXJndW1lbnQpLnRyaW0oKSAhPT0gJycpIHtcclxuICAgICAgICAgICAgbWVzc2FnZUhlbHBlci5zZXRQYXN0ZUVuYWJsZWRBY3Rpb24odHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucHJvcHMudG9nZ2xlU2F2ZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBtZXRob2Qgd2lsbCBlbmFibGUgdGhlIHNlbmQgYnV0dG9uIHdoZW4gaHlwZXJsaW5rIGlzIGFkZGVkLlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uU2V0Q29udGVudCA9IChlOiBhbnkpID0+IHtcclxuICAgICAgICB0aGlzLnByb3BzLnRvZ2dsZVNhdmVCdXR0b25TdGF0ZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgY2xlYXIgdGlueU1DRSBjb250ZW50XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgb25NZXNzYWdlUGFuZWxDbG9zZSA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLmFjdGl2ZUVkaXRvci5zZXRDb250ZW50KCcnKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCB3aWxsIHNldCBmb2N1cyB0byB0aW55TUNFIGVkaXRvclxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHNldEZvY3VzID0gKCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnNjcmlwdExvYWRlZCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVFZGl0b3IgJiYgdGhpcy5pc0VkaXRvckluaXRpYWxpc2VkICYmIHRoaXMucHJvcHMuaGFzRm9jdXMpIHtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgd2lsbCBzZXQgZG9tIGZvY3VzIHRvIHRpbnltY2UgZWRpdG9yXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUVkaXRvci5mb2N1cygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgcmV0dXJuIHRoZSBhY3RpdmUgZWRpdG9yXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0IGFjdGl2ZUVkaXRvcigpIHtcclxuICAgICAgICByZXR1cm4gdGlueW1jZS5nZXQodGhpcy5wcm9wcy5pZCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCA9IE1lc3NhZ2VFZGl0b3I7XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL34vc291cmNlLW1hcC1sb2FkZXIhLi9zcmMvY29tcG9uZW50cy9tZXNzYWdlL21lc3NhZ2VlZGl0b3IudHN4Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQWVBO0FBQUE7QUFZQTs7OztBQUlBO0FBQ0E7QUFBQTtBQWZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWdFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFxREE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE5TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBdUJBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFhQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXVGQTtBQUhBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFBQTtBQUNBO0FBQUE7QUFFQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ }),

/***/ 464:
/* no static exports found */
/* all exports used */
/*!************************************************************!*\
  !*** ./src/components/message/messageprioritydropdown.tsx ***!
  \************************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar React = __webpack_require__(/*! react */ 0);\r\nvar classNames = __webpack_require__(/*! classnames */ 39);\r\nvar localeStore = __webpack_require__(/*! ../../stores/locale/localestore */ 226);\r\n/* tslint:disable:variable-name */\r\nvar ListItem = function (props) {\r\n    return React.createElement(\"li\", { role: 'menuitem' },\r\n        React.createElement(\"a\", { href: 'javascript:void(0)', onClick: function () { props.onSelect(props.item.id); } }, props.item.name));\r\n};\r\nvar List = function (props) { return (React.createElement(\"ul\", { id: props.id + '_drop-down-items', className: 'menu', role: 'menu', title: localeStore.instance.TranslateText('messaging.compose-message.priority.priority-tooltip'), \"aria-hidden\": 'true' }, props.items.map(function (item) { return (item !== null) ?\r\n    (React.createElement(ListItem, { key: 'key_drop_down_' + item.id, onSelect: props.onSelect, item: item })) :\r\n    null; }))); };\r\nvar DropDown = function (props) {\r\n    return (React.createElement(\"div\", { id: props.id + '_dropdown', className: classNames(props.className, { 'open': props.isOpen }, { 'close': props.isOpen === undefined ? false : !props.isOpen }), onClick: function () { props.onClick(props.dropDownType); } },\r\n        React.createElement(\"a\", { href: 'javascript:void(0)', id: props.id + '_component', className: 'menu-button' },\r\n            React.createElement(\"span\", { id: props.id + '_items' },\r\n                \" \",\r\n                props.selectedItem,\r\n                \" \"),\r\n            React.createElement(\"span\", { className: 'sprite-icon menu-arrow-icon' })),\r\n        React.createElement(List, { id: props.id, key: 'key_drop_down_items', onSelect: props.onSelect, items: props.items })));\r\n};\r\nmodule.exports = DropDown;\r\n/* tslint:enable */ \r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDY0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWVzc2FnZS9tZXNzYWdlcHJpb3JpdHlkcm9wZG93bi50c3g/YTU0OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZW51bXMgPSByZXF1aXJlKCcuLi91dGlsaXR5L2VudW1zJyk7XHJcbmltcG9ydCBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XHJcbmxldCBjbGFzc05hbWVzID0gcmVxdWlyZSgnY2xhc3NuYW1lcycpO1xyXG5sZXQgbG9jYWxlU3RvcmUgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvbG9jYWxlL2xvY2FsZXN0b3JlJyk7XHJcblxyXG5pbnRlcmZhY2UgSXRlbSB7XHJcbiAgICBpZDogZW51bXMuTWVzc2FnZVByaW9yaXR5O1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgRHJvcERvd25JdGVtcyB7XHJcbiAgICBpZDogc3RyaW5nO1xyXG4gICAgZHJvcERvd25UeXBlOiBlbnVtcy5Ecm9wRG93blR5cGU7XHJcbiAgICBjbGFzc05hbWU6IHN0cmluZztcclxuICAgIGlzT3BlbjogYm9vbGVhbjtcclxuICAgIG9uQ2xpY2s6IEZ1bmN0aW9uO1xyXG4gICAgb25TZWxlY3Q6IEZ1bmN0aW9uO1xyXG4gICAgc2VsZWN0ZWRJdGVtOiBzdHJpbmc7XHJcbiAgICBpdGVtczogQXJyYXk8SXRlbT47XHJcbn1cclxuXHJcbi8qIHRzbGludDpkaXNhYmxlOnZhcmlhYmxlLW5hbWUgKi9cclxuXHJcbmNvbnN0IExpc3RJdGVtID0gKHByb3BzOiB7IG9uU2VsZWN0OiBGdW5jdGlvbiwgaXRlbTogSXRlbX0pID0+XHJcbiAgICA8bGkgcm9sZT0nbWVudWl0ZW0nPjxhIGhyZWY9J2phdmFzY3JpcHQ6dm9pZCgwKScgb25DbGljayA9IHsoKSA9PiB7IHByb3BzLm9uU2VsZWN0KHByb3BzLml0ZW0uaWQpOyB9IH0+eyBwcm9wcy5pdGVtLm5hbWUgfTwvYT48L2xpPjtcclxuY29uc3QgTGlzdCA9IChwcm9wczogeyBvblNlbGVjdDogRnVuY3Rpb24sIGl0ZW1zOiBBcnJheTxJdGVtPiwgaWQ6IHN0cmluZyB9KSA9PiAoXHJcbiAgICA8dWwgaWQ9e3Byb3BzLmlkICsgJ19kcm9wLWRvd24taXRlbXMnfSBjbGFzc05hbWU9J21lbnUnIHJvbGU9J21lbnUnXHJcbiAgICAgICAgdGl0bGU9e2xvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UucHJpb3JpdHkucHJpb3JpdHktdG9vbHRpcCcpfSBhcmlhLWhpZGRlbj0ndHJ1ZScgPlxyXG4gICAgICAgIHsgcHJvcHMuaXRlbXMubWFwKChpdGVtOiBJdGVtKSA9PiAoaXRlbSAhPT0gbnVsbCkgP1xyXG4gICAgICAgICAgICAoPExpc3RJdGVtIGtleT0geydrZXlfZHJvcF9kb3duXycgKyBpdGVtLmlkfSBvblNlbGVjdD0ge3Byb3BzLm9uU2VsZWN0fSBpdGVtPXsgaXRlbSB9IC8+KSA6XHJcbiAgICAgICAgICAgIG51bGwpIH1cclxuICAgIDwvdWw+XHJcbik7XHJcblxyXG5jb25zdCBEcm9wRG93biA9IChwcm9wczogRHJvcERvd25JdGVtcykgPT4ge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgICA8ZGl2IGlkPXtwcm9wcy5pZCArICdfZHJvcGRvd24nfSBjbGFzc05hbWU9e2NsYXNzTmFtZXMocHJvcHMuY2xhc3NOYW1lLCB7ICdvcGVuJzogcHJvcHMuaXNPcGVuIH0sXHJcbiAgICAgICAgICAgIHsgJ2Nsb3NlJzogcHJvcHMuaXNPcGVuID09PSB1bmRlZmluZWQgPyBmYWxzZSA6ICFwcm9wcy5pc09wZW4gfSkgfSBvbkNsaWNrID0geyAoKSA9PiB7IHByb3BzLm9uQ2xpY2socHJvcHMuZHJvcERvd25UeXBlKTsgfSB9PlxyXG4gICAgICAgICAgICA8YSBocmVmPSdqYXZhc2NyaXB0OnZvaWQoMCknIGlkPXtwcm9wcy5pZCArICdfY29tcG9uZW50J30gY2xhc3NOYW1lPSdtZW51LWJ1dHRvbic+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBpZCA9IHtwcm9wcy5pZCArICdfaXRlbXMnfSA+IHsgcHJvcHMuc2VsZWN0ZWRJdGVtIH0gPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdzcHJpdGUtaWNvbiBtZW51LWFycm93LWljb24nPjwvc3Bhbj5cclxuICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgICA8TGlzdCBpZD17cHJvcHMuaWR9IGtleT17J2tleV9kcm9wX2Rvd25faXRlbXMnfSAgb25TZWxlY3Q9IHtwcm9wcy5vblNlbGVjdH0gaXRlbXMgPSB7IHByb3BzLml0ZW1zIH0vPlxyXG4gICAgICAgIDwvZGl2Pik7XHJcbn07XHJcblxyXG5leHBvcnQgPSBEcm9wRG93bjtcclxuXHJcbi8qIHRzbGludDplbmFibGUgKi9cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9+L3NvdXJjZS1tYXAtbG9hZGVyIS4vc3JjL2NvbXBvbmVudHMvbWVzc2FnZS9tZXNzYWdlcHJpb3JpdHlkcm9wZG93bi50c3giXSwibWFwcGluZ3MiOiI7QUFDQTtBQUNBO0FBQ0E7QUFrQkE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBSUE7QUFDQTtBQUlBO0FBQ0E7QUFHQTtBQUNBOztBQUFBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUVBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }),

/***/ 466:
/* no static exports found */
/* all exports used */
/*!********************************************!*\
  !*** ./src/components/message/subject.tsx ***!
  \********************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar React = __webpack_require__(/*! react */ 0);\r\nvar pureRenderComponent = __webpack_require__(/*! ../base/purerendercomponent */ 227);\r\nvar messageStore = __webpack_require__(/*! ../../stores/message/messagestore */ 240);\r\nvar htmlUtilities = __webpack_require__(/*! ../../utility/generic/htmlutilities */ 243);\r\nvar Subject = /** @class */ (function (_super) {\r\n    __extends(Subject, _super);\r\n    /**\r\n     * constructor\r\n     * @param props\r\n     * @param state\r\n     */\r\n    function Subject(props, state) {\r\n        var _this = _super.call(this, props, state) || this;\r\n        /**\r\n         * seting focus back to subject on message close for fixing cursor and onscreen keyboard displaying issue in ipad\r\n         * Defect: 24608\r\n         */\r\n        _this.closeMessage = function () {\r\n            if (_this.props.hasFocus && htmlUtilities.isIPadDevice) {\r\n                _this.setFocusOnSubject();\r\n                (_this.refs[_this.props.refName]).blur();\r\n            }\r\n            // close message callback function called\r\n            if (_this.props.callback) {\r\n                _this.props.callback();\r\n            }\r\n        };\r\n        /**\r\n         * This method will call on subject onChange event\r\n         */\r\n        _this.onChange = function (event) {\r\n            _this.props.onChange(event.target.value);\r\n        };\r\n        /**\r\n         * Set Focus to the input field if necessary\r\n         */\r\n        _this.setFocusOnSubject = function () {\r\n            if (_this.props.hasFocus) {\r\n                (_this.refs[_this.props.refName]).blur();\r\n                (_this.refs[_this.props.refName]).focus();\r\n            }\r\n        };\r\n        _this.onAnimationEnd = _this.onAnimationEnd.bind(_this);\r\n        return _this;\r\n    }\r\n    /**\r\n     * Event on animation end\r\n     * @param event\r\n     */\r\n    Subject.prototype.onAnimationEnd = function (event) {\r\n        // If any child element has triggered the transion-end ignore it\r\n        var element = event.srcElement || event.target;\r\n        if (element.id !== 'messaging-panel') {\r\n            return;\r\n        }\r\n        // setting scroll top - fix for ipad issue #49587\r\n        if (htmlUtilities.isIPadDevice) {\r\n            window.scrollTo(0, 0);\r\n            document.body.scrollTop = 0;\r\n        }\r\n        this.setFocusOnSubject();\r\n    };\r\n    /**\r\n     * Render method\r\n     */\r\n    Subject.prototype.render = function () {\r\n        return (React.createElement(\"div\", { className: this.props.outerClass },\r\n            React.createElement(\"input\", { type: 'text', ref: this.props.refName, id: this.props.id, \"aria-label\": 'Subject', placeholder: this.props.placeHolder, className: this.props.className, maxLength: this.props.maxLength, value: this.props.value, onInput: this.onChange })));\r\n    };\r\n    /**\r\n     * This function gets invoked when the component is about to be mounted\r\n     */\r\n    Subject.prototype.componentDidMount = function () {\r\n        messageStore.instance.addListener(messageStore.MessageStore.MESSAGE_CLOSE_EVENT, this.closeMessage);\r\n        // While creating a message from worklist and Inbox, set the focus to subject\r\n        messageStore.instance.addListener(messageStore.MessageStore.MESSAGE_OPEN_EVENT, this.setFocusOnSubject);\r\n        this.messagingPanel = document.getElementsByClassName('messaging-panel').item(0);\r\n        if (this.messagingPanel) {\r\n            // While creating a message inside the response, set the focus to subject\r\n            this.messagingPanel.addEventListener('transitionend', this.onAnimationEnd);\r\n        }\r\n        // While composing a message from Team management. Set focus to subject\r\n        this.setFocusOnSubject();\r\n    };\r\n    /**\r\n     * This function gets invoked when the component is about to be mounted\r\n     */\r\n    Subject.prototype.componentWillUnmount = function () {\r\n        messageStore.instance.removeListener(messageStore.MessageStore.MESSAGE_CLOSE_EVENT, this.closeMessage);\r\n        messageStore.instance.removeListener(messageStore.MessageStore.MESSAGE_OPEN_EVENT, this.setFocusOnSubject);\r\n        if (this.messagingPanel) {\r\n            this.messagingPanel.removeEventListener('transitionend', this.onAnimationEnd);\r\n        }\r\n    };\r\n    return Subject;\r\n}(pureRenderComponent));\r\nmodule.exports = Subject;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDY2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWVzc2FnZS9zdWJqZWN0LnRzeD9hNzFhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XHJcbmltcG9ydCBSZWFjdERvbSA9IHJlcXVpcmUoJ3JlYWN0LWRvbScpO1xyXG5pbXBvcnQgcHVyZVJlbmRlckNvbXBvbmVudCA9IHJlcXVpcmUoJy4uL2Jhc2UvcHVyZXJlbmRlcmNvbXBvbmVudCcpO1xyXG5pbXBvcnQgZW51bXMgPSByZXF1aXJlKCcuLi91dGlsaXR5L2VudW1zJyk7XHJcbmltcG9ydCBtZXNzYWdlU3RvcmUgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvbWVzc2FnZS9tZXNzYWdlc3RvcmUnKTtcclxuaW1wb3J0IGh0bWxVdGlsaXRpZXMgPSByZXF1aXJlKCcuLi8uLi91dGlsaXR5L2dlbmVyaWMvaHRtbHV0aWxpdGllcycpO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIGV4dGVuZHMgUHJvcHNCYXNlLCBMb2NhbGVTZWxlY3Rpb25CYXNlIHtcclxuICAgIG91dGVyQ2xhc3M6IHN0cmluZztcclxuICAgIHJlZk5hbWU6IHN0cmluZztcclxuICAgIGhhc0ZvY3VzOiBib29sZWFuO1xyXG4gICAgY2xhc3NOYW1lOiBzdHJpbmc7XHJcbiAgICBwbGFjZUhvbGRlcj86IHN0cmluZztcclxuICAgIG1heExlbmd0aDogbnVtYmVyO1xyXG4gICAgdmFsdWU6IHN0cmluZztcclxuICAgIG9uQ2hhbmdlOiBGdW5jdGlvbjtcclxuICAgIGNhbGxiYWNrPzogRnVuY3Rpb247XHJcbiAgICBpc1Zpc2libGU6IGJvb2xlYW47XHJcbn1cclxuXHJcbmNsYXNzIFN1YmplY3QgZXh0ZW5kcyBwdXJlUmVuZGVyQ29tcG9uZW50PFByb3BzLCBhbnk+IHtcclxuICAgIC8qIHByaXZhdGUgdmFyaWFibGUgdG8gbWFuYWdlIGV2ZW50IGxpc3RlbmVycyBmb3IgbWVzc2FnaW5nIHBhbmVsKi9cclxuICAgIHByaXZhdGUgbWVzc2FnaW5nUGFuZWw6IEVsZW1lbnQ7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBjb25zdHJ1Y3RvclxyXG4gICAgICogQHBhcmFtIHByb3BzXHJcbiAgICAgKiBAcGFyYW0gc3RhdGVcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzLCBzdGF0ZTogYW55KSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMsIHN0YXRlKTtcclxuICAgICAgICB0aGlzLm9uQW5pbWF0aW9uRW5kID0gdGhpcy5vbkFuaW1hdGlvbkVuZC5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXZlbnQgb24gYW5pbWF0aW9uIGVuZFxyXG4gICAgICogQHBhcmFtIGV2ZW50XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgb25BbmltYXRpb25FbmQoZXZlbnQ6IEV2ZW50KSB7XHJcbiAgICAgICAgLy8gSWYgYW55IGNoaWxkIGVsZW1lbnQgaGFzIHRyaWdnZXJlZCB0aGUgdHJhbnNpb24tZW5kIGlnbm9yZSBpdFxyXG4gICAgICAgIGxldCBlbGVtZW50OiBhbnkgPSBldmVudC5zcmNFbGVtZW50IHx8IGV2ZW50LnRhcmdldDtcclxuICAgICAgICBpZiAoZWxlbWVudC5pZCAhPT0gJ21lc3NhZ2luZy1wYW5lbCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gc2V0dGluZyBzY3JvbGwgdG9wIC0gZml4IGZvciBpcGFkIGlzc3VlICM0OTU4N1xyXG4gICAgICAgIGlmIChodG1sVXRpbGl0aWVzLmlzSVBhZERldmljZSkge1xyXG4gICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRGb2N1c09uU3ViamVjdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVuZGVyIG1ldGhvZFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcmVuZGVyKCk6IEpTWC5FbGVtZW50IHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17dGhpcy5wcm9wcy5vdXRlckNsYXNzfT5cclxuICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSd0ZXh0JyByZWY9e3RoaXMucHJvcHMucmVmTmFtZX0gaWQ9e3RoaXMucHJvcHMuaWR9IGFyaWEtbGFiZWw9J1N1YmplY3QnXHJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3RoaXMucHJvcHMucGxhY2VIb2xkZXJ9IGNsYXNzTmFtZT17dGhpcy5wcm9wcy5jbGFzc05hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgbWF4TGVuZ3RoPXt0aGlzLnByb3BzLm1heExlbmd0aH0gdmFsdWU9e3RoaXMucHJvcHMudmFsdWV9IG9uSW5wdXQ9e3RoaXMub25DaGFuZ2V9IC8+XHJcbiAgICAgICAgICAgIDwvZGl2Pik7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGdldHMgaW52b2tlZCB3aGVuIHRoZSBjb21wb25lbnQgaXMgYWJvdXQgdG8gYmUgbW91bnRlZFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICAgICAgbWVzc2FnZVN0b3JlLmluc3RhbmNlLmFkZExpc3RlbmVyKG1lc3NhZ2VTdG9yZS5NZXNzYWdlU3RvcmUuTUVTU0FHRV9DTE9TRV9FVkVOVCwgdGhpcy5jbG9zZU1lc3NhZ2UpO1xyXG5cclxuICAgICAgICAvLyBXaGlsZSBjcmVhdGluZyBhIG1lc3NhZ2UgZnJvbSB3b3JrbGlzdCBhbmQgSW5ib3gsIHNldCB0aGUgZm9jdXMgdG8gc3ViamVjdFxyXG4gICAgICAgIG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS5hZGRMaXN0ZW5lcihtZXNzYWdlU3RvcmUuTWVzc2FnZVN0b3JlLk1FU1NBR0VfT1BFTl9FVkVOVCwgdGhpcy5zZXRGb2N1c09uU3ViamVjdCk7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdpbmdQYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ21lc3NhZ2luZy1wYW5lbCcpLml0ZW0oMCk7XHJcbiAgICAgICAgaWYgKHRoaXMubWVzc2FnaW5nUGFuZWwpIHtcclxuICAgICAgICAgICAgLy8gV2hpbGUgY3JlYXRpbmcgYSBtZXNzYWdlIGluc2lkZSB0aGUgcmVzcG9uc2UsIHNldCB0aGUgZm9jdXMgdG8gc3ViamVjdFxyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2luZ1BhbmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCB0aGlzLm9uQW5pbWF0aW9uRW5kKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFdoaWxlIGNvbXBvc2luZyBhIG1lc3NhZ2UgZnJvbSBUZWFtIG1hbmFnZW1lbnQuIFNldCBmb2N1cyB0byBzdWJqZWN0XHJcbiAgICAgICAgdGhpcy5zZXRGb2N1c09uU3ViamVjdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiBnZXRzIGludm9rZWQgd2hlbiB0aGUgY29tcG9uZW50IGlzIGFib3V0IHRvIGJlIG1vdW50ZWRcclxuICAgICAqL1xyXG4gICAgcHVibGljIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xyXG4gICAgICAgIG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS5yZW1vdmVMaXN0ZW5lcihtZXNzYWdlU3RvcmUuTWVzc2FnZVN0b3JlLk1FU1NBR0VfQ0xPU0VfRVZFTlQsIHRoaXMuY2xvc2VNZXNzYWdlKTtcclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UucmVtb3ZlTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5NRVNTQUdFX09QRU5fRVZFTlQsIHRoaXMuc2V0Rm9jdXNPblN1YmplY3QpO1xyXG4gICAgICAgIGlmICh0aGlzLm1lc3NhZ2luZ1BhbmVsKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnaW5nUGFuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhbnNpdGlvbmVuZCcsIHRoaXMub25BbmltYXRpb25FbmQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIHNldGluZyBmb2N1cyBiYWNrIHRvIHN1YmplY3Qgb24gbWVzc2FnZSBjbG9zZSBmb3IgZml4aW5nIGN1cnNvciBhbmQgb25zY3JlZW4ga2V5Ym9hcmQgZGlzcGxheWluZyBpc3N1ZSBpbiBpcGFkXHJcbiAgICAgKiBEZWZlY3Q6IDI0NjA4XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY2xvc2VNZXNzYWdlID0gKCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3BzLmhhc0ZvY3VzICYmIGh0bWxVdGlsaXRpZXMuaXNJUGFkRGV2aWNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0Rm9jdXNPblN1YmplY3QoKTtcclxuICAgICAgICAgICAgKCh0aGlzLnJlZnNbdGhpcy5wcm9wcy5yZWZOYW1lXSkgYXMgSFRNTElucHV0RWxlbWVudCkuYmx1cigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gY2xvc2UgbWVzc2FnZSBjYWxsYmFjayBmdW5jdGlvbiBjYWxsZWRcclxuICAgICAgICBpZiAodGhpcy5wcm9wcy5jYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLnByb3BzLmNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgY2FsbCBvbiBzdWJqZWN0IG9uQ2hhbmdlIGV2ZW50XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgb25DaGFuZ2UgPSAoZXZlbnQ6IGFueSkgPT4ge1xyXG4gICAgICAgIHRoaXMucHJvcHMub25DaGFuZ2UoZXZlbnQudGFyZ2V0LnZhbHVlKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgRm9jdXMgdG8gdGhlIGlucHV0IGZpZWxkIGlmIG5lY2Vzc2FyeVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHNldEZvY3VzT25TdWJqZWN0ID0gKCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3BzLmhhc0ZvY3VzKSB7XHJcbiAgICAgICAgICAgICgodGhpcy5yZWZzW3RoaXMucHJvcHMucmVmTmFtZV0pIGFzIEhUTUxJbnB1dEVsZW1lbnQpLmJsdXIoKTtcclxuICAgICAgICAgICAgKCh0aGlzLnJlZnNbdGhpcy5wcm9wcy5yZWZOYW1lXSkgYXMgSFRNTElucHV0RWxlbWVudCkuZm9jdXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCA9IFN1YmplY3Q7XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL34vc291cmNlLW1hcC1sb2FkZXIhLi9zcmMvY29tcG9uZW50cy9tZXNzYWdlL3N1YmplY3QudHN4Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBO0FBRUE7QUFFQTtBQUNBO0FBZUE7QUFBQTtBQUlBOzs7O0FBSUE7QUFDQTtBQUFBO0FBaUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlGQTs7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFJQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWtDQTtBQUFBO0FBRUE7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ }),

/***/ 467:
/* no static exports found */
/* all exports used */
/*!*********************************************!*\
  !*** ./src/components/utility/dropdown.tsx ***!
  \*********************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar React = __webpack_require__(/*! react */ 0);\r\nvar classNames = __webpack_require__(/*! classnames */ 39);\r\nvar pureRenderComponent = __webpack_require__(/*! ../base/purerendercomponent */ 227);\r\n/* tslint:disable:variable-name */\r\nvar ListItem = function (props) {\r\n    return React.createElement(\"li\", { role: 'menuitem' },\r\n        React.createElement(\"a\", { href: 'javascript:void(0)', onClick: function () { props.onSelect(props.item.id); } }, props.item.name));\r\n};\r\nvar List = function (props) { return (React.createElement(\"ul\", { id: 'drop-down-items', className: 'menu', role: 'menu', title: '', \"aria-hidden\": 'true', style: props.style }, props.items.map(function (item) { return React.createElement(ListItem, { key: 'key_drop_down_' + item.id, onSelect: props.onSelect, item: item }); }))); };\r\n/* tslint:enable */\r\nvar DropDown = /** @class */ (function (_super) {\r\n    __extends(DropDown, _super);\r\n    /**\r\n     * constructor\r\n     * @param props\r\n     * @param state\r\n     */\r\n    function DropDown(props, state) {\r\n        var _this = _super.call(this, props, state) || this;\r\n        /**\r\n         * This will find the width of the anchor tag and pass to parent for applying width style of menu ul\r\n         */\r\n        _this.onDropDownClick = function (dropdownType) {\r\n            var width = _this.refs.qigDropDown.getBoundingClientRect().width;\r\n            _this.props.onClick(dropdownType, width);\r\n        };\r\n        return _this;\r\n    }\r\n    /**\r\n     * Render component\r\n     * @returns\r\n     */\r\n    DropDown.prototype.render = function () {\r\n        var _this = this;\r\n        return (React.createElement(\"div\", { id: this.props.id + '_dropdown', title: this.props.title, className: classNames(this.props.className, { 'open': this.props.isOpen }, { 'close': this.props.isOpen === undefined ? false : !this.props.isOpen }), onClick: function () { _this.onDropDownClick(_this.props.dropDownType); } },\r\n            React.createElement(\"a\", { ref: 'qigDropDown', href: 'javascript:void(0)', id: this.props.id + '_component', className: 'menu-button' },\r\n                React.createElement(\"span\", { id: this.props.id + '_items' },\r\n                    \" \",\r\n                    this.props.selectedItem,\r\n                    \" \"),\r\n                React.createElement(\"span\", { className: 'sprite-icon menu-arrow-icon' })),\r\n            React.createElement(List, { key: 'key_drop_down_items', onSelect: this.props.onSelect, items: this.props.items, style: this.props.style })));\r\n    };\r\n    return DropDown;\r\n}(pureRenderComponent));\r\nmodule.exports = DropDown;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDY3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS9kcm9wZG93bi50c3g/ZTY2MSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZW51bXMgPSByZXF1aXJlKCcuLi91dGlsaXR5L2VudW1zJyk7XHJcbmltcG9ydCBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XHJcbmxldCBjbGFzc05hbWVzID0gcmVxdWlyZSgnY2xhc3NuYW1lcycpO1xyXG5pbXBvcnQgcHVyZVJlbmRlckNvbXBvbmVudCA9IHJlcXVpcmUoJy4uL2Jhc2UvcHVyZXJlbmRlcmNvbXBvbmVudCcpO1xyXG5pbXBvcnQgbG9jYWxlU3RvcmUgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvbG9jYWxlL2xvY2FsZXN0b3JlJyk7XHJcblxyXG5pbnRlcmZhY2UgSXRlbSB7XHJcbiAgICBpZDogZW51bXMuTWVzc2FnZVByaW9yaXR5O1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIGRyb3BEb3duVHlwZTogZW51bXMuRHJvcERvd25UeXBlO1xyXG4gICAgY2xhc3NOYW1lOiBzdHJpbmc7XHJcbiAgICBzdHlsZTogUmVhY3QuQ1NTUHJvcGVydGllcztcclxuICAgIGlzT3BlbjogYm9vbGVhbjtcclxuICAgIG9uQ2xpY2s6IEZ1bmN0aW9uO1xyXG4gICAgb25TZWxlY3Q6IEZ1bmN0aW9uO1xyXG4gICAgc2VsZWN0ZWRJdGVtOiBzdHJpbmc7XHJcbiAgICBpdGVtczogQXJyYXk8SXRlbT47XHJcbiAgICB0aXRsZTogc3RyaW5nO1xyXG59XHJcblxyXG4vKiB0c2xpbnQ6ZGlzYWJsZTp2YXJpYWJsZS1uYW1lICovXHJcblxyXG5jb25zdCBMaXN0SXRlbSA9IChwcm9wczogeyBvblNlbGVjdDogRnVuY3Rpb24sIGl0ZW06IEl0ZW0gfSkgPT5cclxuICAgIDxsaSByb2xlPSdtZW51aXRlbSc+PGEgaHJlZj0namF2YXNjcmlwdDp2b2lkKDApJyBvbkNsaWNrPXsoKSA9PiB7IHByb3BzLm9uU2VsZWN0KHByb3BzLml0ZW0uaWQpOyB9fT57cHJvcHMuaXRlbS5uYW1lfTwvYT48L2xpPjtcclxuY29uc3QgTGlzdCA9IChwcm9wczogeyBvblNlbGVjdDogRnVuY3Rpb24sIHN0eWxlOiBSZWFjdC5DU1NQcm9wZXJ0aWVzLCBpdGVtczogQXJyYXk8SXRlbT4gfSkgPT4gKFxyXG4gICAgPHVsIGlkPSdkcm9wLWRvd24taXRlbXMnIGNsYXNzTmFtZT0nbWVudScgcm9sZT0nbWVudScgdGl0bGU9JycgYXJpYS1oaWRkZW49J3RydWUnIHN0eWxlPXtwcm9wcy5zdHlsZX0+XHJcbiAgICAgICAge3Byb3BzLml0ZW1zLm1hcCgoaXRlbTogSXRlbSkgPT4gPExpc3RJdGVtIGtleT17J2tleV9kcm9wX2Rvd25fJyArIGl0ZW0uaWR9IG9uU2VsZWN0PXtwcm9wcy5vblNlbGVjdH0gaXRlbT17aXRlbX0gLz4pfVxyXG4gICAgPC91bD5cclxuKTtcclxuXHJcbi8qIHRzbGludDplbmFibGUgKi9cclxuXHJcbmNsYXNzIERyb3BEb3duIGV4dGVuZHMgcHVyZVJlbmRlckNvbXBvbmVudDxQcm9wcywgYW55PiB7XHJcblxyXG4gICAgcHJpdmF0ZSBzdHlsZTogUmVhY3QuQ1NTUHJvcGVydGllcztcclxuXHJcbiAgICAvKiogcmVmcyAqL1xyXG4gICAgcHVibGljIHJlZnM6IHtcclxuICAgICAgICBba2V5OiBzdHJpbmddOiAoRWxlbWVudCk7XHJcbiAgICAgICAgcWlnRHJvcERvd246IChIVE1MQW5jaG9yRWxlbWVudCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogY29uc3RydWN0b3JcclxuICAgICAqIEBwYXJhbSBwcm9wc1xyXG4gICAgICogQHBhcmFtIHN0YXRlXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcywgc3RhdGU6IGFueSkge1xyXG4gICAgICAgIHN1cGVyKHByb3BzLCBzdGF0ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXIgY29tcG9uZW50XHJcbiAgICAgKiBAcmV0dXJuc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcmVuZGVyKCk6IEpTWC5FbGVtZW50IHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2IGlkPXt0aGlzLnByb3BzLmlkICsgJ19kcm9wZG93bid9XHJcbiAgICAgICAgICAgICAgICB0aXRsZT17dGhpcy5wcm9wcy50aXRsZX1cclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lcyh0aGlzLnByb3BzLmNsYXNzTmFtZSwgeyAnb3Blbic6IHRoaXMucHJvcHMuaXNPcGVuIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgeyAnY2xvc2UnOiB0aGlzLnByb3BzLmlzT3BlbiA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiAhdGhpcy5wcm9wcy5pc09wZW4gfSl9IG9uQ2xpY2s9XHJcbiAgICAgICAgICAgICAgICB7KCkgPT4geyB0aGlzLm9uRHJvcERvd25DbGljayh0aGlzLnByb3BzLmRyb3BEb3duVHlwZSk7IH19PlxyXG4gICAgICAgICAgICAgICAgPGEgcmVmPSdxaWdEcm9wRG93bicgaHJlZj0namF2YXNjcmlwdDp2b2lkKDApJyBpZD17dGhpcy5wcm9wcy5pZCArICdfY29tcG9uZW50J30gY2xhc3NOYW1lPSdtZW51LWJ1dHRvbic+XHJcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gaWQ9e3RoaXMucHJvcHMuaWQgKyAnX2l0ZW1zJ30gPiB7dGhpcy5wcm9wcy5zZWxlY3RlZEl0ZW19IDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9J3Nwcml0ZS1pY29uIG1lbnUtYXJyb3ctaWNvbic+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgICAgICAgPExpc3Qga2V5PXsna2V5X2Ryb3BfZG93bl9pdGVtcyd9IG9uU2VsZWN0PXt0aGlzLnByb3BzLm9uU2VsZWN0fSBpdGVtcz17dGhpcy5wcm9wcy5pdGVtc31cclxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17dGhpcy5wcm9wcy5zdHlsZX0gLz5cclxuICAgICAgICAgICAgPC9kaXY+KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgd2lsbCBmaW5kIHRoZSB3aWR0aCBvZiB0aGUgYW5jaG9yIHRhZyBhbmQgcGFzcyB0byBwYXJlbnQgZm9yIGFwcGx5aW5nIHdpZHRoIHN0eWxlIG9mIG1lbnUgdWxcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBvbkRyb3BEb3duQ2xpY2sgPSAoZHJvcGRvd25UeXBlOiBlbnVtcy5Ecm9wRG93blR5cGUpID0+IHtcclxuICAgICAgICBsZXQgd2lkdGg6IG51bWJlciA9IHRoaXMucmVmcy5xaWdEcm9wRG93bi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDtcclxuICAgICAgICB0aGlzLnByb3BzLm9uQ2xpY2soZHJvcGRvd25UeXBlLCB3aWR0aCk7XHJcbiAgICB9O1xyXG5cclxufVxyXG5cclxuZXhwb3J0ID0gRHJvcERvd247XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vfi9zb3VyY2UtbWFwLWxvYWRlciEuL3NyYy9jb21wb25lbnRzL3V0aWxpdHkvZHJvcGRvd24udHN4Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQXFCQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFNQTtBQUVBO0FBQUE7QUFVQTs7OztBQUlBO0FBQ0E7QUFBQTtBQXdCQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQTVCQTtBQUVBOzs7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQU1BO0FBQ0E7O0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFHQTtBQVVBO0FBQUE7QUFFQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ }),

/***/ 478:
/* no static exports found */
/* all exports used */
/*!**************************************************!*\
  !*** ./src/components/message/teamlistpopup.tsx ***!
  \**************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar React = __webpack_require__(/*! react */ 0);\r\nvar pureRenderComponent = __webpack_require__(/*! ../base/purerendercomponent */ 227);\r\nvar localeStore = __webpack_require__(/*! ../../stores/locale/localestore */ 226);\r\nvar GenericButton = __webpack_require__(/*! ../utility/genericbutton */ 290);\r\nvar messageStore = __webpack_require__(/*! ../../stores/message/messagestore */ 240);\r\nvar classNames = __webpack_require__(/*! classnames */ 39);\r\nvar messagingActionCreator = __webpack_require__(/*! ../../actions/messaging/messagingactioncreator */ 268);\r\nvar TeamListTreeview = __webpack_require__(/*! ./teamlisttreeview */ 479);\r\nvar htmlUtilities = __webpack_require__(/*! ../../utility/generic/htmlutilities */ 243);\r\n/**\r\n * TeamListPopup section contain team list\r\n * @param props\r\n * @param state\r\n */\r\nvar TeamListPopup = /** @class */ (function (_super) {\r\n    __extends(TeamListPopup, _super);\r\n    /**\r\n     * Constructor Messagepopup\r\n     * @param props\r\n     * @param state\r\n     */\r\n    function TeamListPopup(props, state) {\r\n        var _this = _super.call(this, props, state) || this;\r\n        _this.isShowAddressPopup = false;\r\n        _this.isToTeamChecked = false;\r\n        _this.prevPageY = 0;\r\n        _this.allowUp = false;\r\n        _this.allowDown = false;\r\n        /**\r\n         * event handler for touch start\r\n         */\r\n        _this.onTouchStart = function (event) {\r\n            _this.prevPageY = (event.changedTouches) ? event.changedTouches[0].pageY : 0;\r\n            var content = _this.teamListRef;\r\n            _this.allowUp = (content.scrollTop > 0);\r\n            _this.allowDown = (content.scrollTop <= content.scrollHeight - content.clientHeight);\r\n        };\r\n        /**\r\n         * event handler for touch move\r\n         */\r\n        _this.onTouchMove = function (event) {\r\n            setTimeout(function () {\r\n                event.preventDefault();\r\n                var content = _this.teamListRef;\r\n                var pageY = event.changedTouches[0].pageY;\r\n                var up = (pageY > _this.prevPageY);\r\n                var down = (pageY < _this.prevPageY);\r\n                var diff = Math.abs(_this.prevPageY - event.pageY);\r\n                _this.prevPageY = event.pageY;\r\n                if ((up && _this.allowUp)) {\r\n                    content.scrollTop = (content.scrollTop - diff);\r\n                }\r\n                else if (down && _this.allowDown) {\r\n                    content.scrollTop = (content.scrollTop + diff);\r\n                }\r\n            }, 0);\r\n        };\r\n        /**\r\n         * event handler for touch end\r\n         */\r\n        _this.onTouchEnd = function (event) {\r\n            _this.prevPageY = 0;\r\n        };\r\n        /**\r\n         * Method to cancel team selection.\r\n         */\r\n        _this.cancelTeamSelection = function () {\r\n            messagingActionCreator.updateSelectedTeamList(false);\r\n        };\r\n        /**\r\n         * Method to save selected team list in the message store.\r\n         */\r\n        _this.saveSelectedTeamList = function () {\r\n            messagingActionCreator.updateSelectedTeamList(true);\r\n        };\r\n        /**\r\n         * Method for handling entire team click.\r\n         */\r\n        _this.entireTeamClick = function () {\r\n            messagingActionCreator.entireTeamChecked(!_this.teamList.team.toTeam);\r\n        };\r\n        /**\r\n         * Method for update team list.\r\n         */\r\n        _this.teamListUpdated = function (isToTeamClick, isExpand) {\r\n            // avoid EntireTeam's checked-status change while clicking Expand/Collapse button\r\n            if (isExpand === undefined || !isExpand) {\r\n                _this.isToTeamChecked = isToTeamClick && messageStore.instance.teamDetails.team.toTeam ? true : false;\r\n            }\r\n            _this.teamList = messageStore.instance.teamDetails;\r\n            _this.setState({ renderedOn: Date.now() });\r\n        };\r\n        /*\r\n         * event handler for team list panel scroll.\r\n         */\r\n        _this.onScroll = function () {\r\n            _this.setState({\r\n                renderedOn: _this.state.renderedOn,\r\n                teamListScrollHeight: _this.getTeamListScrollHeight()\r\n            });\r\n        };\r\n        /**\r\n         * Clicking on check/uncheck of superviser\r\n         */\r\n        _this.updateTeamListStatus = function (uniqueId, isExpand) {\r\n            messagingActionCreator.updateTeamListStatus(uniqueId, isExpand);\r\n        };\r\n        // Set the default states\r\n        _this.state = {\r\n            renderedOn: 0,\r\n        };\r\n        _this.isShowAddressPopup = false;\r\n        if (messageStore.instance.teamDetails && messageStore.instance.teamDetails.team.subordinates) {\r\n            _this.isShowAddressPopup = messageStore.instance.teamDetails.team.subordinates.length > 0 ? true : false;\r\n        }\r\n        _this.teamList = messageStore.instance.teamDetails;\r\n        _this.isToTeamChecked = false;\r\n        if (_this.teamList) {\r\n            _this.isToTeamChecked = _this.teamList.team.toTeam;\r\n        }\r\n        return _this;\r\n    }\r\n    /**\r\n     * Render component\r\n     * @returns\r\n     */\r\n    TeamListPopup.prototype.render = function () {\r\n        var _this = this;\r\n        this.teamList = messageStore.instance.teamDetails;\r\n        var toTeamListPopup = this.teamList ? (React.createElement(\"div\", null,\r\n            React.createElement(\"div\", { className: classNames('popup small msg-address-list-popup in-page-popout', this.isShowAddressPopup ? 'popup-overlay open' : 'popup-overlay close'), id: 'addressListPopUp', role: 'dialog', \"aria-describedby\": 'addressList' },\r\n                React.createElement(\"div\", { className: 'popup-wrap' },\r\n                    React.createElement(\"div\", { className: 'popup-content', id: 'popup1Desc', ref: function (ele) { _this.teamListRef = ele; } },\r\n                        React.createElement(\"div\", { className: 'tree-view' },\r\n                            React.createElement(\"ul\", { role: 'tree', id: 'addressList', onScroll: this.onScroll },\r\n                                React.createElement(\"li\", { className: 'node highlighted', role: 'treeitem', \"aria-expanded\": 'false', id: 'id_entire_team' },\r\n                                    React.createElement(\"input\", { type: 'checkbox', className: 'text-middle checkbox', id: 'item1', checked: this.isToTeamChecked, onChange: this.entireTeamClick }),\r\n                                    React.createElement(\"label\", { htmlFor: 'item1', id: 'id_entire_team_label' }, localeStore.instance.TranslateText('messaging.compose-message.recipient-selector.entire-team'))),\r\n                                React.createElement(\"li\", { className: 'node expanded', role: 'treeitem', \"aria-expanded\": 'true' },\r\n                                    React.createElement(\"input\", { type: 'checkbox', className: 'text-middle checkbox', id: 'item2', checked: this.teamList && this.teamList.team.parent ?\r\n                                            this.teamList.team.parent.isChecked : false }),\r\n                                    this.teamList && this.teamList.team.parent ?\r\n                                        React.createElement(\"label\", { htmlFor: 'item2', onClick: this.updateTeamListStatus.bind(this, this.teamList.team.parent.examinerRoleId, false) }, this.teamList.team.parent.fullName) : null,\r\n                                    React.createElement(\"ul\", { role: 'group', id: this.props.id + '_TeamList' },\r\n                                        React.createElement(\"li\", { className: 'node expanded', role: 'treeitem', \"aria-expanded\": 'true', id: 'li_' + this.teamList.team.examinerRoleId },\r\n                                            React.createElement(\"span\", { className: 'sprite-icon user-icon-medium tree-icon' }),\r\n                                            React.createElement(\"label\", { className: 'text-middle', id: 'current_login_user' }, this.teamList.team.fullName),\r\n                                            React.createElement(TeamListTreeview, { id: 'teamList', key: 'teamList_key', addressList: this.teamList.team.subordinates, renderedOn: this.state.renderedOn }))))))),\r\n                    React.createElement(\"div\", { className: 'popup-footer text-right' },\r\n                        React.createElement(GenericButton, { id: 'button-rounded-close-button', key: 'key_button rounded close-button', className: 'button rounded close-button', title: localeStore.instance.TranslateText('messaging.compose-message.recipient-selector.cancel-button'), content: localeStore.instance.TranslateText('messaging.compose-message.recipient-selector.cancel-button'), disabled: false, onClick: this.cancelTeamSelection }),\r\n                        React.createElement(GenericButton, { id: 'button-primary-rounded-button', key: 'key_button primary rounded-button', className: 'button primary rounded', title: localeStore.instance.TranslateText('messaging.compose-message.recipient-selector.ok-button'), content: localeStore.instance.TranslateText('messaging.compose-message.recipient-selector.ok-button'), disabled: false, onClick: this.saveSelectedTeamList })))))) : null;\r\n        return (toTeamListPopup);\r\n    };\r\n    /**\r\n     * Component did mount\r\n     */\r\n    TeamListPopup.prototype.componentDidMount = function () {\r\n        /* these events are used to implement custom\r\n           scrolling logic to handle the elastic scroll behavior of ipad */\r\n        if (this.teamListRef && (htmlUtilities.isIPadDevice)) {\r\n            this.teamListRef.addEventListener('touchstart', this.onTouchStart);\r\n            this.teamListRef.addEventListener('touchmove', this.onTouchMove);\r\n            this.teamListRef.addEventListener('touchend', this.onTouchEnd);\r\n        }\r\n        messageStore.instance.addListener(messageStore.MessageStore.TEAM_LIST_UPDATED, this.teamListUpdated);\r\n    };\r\n    /**\r\n     * Component will unmount\r\n     */\r\n    TeamListPopup.prototype.componentWillUnmount = function () {\r\n        messageStore.instance.removeListener(messageStore.MessageStore.TEAM_LIST_UPDATED, this.teamListUpdated);\r\n        this.teamListRef.removeEventListener('touchstart', this.onTouchStart);\r\n        this.teamListRef.removeEventListener('touchmove', this.onTouchMove);\r\n        this.teamListRef.removeEventListener('touchend', this.onTouchEnd);\r\n    };\r\n    /**\r\n     * componentWillReceiveProps\r\n     * @param nextProps\r\n     */\r\n    TeamListPopup.prototype.componentWillReceiveProps = function (nextProps) {\r\n        this.isShowAddressPopup = false;\r\n        if (messageStore.instance.teamDetails && messageStore.instance.teamDetails.team.subordinates) {\r\n            this.isShowAddressPopup = messageStore.instance.teamDetails.team.subordinates.length > 0 ? true : false;\r\n        }\r\n    };\r\n    /**\r\n     * returns the team list scroll height\r\n     */\r\n    TeamListPopup.prototype.getTeamListScrollHeight = function () {\r\n        return (this.teamListRef) ? (this.teamListRef.clientHeight + this.teamListRef.scrollTop) : undefined;\r\n    };\r\n    return TeamListPopup;\r\n}(pureRenderComponent));\r\nmodule.exports = TeamListPopup;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDc4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWVzc2FnZS90ZWFtbGlzdHBvcHVwLnRzeD82ZmU2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XHJcbmltcG9ydCBSZWFjdERvbSA9IHJlcXVpcmUoJ3JlYWN0LWRvbScpO1xyXG5pbXBvcnQgcHVyZVJlbmRlckNvbXBvbmVudCA9IHJlcXVpcmUoJy4uL2Jhc2UvcHVyZXJlbmRlcmNvbXBvbmVudCcpO1xyXG5pbXBvcnQgbG9jYWxlU3RvcmUgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvbG9jYWxlL2xvY2FsZXN0b3JlJyk7XHJcbmltcG9ydCBHZW5lcmljQnV0dG9uID0gcmVxdWlyZSgnLi4vdXRpbGl0eS9nZW5lcmljYnV0dG9uJyk7XHJcbmltcG9ydCBtZXNzYWdlU3RvcmUgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvbWVzc2FnZS9tZXNzYWdlc3RvcmUnKTtcclxuaW1wb3J0IE1lc3NhZ2VCYXNlID0gcmVxdWlyZSgnLi9tZXNzYWdlYmFzZScpO1xyXG5sZXQgY2xhc3NOYW1lcyA9IHJlcXVpcmUoJ2NsYXNzbmFtZXMnKTtcclxuaW1wb3J0IG1lc3NhZ2luZ0FjdGlvbkNyZWF0b3IgPSByZXF1aXJlKCcuLi8uLi9hY3Rpb25zL21lc3NhZ2luZy9tZXNzYWdpbmdhY3Rpb25jcmVhdG9yJyk7XHJcbmltcG9ydCBUZWFtTGlzdFRyZWV2aWV3ID0gcmVxdWlyZSgnLi90ZWFtbGlzdHRyZWV2aWV3Jyk7XHJcbmltcG9ydCB0ZWFtUmV0dXJuID0gcmVxdWlyZSgnLi4vLi4vc3RvcmVzL21lc3NhZ2UvdHlwaW5ncy90ZWFtcmV0dXJuJyk7XHJcbmltcG9ydCBodG1sVXRpbGl0aWVzID0gcmVxdWlyZSgnLi4vLi4vdXRpbGl0eS9nZW5lcmljL2h0bWx1dGlsaXRpZXMnKTtcclxuXHJcbmludGVyZmFjZSBQcm9wcyBleHRlbmRzIFByb3BzQmFzZSwgTG9jYWxlU2VsZWN0aW9uQmFzZSB7XHJcbiAgICBpc1Nob3dUZWFtTGlzdFBvcHVwOiBib29sZWFuO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gICAgcmVuZGVyZWRPbj86IG51bWJlcjtcclxuICAgIHRlYW1MaXN0U2Nyb2xsSGVpZ2h0PzogbnVtYmVyO1xyXG59XHJcblxyXG4vKipcclxuICogVGVhbUxpc3RQb3B1cCBzZWN0aW9uIGNvbnRhaW4gdGVhbSBsaXN0XHJcbiAqIEBwYXJhbSBwcm9wc1xyXG4gKiBAcGFyYW0gc3RhdGVcclxuICovXHJcbmNsYXNzIFRlYW1MaXN0UG9wdXAgZXh0ZW5kcyBwdXJlUmVuZGVyQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xyXG5cclxuICAgIHByaXZhdGUgaXNTaG93QWRkcmVzc1BvcHVwOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIHRlYW1MaXN0OiB0ZWFtUmV0dXJuO1xyXG4gICAgcHJpdmF0ZSBpc1RvVGVhbUNoZWNrZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHByaXZhdGUgcHJldlBhZ2VZOiBudW1iZXIgPSAwO1xyXG4gICAgcHJpdmF0ZSBhbGxvd1VwOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIGFsbG93RG93bjogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSB0ZWFtTGlzdFJlZjogSFRNTERpdkVsZW1lbnQ7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RvciBNZXNzYWdlcG9wdXBcclxuICAgICAqIEBwYXJhbSBwcm9wc1xyXG4gICAgICogQHBhcmFtIHN0YXRlXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcywgc3RhdGU6IFN0YXRlKSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMsIHN0YXRlKTtcclxuXHJcbiAgICAgICAgLy8gU2V0IHRoZSBkZWZhdWx0IHN0YXRlc1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIHJlbmRlcmVkT246IDAsXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5pc1Nob3dBZGRyZXNzUG9wdXAgPSBmYWxzZTtcclxuICAgICAgICBpZiAobWVzc2FnZVN0b3JlLmluc3RhbmNlLnRlYW1EZXRhaWxzICYmIG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscy50ZWFtLnN1Ym9yZGluYXRlcykge1xyXG4gICAgICAgICAgICB0aGlzLmlzU2hvd0FkZHJlc3NQb3B1cCA9IG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscy50ZWFtLnN1Ym9yZGluYXRlcy5sZW5ndGggPiAwID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy50ZWFtTGlzdCA9IG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscztcclxuICAgICAgICB0aGlzLmlzVG9UZWFtQ2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLnRlYW1MaXN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNUb1RlYW1DaGVja2VkID0gdGhpcy50ZWFtTGlzdC50ZWFtLnRvVGVhbTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXIgY29tcG9uZW50XHJcbiAgICAgKiBAcmV0dXJuc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcmVuZGVyKCk6IEpTWC5FbGVtZW50IHtcclxuICAgICAgICB0aGlzLnRlYW1MaXN0ID0gbWVzc2FnZVN0b3JlLmluc3RhbmNlLnRlYW1EZXRhaWxzO1xyXG4gICAgICAgIGxldCB0b1RlYW1MaXN0UG9wdXAgPSB0aGlzLnRlYW1MaXN0ID8gKFxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2NsYXNzTmFtZXMoJ3BvcHVwIHNtYWxsIG1zZy1hZGRyZXNzLWxpc3QtcG9wdXAgaW4tcGFnZS1wb3BvdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNTaG93QWRkcmVzc1BvcHVwID8gJ3BvcHVwLW92ZXJsYXkgb3BlbicgOiAncG9wdXAtb3ZlcmxheSBjbG9zZScpIH1cclxuICAgICAgICAgICAgICAgICAgICBpZD0nYWRkcmVzc0xpc3RQb3BVcCcgcm9sZT0nZGlhbG9nJyBhcmlhLWRlc2NyaWJlZGJ5PSdhZGRyZXNzTGlzdCc+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3BvcHVwLXdyYXAnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ncG9wdXAtY29udGVudCcgaWQ9J3BvcHVwMURlc2MnIHJlZj17KGVsZSkgPT4geyB0aGlzLnRlYW1MaXN0UmVmID0gZWxlOyB9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0cmVlLXZpZXcnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx1bCByb2xlPSd0cmVlJyBpZD0nYWRkcmVzc0xpc3QnIG9uU2Nyb2xsPXt0aGlzLm9uU2Nyb2xsfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpIGNsYXNzTmFtZT0nbm9kZSBoaWdobGlnaHRlZCcgcm9sZT0ndHJlZWl0ZW0nIGFyaWEtZXhwYW5kZWQ9J2ZhbHNlJyBpZCA9ICdpZF9lbnRpcmVfdGVhbSc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0nY2hlY2tib3gnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSd0ZXh0LW1pZGRsZSBjaGVja2JveCdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD0naXRlbTEnIGNoZWNrZWQ9e3RoaXMuaXNUb1RlYW1DaGVja2VkfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlID17dGhpcy5lbnRpcmVUZWFtQ2xpY2t9IC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgaHRtbEZvcj0naXRlbTEnIGlkID0gJ2lkX2VudGlyZV90ZWFtX2xhYmVsJz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UucmVjaXBpZW50LXNlbGVjdG9yLmVudGlyZS10ZWFtJyl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3NOYW1lPSdub2RlIGV4cGFuZGVkJyByb2xlPSd0cmVlaXRlbScgYXJpYS1leHBhbmRlZD0ndHJ1ZSc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzTmFtZT0ndGV4dC1taWRkbGUgY2hlY2tib3gnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9J2l0ZW0yJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e3RoaXMudGVhbUxpc3QgJiYgdGhpcy50ZWFtTGlzdC50ZWFtLnBhcmVudCA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVhbUxpc3QudGVhbS5wYXJlbnQuaXNDaGVja2VkIDogZmFsc2V9Lz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLnRlYW1MaXN0ICYmIHRoaXMudGVhbUxpc3QudGVhbS5wYXJlbnQgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPSdpdGVtMidcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy51cGRhdGVUZWFtTGlzdFN0YXR1cy5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVhbUxpc3QudGVhbS5wYXJlbnQuZXhhbWluZXJSb2xlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSkgfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3RoaXMudGVhbUxpc3QudGVhbS5wYXJlbnQuZnVsbE5hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD4gOiBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dWwgcm9sZT0nZ3JvdXAnIGlkID17dGhpcy5wcm9wcy5pZCArICdfVGVhbUxpc3QnfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3NOYW1lPSdub2RlIGV4cGFuZGVkJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb2xlPSd0cmVlaXRlbSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJpYS1leHBhbmRlZD0ndHJ1ZSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9eydsaV8nICsgdGhpcy50ZWFtTGlzdC50ZWFtLmV4YW1pbmVyUm9sZUlkfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdzcHJpdGUtaWNvbiB1c2VyLWljb24tbWVkaXVtIHRyZWUtaWNvbic+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPSd0ZXh0LW1pZGRsZScgaWQ9J2N1cnJlbnRfbG9naW5fdXNlcic+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGhpcy50ZWFtTGlzdC50ZWFtLmZ1bGxOYW1lfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGVhbUxpc3RUcmVldmlldyBpZD17J3RlYW1MaXN0J30ga2V5PXsndGVhbUxpc3Rfa2V5J31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3NMaXN0ID17dGhpcy50ZWFtTGlzdC50ZWFtLnN1Ym9yZGluYXRlc31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcmVkT24gPSB7dGhpcy5zdGF0ZS5yZW5kZXJlZE9ufSAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3VsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdwb3B1cC1mb290ZXIgdGV4dC1yaWdodCc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8R2VuZXJpY0J1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPXsgJ2J1dHRvbi1yb3VuZGVkLWNsb3NlLWJ1dHRvbicgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17J2tleV9idXR0b24gcm91bmRlZCBjbG9zZS1idXR0b24nIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9eydidXR0b24gcm91bmRlZCBjbG9zZS1idXR0b24nfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcuY29tcG9zZS1tZXNzYWdlLnJlY2lwaWVudC1zZWxlY3Rvci5jYW5jZWwtYnV0dG9uJykgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ9e2xvY2FsZVN0b3JlLmluc3RhbmNlLlRyYW5zbGF0ZVRleHQoJ21lc3NhZ2luZy5jb21wb3NlLW1lc3NhZ2UucmVjaXBpZW50LXNlbGVjdG9yLmNhbmNlbC1idXR0b24nKSB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2ZhbHNlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuY2FuY2VsVGVhbVNlbGVjdGlvbn0vPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEdlbmVyaWNCdXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD17ICdidXR0b24tcHJpbWFyeS1yb3VuZGVkLWJ1dHRvbicgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17J2tleV9idXR0b24gcHJpbWFyeSByb3VuZGVkLWJ1dHRvbicgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17J2J1dHRvbiBwcmltYXJ5IHJvdW5kZWQnfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtsb2NhbGVTdG9yZS5pbnN0YW5jZS5UcmFuc2xhdGVUZXh0KCdtZXNzYWdpbmcuY29tcG9zZS1tZXNzYWdlLnJlY2lwaWVudC1zZWxlY3Rvci5vay1idXR0b24nKSB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudD17bG9jYWxlU3RvcmUuaW5zdGFuY2UuVHJhbnNsYXRlVGV4dCgnbWVzc2FnaW5nLmNvbXBvc2UtbWVzc2FnZS5yZWNpcGllbnQtc2VsZWN0b3Iub2stYnV0dG9uJykgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtmYWxzZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnNhdmVTZWxlY3RlZFRlYW1MaXN0fS8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApIDogbnVsbDtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICB0b1RlYW1MaXN0UG9wdXBcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29tcG9uZW50IGRpZCBtb3VudFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcblxyXG4gICAgICAgIC8qIHRoZXNlIGV2ZW50cyBhcmUgdXNlZCB0byBpbXBsZW1lbnQgY3VzdG9tIFxyXG4gICAgICAgICAgIHNjcm9sbGluZyBsb2dpYyB0byBoYW5kbGUgdGhlIGVsYXN0aWMgc2Nyb2xsIGJlaGF2aW9yIG9mIGlwYWQgKi9cclxuICAgICAgICBpZiAodGhpcy50ZWFtTGlzdFJlZiAmJiAoaHRtbFV0aWxpdGllcy5pc0lQYWREZXZpY2UpKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGVhbUxpc3RSZWYuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMub25Ub3VjaFN0YXJ0KTtcclxuICAgICAgICAgICAgdGhpcy50ZWFtTGlzdFJlZi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLm9uVG91Y2hNb3ZlKTtcclxuICAgICAgICAgICAgdGhpcy50ZWFtTGlzdFJlZi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMub25Ub3VjaEVuZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UuYWRkTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5URUFNX0xJU1RfVVBEQVRFRCwgdGhpcy50ZWFtTGlzdFVwZGF0ZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogZXZlbnQgaGFuZGxlciBmb3IgdG91Y2ggc3RhcnRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBvblRvdWNoU3RhcnQgPSAoZXZlbnQ6IGFueSkgPT4ge1xyXG5cclxuICAgICAgICB0aGlzLnByZXZQYWdlWSA9IChldmVudC5jaGFuZ2VkVG91Y2hlcykgPyBldmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWSA6IDA7XHJcbiAgICAgICAgbGV0IGNvbnRlbnQgPSAodGhpcy50ZWFtTGlzdFJlZiBhcyBIVE1MRWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5hbGxvd1VwID0gKGNvbnRlbnQuc2Nyb2xsVG9wID4gMCk7XHJcbiAgICAgICAgdGhpcy5hbGxvd0Rvd24gPSAoY29udGVudC5zY3JvbGxUb3AgPD0gY29udGVudC5zY3JvbGxIZWlnaHQgLSBjb250ZW50LmNsaWVudEhlaWdodCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogZXZlbnQgaGFuZGxlciBmb3IgdG91Y2ggbW92ZVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uVG91Y2hNb3ZlID0gKGV2ZW50OiBhbnkpID0+IHtcclxuXHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBsZXQgY29udGVudCA9ICh0aGlzLnRlYW1MaXN0UmVmIGFzIEhUTUxFbGVtZW50KTtcclxuICAgICAgICBsZXQgcGFnZVkgPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWTtcclxuICAgICAgICB2YXIgdXAgPSAocGFnZVkgPiB0aGlzLnByZXZQYWdlWSk7XHJcbiAgICAgICAgdmFyIGRvd24gPSAocGFnZVkgPCB0aGlzLnByZXZQYWdlWSk7XHJcbiAgICAgICAgbGV0IGRpZmYgPSBNYXRoLmFicyh0aGlzLnByZXZQYWdlWSAtIGV2ZW50LnBhZ2VZKTtcclxuXHJcbiAgICAgICAgdGhpcy5wcmV2UGFnZVkgPSBldmVudC5wYWdlWTtcclxuXHJcbiAgICAgICAgaWYgKCh1cCAmJiB0aGlzLmFsbG93VXApKSB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQuc2Nyb2xsVG9wID0gKGNvbnRlbnQuc2Nyb2xsVG9wIC0gZGlmZik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChkb3duICYmIHRoaXMuYWxsb3dEb3duKSB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQuc2Nyb2xsVG9wID0gKGNvbnRlbnQuc2Nyb2xsVG9wICsgZGlmZik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIH0sIDApO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIGV2ZW50IGhhbmRsZXIgZm9yIHRvdWNoIGVuZFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9uVG91Y2hFbmQgPSAoZXZlbnQ6IGFueSkgPT4ge1xyXG4gICAgICAgIHRoaXMucHJldlBhZ2VZID0gMDtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb21wb25lbnQgd2lsbCB1bm1vdW50XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcclxuICAgICAgICBtZXNzYWdlU3RvcmUuaW5zdGFuY2UucmVtb3ZlTGlzdGVuZXIobWVzc2FnZVN0b3JlLk1lc3NhZ2VTdG9yZS5URUFNX0xJU1RfVVBEQVRFRCwgdGhpcy50ZWFtTGlzdFVwZGF0ZWQpO1xyXG4gICAgICAgIHRoaXMudGVhbUxpc3RSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMub25Ub3VjaFN0YXJ0KTtcclxuICAgICAgICB0aGlzLnRlYW1MaXN0UmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMub25Ub3VjaE1vdmUpO1xyXG4gICAgICAgIHRoaXMudGVhbUxpc3RSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLm9uVG91Y2hFbmQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wc1xyXG4gICAgICogQHBhcmFtIG5leHRQcm9wc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHM6IFByb3BzKSB7XHJcbiAgICAgICAgdGhpcy5pc1Nob3dBZGRyZXNzUG9wdXAgPSBmYWxzZTtcclxuICAgICAgICBpZiAobWVzc2FnZVN0b3JlLmluc3RhbmNlLnRlYW1EZXRhaWxzICYmIG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscy50ZWFtLnN1Ym9yZGluYXRlcykge1xyXG4gICAgICAgICAgICB0aGlzLmlzU2hvd0FkZHJlc3NQb3B1cCA9IG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscy50ZWFtLnN1Ym9yZGluYXRlcy5sZW5ndGggPiAwID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE1ldGhvZCB0byBjYW5jZWwgdGVhbSBzZWxlY3Rpb24uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY2FuY2VsVGVhbVNlbGVjdGlvbiA9ICgpID0+IHtcclxuICAgICAgICBtZXNzYWdpbmdBY3Rpb25DcmVhdG9yLnVwZGF0ZVNlbGVjdGVkVGVhbUxpc3QoZmFsc2UpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIE1ldGhvZCB0byBzYXZlIHNlbGVjdGVkIHRlYW0gbGlzdCBpbiB0aGUgbWVzc2FnZSBzdG9yZS5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBzYXZlU2VsZWN0ZWRUZWFtTGlzdCA9ICgpID0+IHtcclxuICAgICAgICBtZXNzYWdpbmdBY3Rpb25DcmVhdG9yLnVwZGF0ZVNlbGVjdGVkVGVhbUxpc3QodHJ1ZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWV0aG9kIGZvciBoYW5kbGluZyBlbnRpcmUgdGVhbSBjbGljay5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBlbnRpcmVUZWFtQ2xpY2sgPSAoKTogdm9pZCA9PiB7XHJcbiAgICAgICAgbWVzc2FnaW5nQWN0aW9uQ3JlYXRvci5lbnRpcmVUZWFtQ2hlY2tlZCghdGhpcy50ZWFtTGlzdC50ZWFtLnRvVGVhbSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWV0aG9kIGZvciB1cGRhdGUgdGVhbSBsaXN0LlxyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgdGVhbUxpc3RVcGRhdGVkID0gKGlzVG9UZWFtQ2xpY2s6IGJvb2xlYW4sIGlzRXhwYW5kOiBib29sZWFuKTogdm9pZCA9PiB7XHJcbiAgICAvLyBhdm9pZCBFbnRpcmVUZWFtJ3MgY2hlY2tlZC1zdGF0dXMgY2hhbmdlIHdoaWxlIGNsaWNraW5nIEV4cGFuZC9Db2xsYXBzZSBidXR0b25cclxuICAgICAgICBpZiAoaXNFeHBhbmQgPT09IHVuZGVmaW5lZCB8fCAhaXNFeHBhbmQpIHtcclxuICAgICAgICAgICAgdGhpcy5pc1RvVGVhbUNoZWNrZWQgPSBpc1RvVGVhbUNsaWNrICYmIG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscy50ZWFtLnRvVGVhbSA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy50ZWFtTGlzdCA9IG1lc3NhZ2VTdG9yZS5pbnN0YW5jZS50ZWFtRGV0YWlscztcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgcmVuZGVyZWRPbjogRGF0ZS5ub3coKSB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLypcclxuICAgICAqIGV2ZW50IGhhbmRsZXIgZm9yIHRlYW0gbGlzdCBwYW5lbCBzY3JvbGwuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgb25TY3JvbGwgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIHJlbmRlcmVkT246IHRoaXMuc3RhdGUucmVuZGVyZWRPbixcclxuICAgICAgICAgICAgdGVhbUxpc3RTY3JvbGxIZWlnaHQ6IHRoaXMuZ2V0VGVhbUxpc3RTY3JvbGxIZWlnaHQoKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIHJldHVybnMgdGhlIHRlYW0gbGlzdCBzY3JvbGwgaGVpZ2h0XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0VGVhbUxpc3RTY3JvbGxIZWlnaHQoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMudGVhbUxpc3RSZWYpID8gKHRoaXMudGVhbUxpc3RSZWYuY2xpZW50SGVpZ2h0ICsgdGhpcy50ZWFtTGlzdFJlZi5zY3JvbGxUb3ApIDogdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2xpY2tpbmcgb24gY2hlY2svdW5jaGVjayBvZiBzdXBlcnZpc2VyXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgdXBkYXRlVGVhbUxpc3RTdGF0dXMgPSAodW5pcXVlSWQ6IG51bWJlciwgaXNFeHBhbmQ6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICBtZXNzYWdpbmdBY3Rpb25DcmVhdG9yLnVwZGF0ZVRlYW1MaXN0U3RhdHVzKHVuaXF1ZUlkLCBpc0V4cGFuZCk7XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgPSBUZWFtTGlzdFBvcHVwO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL34vc291cmNlLW1hcC1sb2FkZXIhLi9zcmMvY29tcG9uZW50cy9tZXNzYWdlL3RlYW1saXN0cG9wdXAudHN4Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQVdBOzs7O0FBSUE7QUFDQTtBQUFBO0FBVUE7Ozs7QUFJQTtBQUNBO0FBQUE7QUFiQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBZ0lBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUF1QkE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQTFPQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUtBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFRQTtBQUNBO0FBSUE7QUFDQTtBQUdBO0FBU0E7QUFDQTtBQVFBO0FBYUE7QUFHQTtBQUVBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUEyQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE2Q0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFRQTtBQUFBO0FBRUE7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ }),

/***/ 479:
/* no static exports found */
/* all exports used */
/*!*****************************************************!*\
  !*** ./src/components/message/teamlisttreeview.tsx ***!
  \*****************************************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar React = __webpack_require__(/*! react */ 0);\r\nvar pureRenderComponent = __webpack_require__(/*! ../base/purerendercomponent */ 227);\r\nvar messagingActionCreator = __webpack_require__(/*! ../../actions/messaging/messagingactioncreator */ 268);\r\nvar TeamListTreeview = /** @class */ (function (_super) {\r\n    __extends(TeamListTreeview, _super);\r\n    /**\r\n     * Constructor Messagepopup\r\n     * @param props\r\n     * @param state\r\n     */\r\n    function TeamListTreeview(props, state) {\r\n        var _this = _super.call(this, props, state) || this;\r\n        _this.isInitialLoad = true;\r\n        /**\r\n         * Clicking on expand/collapse or check/uncheck\r\n         */\r\n        _this.updateTeamListStatus = function (uniqueId, isExpand) {\r\n            messagingActionCreator.updateTeamListStatus(uniqueId, isExpand);\r\n        };\r\n        _this._className = _this.props.addressList.length > 0 ? 'sub-items has-expandables' : null;\r\n        return _this;\r\n    }\r\n    /**\r\n     * Render component\r\n     * @returns\r\n     */\r\n    TeamListTreeview.prototype.render = function () {\r\n        var that = this;\r\n        var nodes;\r\n        var teamListTreeView;\r\n        if (that.props.addressList !== undefined) {\r\n            nodes = that.props.addressList.map(function (nodeItem, index) {\r\n                return that.getNodeItem(nodeItem, index);\r\n            });\r\n        }\r\n        return (React.createElement(\"ul\", { role: 'group', className: this._className, id: this.props.id, key: this.props.id }, nodes));\r\n    };\r\n    /**\r\n     * getting node items\r\n     */\r\n    TeamListTreeview.prototype.getNodeItem = function (nodeItem, index) {\r\n        var checkBoxId = 'cbx_' + nodeItem.examinerRoleId;\r\n        if (nodeItem.subordinates.length > 0) {\r\n            var teamListTreeview = nodeItem.isOpen ? (React.createElement(TeamListTreeview, { id: 'nodeItem_' + nodeItem.examinerRoleId, key: 'nodeItem_' + index.toString() + '_key_' + nodeItem.examinerRoleId, addressList: nodeItem.subordinates, renderedOn: Date.now() })) : null;\r\n            var classNameForExpand = nodeItem.isOpen ? 'node has-sub expanded' : 'node has-sub collapsed';\r\n            return (React.createElement(\"li\", { id: 'li_' + nodeItem.examinerRoleId, key: 'li_' + index.toString() + '_' + nodeItem.examinerRoleId, className: classNameForExpand, role: 'treeitem', \"aria-expanded\": 'true' },\r\n                React.createElement(\"a\", { id: 'a_' + nodeItem.examinerRoleId, onClick: this.updateTeamListStatus.bind(this, nodeItem.examinerRoleId, true), href: 'javascript:void(0);', className: 'parent-node' }),\r\n                React.createElement(\"input\", { type: 'checkbox', className: 'text-middle checkbox', id: checkBoxId, checked: nodeItem.isChecked, onChange: this.updateTeamListStatus.bind(this, nodeItem.examinerRoleId, false) }),\r\n                React.createElement(\"label\", { htmlFor: checkBoxId }, nodeItem.fullName),\r\n                teamListTreeview));\r\n        }\r\n        else {\r\n            return (React.createElement(\"li\", { id: 'li_' + nodeItem.examinerRoleId, key: 'li_' + index.toString() + '_' + nodeItem.examinerRoleId, className: 'node', role: 'treeitem' },\r\n                React.createElement(\"input\", { type: 'checkbox', className: 'text-middle checkbox', id: checkBoxId, checked: nodeItem.isChecked, onChange: this.updateTeamListStatus.bind(this, nodeItem.examinerRoleId, false) }),\r\n                React.createElement(\"label\", { htmlFor: checkBoxId }, nodeItem.fullName)));\r\n        }\r\n    };\r\n    return TeamListTreeview;\r\n}(pureRenderComponent));\r\nmodule.exports = TeamListTreeview;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDc5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWVzc2FnZS90ZWFtbGlzdHRyZWV2aWV3LnRzeD84MjIxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XHJcbmltcG9ydCBSZWFjdERvbSA9IHJlcXVpcmUoJ3JlYWN0LWRvbScpO1xyXG5pbXBvcnQgcHVyZVJlbmRlckNvbXBvbmVudCA9IHJlcXVpcmUoJy4uL2Jhc2UvcHVyZXJlbmRlcmNvbXBvbmVudCcpO1xyXG5pbXBvcnQgbG9jYWxlU3RvcmUgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvbG9jYWxlL2xvY2FsZXN0b3JlJyk7XHJcbmltcG9ydCBHZW5lcmljQnV0dG9uID0gcmVxdWlyZSgnLi4vdXRpbGl0eS9nZW5lcmljYnV0dG9uJyk7XHJcbmltcG9ydCBlbnVtcyA9IHJlcXVpcmUoJy4uL3V0aWxpdHkvZW51bXMnKTtcclxuaW1wb3J0IHRvQWRkcmVzc0xpc3QgPSByZXF1aXJlKCcuLi8uLi9zdG9yZXMvbWVzc2FnZS90eXBpbmdzL3RlYW1yZXR1cm4nKTtcclxuaW1wb3J0IG1lc3NhZ2luZ0FjdGlvbkNyZWF0b3IgPSByZXF1aXJlKCcuLi8uLi9hY3Rpb25zL21lc3NhZ2luZy9tZXNzYWdpbmdhY3Rpb25jcmVhdG9yJyk7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMgZXh0ZW5kcyBQcm9wc0Jhc2UsIExvY2FsZVNlbGVjdGlvbkJhc2Uge1xyXG4gICAgYWRkcmVzc0xpc3Q6IEFycmF5PEV4YW1pbmVySW5mbz47XHJcbiAgICByZW5kZXJlZE9uPzogbnVtYmVyO1xyXG59XHJcblxyXG5jbGFzcyBUZWFtTGlzdFRyZWV2aWV3IGV4dGVuZHMgcHVyZVJlbmRlckNvbXBvbmVudDxQcm9wcywgYW55PiB7XHJcblxyXG4gICAgcHJpdmF0ZSBfY2xhc3NOYW1lOiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIGlzSW5pdGlhbExvYWQ6IGJvb2xlYW4gPSB0cnVlO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29uc3RydWN0b3IgTWVzc2FnZXBvcHVwXHJcbiAgICAgKiBAcGFyYW0gcHJvcHNcclxuICAgICAqIEBwYXJhbSBzdGF0ZVxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMsIHN0YXRlOiBhbnkpIHtcclxuICAgICAgICBzdXBlcihwcm9wcywgc3RhdGUpO1xyXG5cclxuICAgICAgICB0aGlzLl9jbGFzc05hbWUgPSB0aGlzLnByb3BzLmFkZHJlc3NMaXN0Lmxlbmd0aCA+IDAgPyAnc3ViLWl0ZW1zIGhhcy1leHBhbmRhYmxlcycgOiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVuZGVyIGNvbXBvbmVudFxyXG4gICAgICogQHJldHVybnNcclxuICAgICAqL1xyXG4gICAgcHVibGljIHJlbmRlcigpOiBKU1guRWxlbWVudCB7XHJcbiAgICAgICAgbGV0IHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIGxldCBub2RlczogYW55O1xyXG5cclxuICAgICAgICBsZXQgdGVhbUxpc3RUcmVlVmlldzogYW55O1xyXG5cclxuICAgICAgICBpZiAodGhhdC5wcm9wcy5hZGRyZXNzTGlzdCAhPT0gdW5kZWZpbmVkKSB7XHJcblxyXG4gICAgICAgICAgICBub2RlcyA9IHRoYXQucHJvcHMuYWRkcmVzc0xpc3QubWFwKGZ1bmN0aW9uIChub2RlSXRlbTogRXhhbWluZXJJbmZvLCBpbmRleDogbnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhhdC5nZXROb2RlSXRlbShub2RlSXRlbSwgaW5kZXgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDx1bCByb2xlPSdncm91cCcgY2xhc3NOYW1lPXt0aGlzLl9jbGFzc05hbWV9IGlkPXt0aGlzLnByb3BzLmlkfSBrZXk9e3RoaXMucHJvcHMuaWR9PlxyXG4gICAgICAgICAgICAgICAge25vZGVzfVxyXG4gICAgICAgICAgICAgICAgPC91bD5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogZ2V0dGluZyBub2RlIGl0ZW1zXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0Tm9kZUl0ZW0obm9kZUl0ZW06IEV4YW1pbmVySW5mbywgaW5kZXg6IG51bWJlcik6IGFueSB7XHJcbiAgICAgICAgbGV0IGNoZWNrQm94SWQ6IHN0cmluZyA9ICdjYnhfJyArIG5vZGVJdGVtLmV4YW1pbmVyUm9sZUlkO1xyXG5cclxuICAgICAgICBpZiAobm9kZUl0ZW0uc3Vib3JkaW5hdGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbGV0IHRlYW1MaXN0VHJlZXZpZXcgPSBub2RlSXRlbS5pc09wZW4gPyAoPFRlYW1MaXN0VHJlZXZpZXdcclxuICAgICAgICAgICAgICAgIGlkPXsnbm9kZUl0ZW1fJyArIG5vZGVJdGVtLmV4YW1pbmVyUm9sZUlkfVxyXG4gICAgICAgICAgICAgICAga2V5PXsnbm9kZUl0ZW1fJyArIGluZGV4LnRvU3RyaW5nKCkgKyAnX2tleV8nICsgbm9kZUl0ZW0uZXhhbWluZXJSb2xlSWQgfVxyXG4gICAgICAgICAgICAgICAgYWRkcmVzc0xpc3QgPXtub2RlSXRlbS5zdWJvcmRpbmF0ZXN9XHJcbiAgICAgICAgICAgICAgICByZW5kZXJlZE9uID0ge0RhdGUubm93KCl9Lz4pIDogbnVsbDtcclxuXHJcbiAgICAgICAgICAgIGxldCBjbGFzc05hbWVGb3JFeHBhbmQgPSBub2RlSXRlbS5pc09wZW4gPyAnbm9kZSBoYXMtc3ViIGV4cGFuZGVkJyA6ICdub2RlIGhhcy1zdWIgY29sbGFwc2VkJztcclxuICAgICAgICAgICAgcmV0dXJuICg8bGkgaWQ9eydsaV8nICsgbm9kZUl0ZW0uZXhhbWluZXJSb2xlSWR9IGtleT17J2xpXycgKyBpbmRleC50b1N0cmluZygpICsgJ18nICsgbm9kZUl0ZW0uZXhhbWluZXJSb2xlSWR9XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZUZvckV4cGFuZH0gcm9sZT0ndHJlZWl0ZW0nIGFyaWEtZXhwYW5kZWQ9J3RydWUnPlxyXG4gICAgICAgICAgICAgICAgPGFcclxuICAgICAgICAgICAgICAgICAgICBpZD17J2FfJyArIG5vZGVJdGVtLmV4YW1pbmVyUm9sZUlkfVxyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2sgPSB7dGhpcy51cGRhdGVUZWFtTGlzdFN0YXR1cy5iaW5kKHRoaXMsIG5vZGVJdGVtLmV4YW1pbmVyUm9sZUlkLCB0cnVlKSB9XHJcbiAgICAgICAgICAgICAgICAgICAgaHJlZj0namF2YXNjcmlwdDp2b2lkKDApOycgY2xhc3NOYW1lPSdwYXJlbnQtbm9kZSc+PC9hPlxyXG4gICAgICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZT0nY2hlY2tib3gnXHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSd0ZXh0LW1pZGRsZSBjaGVja2JveCdcclxuICAgICAgICAgICAgICAgICAgICBpZD17Y2hlY2tCb3hJZH1cclxuICAgICAgICAgICAgICAgICAgICBjaGVja2VkID0ge25vZGVJdGVtLmlzQ2hlY2tlZH1cclxuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy51cGRhdGVUZWFtTGlzdFN0YXR1cy5iaW5kKHRoaXMsIG5vZGVJdGVtLmV4YW1pbmVyUm9sZUlkLCBmYWxzZSkgfVxyXG4gICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIDxsYWJlbFxyXG4gICAgICAgICAgICAgICAgICAgIGh0bWxGb3I9e2NoZWNrQm94SWR9PlxyXG4gICAgICAgICAgICAgICAgICAgIHtub2RlSXRlbS5mdWxsTmFtZX1cclxuICAgICAgICAgICAgICAgIDwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgIHt0ZWFtTGlzdFRyZWV2aWV3fVxyXG4gICAgICAgICAgICA8L2xpPik7XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoPGxpIGlkPXsnbGlfJyArIG5vZGVJdGVtLmV4YW1pbmVyUm9sZUlkfSBrZXk9eydsaV8nICsgaW5kZXgudG9TdHJpbmcoKSArICdfJyArIG5vZGVJdGVtLmV4YW1pbmVyUm9sZUlkfVxyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPSdub2RlJyByb2xlPSd0cmVlaXRlbSc+XHJcbiAgICAgICAgICAgICAgICA8aW5wdXRcclxuICAgICAgICAgICAgICAgICAgICB0eXBlPSdjaGVja2JveCdcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J3RleHQtbWlkZGxlIGNoZWNrYm94J1xyXG4gICAgICAgICAgICAgICAgICAgIGlkPXtjaGVja0JveElkfVxyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrZWQgPSB7bm9kZUl0ZW0uaXNDaGVja2VkfVxyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnVwZGF0ZVRlYW1MaXN0U3RhdHVzLmJpbmQodGhpcywgbm9kZUl0ZW0uZXhhbWluZXJSb2xlSWQsIGZhbHNlKSB9XHJcbiAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIDxsYWJlbFxyXG4gICAgICAgICAgICAgICAgICAgIGh0bWxGb3I9e2NoZWNrQm94SWR9PlxyXG4gICAgICAgICAgICAgICAgICAgIHtub2RlSXRlbS5mdWxsTmFtZX08L2xhYmVsPlxyXG4gICAgICAgICAgICA8L2xpPik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIENsaWNraW5nIG9uIGV4cGFuZC9jb2xsYXBzZSBvciBjaGVjay91bmNoZWNrXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgdXBkYXRlVGVhbUxpc3RTdGF0dXMgPSAodW5pcXVlSWQ6IG51bWJlciwgaXNFeHBhbmQ6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICBtZXNzYWdpbmdBY3Rpb25DcmVhdG9yLnVwZGF0ZVRlYW1MaXN0U3RhdHVzKHVuaXF1ZUlkLCBpc0V4cGFuZCk7XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgPSBUZWFtTGlzdFRyZWV2aWV3O1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL34vc291cmNlLW1hcC1sb2FkZXIhLi9zcmMvY29tcG9uZW50cy9tZXNzYWdlL3RlYW1saXN0dHJlZXZpZXcudHN4Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBO0FBRUE7QUFLQTtBQU9BO0FBQUE7QUFLQTs7OztBQUlBO0FBQ0E7QUFBQTtBQVBBO0FBeUZBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBcEZBOztBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFLQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFNQTtBQUNBO0FBRUE7QUFJQTtBQU9BO0FBSUE7QUFHQTtBQUFBO0FBQ0E7QUFFQTtBQU9BO0FBSUE7QUFDQTtBQVNBO0FBQUE7QUFFQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ })

});